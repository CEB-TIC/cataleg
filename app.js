!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):"function"==typeof define&&define.amd?define(["Pinia","Vue","VueRouter","furaVue","llescaVue","pdfFonts","pdfMake"],t):"object"==typeof exports?exports.app=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):e.app=t(e.Pinia,e.Vue,e.VueRouter,e.furaVue,e.llescaVue,e.pdfFonts,e.pdfMake)}(self,((e,t,a,n,l,i,o)=>(()=>{"use strict";var r={744:(e,t)=>{t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}},713:t=>{t.exports=e},740:e=>{e.exports=t},88:e=>{e.exports=a},283:e=>{e.exports=n},111:e=>{e.exports=l},732:e=>{e.exports=i},525:e=>{e.exports=o}},s={};function d(e){var t=s[e];if(void 0!==t)return t.exports;var a=s[e]={exports:{}};return r[e](a,a.exports,d),a.exports}d.d=(e,t)=>{for(var a in t)d.o(t,a)&&!d.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{d.d(u,{default:()=>kr});var e={};d.r(e),d.d(e,{getRoutes:()=>Vn});var t={};d.r(t),d.d(t,{getRoutes:()=>Yl});var a={};d.r(a),d.d(a,{getRoutes:()=>ei});var n=d(740),l=d(713),i=d(283),o=d(111),r=d(88);const s="AANEE20",c="Preinscripció alumnes NESE",m="https://aanee20.azurewebsites.net",E="LLESCA_VIEW",p="ID",A="ENTITY",I="VIEWNAME",N="DEF_VIEW",y="DEFAULT_VIEW",C="/home";function f(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(a)}function _(e){if("string"==typeof e&&e){const t=f(e),a=1e3*t.exp,n=1e3*t.iat,l=Date.now();return n<l&&l<a}return!1}const T=(0,l.defineStore)({id:"session",state(){const e=localStorage.getItem(`jwt/${s}`);return{jwt:_(e)?e:null}},getters:{data:e=>function(e){if("string"==typeof e&&e){const t=f(e);return{name:t.unique_name,idEap:t.ID_EAP,role:t.role}}return{name:null,role:null}}(e.jwt)},actions:{setJwt(e){"string"==typeof e&&e&&_(e)?(localStorage.setItem(`jwt/${s}`,e),this.jwt=e):(localStorage.removeItem(`jwt/${s}`),this.jwt=null)}}}),g={importYesNo:[{value:"Sí",text:"Sí"},{value:"No",text:"No"}],importDistricte:[{value:"1-Ciutat Vella",text:"1-Ciutat Vella"},{value:"2-Eixample",text:"2-Eixample"},{value:"3-Sants Montjuïc",text:"3-Sants Montjuïc"},{value:"4-Les Corts",text:"4-Les Corts"},{value:"5-Sarrià Sant Gervasi",text:"5-Sarrià Sant Gervasi"},{value:"6-Gràcia",text:"6-Gràcia"},{value:"7-Horta Guinardó",text:"7-Horta Guinardó"},{value:"8-Nou Barris",text:"8-Nou Barris"},{value:"9-Sant Andreu",text:"9-Sant Andreu"},{value:"10-Sant Martí",text:"10-Sant Martí"}],eaps:[{value:10,text:"EAP Ciutat Vella"},{value:9,text:"EAP Eixample"},{value:8,text:"EAP Gràcia"},{value:7,text:"EAP Horta-Guinardò"},{value:6,text:"EAP Les Corts"},{value:5,text:"EAP Nou Barris"},{value:4,text:"EAP Sant Andreu"},{value:3,text:"EAP Sant Martí"},{value:2,text:"EAP Sants-Montjuïc"},{value:1,text:"EAP Sarrià-Sant Gervasi"},{value:11,text:"Àrea Inclusiva"}],motiusNese:[{value:4,text:"Discapacitat auditiva lleugera"},{value:5,text:"Discapacitat auditiva mitjana"},{value:6,text:"Discapacitat auditiva profunda"},{value:7,text:"Discapacitat auditiva severa"},{value:8,text:"Discapacitat intel·lectual lleugera"},{value:9,text:"Discapacitat intel·lectual moderada"},{value:10,text:"Discapacitat intel·lectual profunda"},{value:11,text:"Discapacitat intel·lectual severa"},{value:12,text:"Discapacitat motriu autònom"},{value:13,text:"Discapacitat motriu depenent"},{value:14,text:"Discapacitat motriu semi-autònom"},{value:15,text:"Discapacitat visual"},{value:27,text:"Malaltia degenerativa, greu i minoritària"},{value:18,text:"Pluridiscapacitat"},{value:19,text:"Retard del desenvolupament sense etiologia clara"},{value:23,text:"Trastorn greu de la conducta"},{value:24,text:"Trastorn mental greu"},{value:26,text:"Trastorns de l'espectre autista"}],rols:[{value:"ESCOLARITZACIO",text:"ESCOLARITZACIO"},{value:"INCLUSIVA",text:"INCLUSIVA"},{value:"EAP",text:"EAP"},{value:"SSOCIALS",text:"SSOCIALS"},{value:"LECTURA",text:"LECTURA"},{value:"EAPLECTURA",text:"EAPLECTURA"},{value:"SSOCIALSLECTURA",text:"SSOCIALSLECTURA"},{value:"SIMULACIONS",text:"SIMULACIONS"}],EstatIdalu:[{value:0,text:"En blanc"},{value:1,text:"No validat"},{value:2,text:"Validat"}],EstatIdaluGedac:[{value:0,text:"No trobat"},{value:1,text:"Sense IDALU a GEDAC"},{value:2,text:"IDALU trobat diferent"},{value:3,text:"Amb IDALU a GEDAC"}],avaluacioNEE:[{value:"Completa",text:"Completa"},{value:"Incompleta",text:"Incompleta"}],estatsNEE:[{value:"Pendent d'avaluar",text:"Pendent d'avaluar"},{value:"Sí",text:"Sí"},{value:"No",text:"No"}],EstatPreinscripcio:[{value:0,text:"Sense preinscripció associada"},{value:1,text:"Amb preinscripció associada"}],etapes:[{value:"Infantil i primària",text:"Infantil i primària"},{value:"Secundària",text:"Secundària"}],etapesGedac:[{value:"(totes)",text:"(totes)"},{value:"INFPRI",text:"Infantil i primària"},{value:"ESO LOE",text:"Secundària"}],nivells:[{value:2,text:"P3"},{value:3,text:"P4"},{value:4,text:"P5"},{value:5,text:"1r primària"},{value:6,text:"2n primària"},{value:7,text:"3er primària"},{value:8,text:"4t primària"},{value:9,text:"5è primària"},{value:10,text:"6è primària"},{value:11,text:"1r d'ESO"},{value:12,text:"2n d'ESO"},{value:13,text:"3er d'ESO"},{value:14,text:"4t d'ESO"},{value:1,text:"Educació Especial"}],districtes:[{value:1,text:"1-Ciutat Vella"},{value:2,text:"2-Eixample"},{value:3,text:"3-Sants Montjuïc"},{value:4,text:"4-Les Corts"},{value:5,text:"5-Sarrià Sant Gervasi"},{value:6,text:"6-Gràcia"},{value:7,text:"7-Horta Guinardó"},{value:8,text:"8-Nou Barris"},{value:9,text:"9-Sant Andreu"},{value:10,text:"10-Sant Martí"}],siNo:[{value:"Sí",text:"Sí"},{value:"No",text:"No"}],tipusAlumne:[{value:"NEE-A",text:"NEE-A"},{value:"NEE-B",text:"NEE-B"},{value:"NEE-A+B",text:"NEE-A+B"}],tipusAlumneGEDAC:[{value:"NEE-A",text:"NEE-A"},{value:"NEE-A",text:"NEE-A i NEE-B"},{value:"NEE-B",text:"NEE-B"},{value:"Ordinari",text:"Ordinari"}],tipusEscolaritzacio:[{value:"Especial",text:"Especial"},{value:"Ordinària",text:"Ordinària"},{value:"Compartida",text:"Compartida"},{value:"AIS",text:"AIS"}],titularitats:[{value:"Públic",text:"Públic"},{value:"Privat concertat",text:"Privat concertat"}],acordsNEEA:[{value:"Acord",text:"Acord"},{value:"Desacord",text:"Desacord"}],inscripcioFinalNEEA:[{value:"Pendent decisió",text:"Pendent decisió"},{value:"Família prefereix preins. ordinària",text:"Família prefereix preins. ordinària"},{value:"Família accepta preinscripció NEE-A",text:"Família accepta preinscripció NEE-A"},{value:"NEE-A d'ofici",text:"NEE-A d'ofici"},{value:"Ordinari d'ofici",text:"Ordinari d'ofici"}],esNEE:[{value:"Pendent d'avaluar",text:"Pendent d'avaluar"},{value:"Sí",text:"Sí"},{value:"No",text:"No"}],preinscripcioFinalImport:[{value:"Família prefereix ordinaria",text:"Família prefereix ordinaria"},{value:"Família accepta NEE-B",text:"Família accepta NEE-B"},{value:"NEE-B d'ofici",text:"NEE-B d'ofici"},{value:"Ordinari d'ofici",text:"Ordinari d'ofici"}],preinscripcioFinalNEEB:[{value:"Família prefereix ordinaria",text:"Família prefereix preinscripció ordinària"},{value:"Família accepta NEE-B",text:"Família accepta preinscripció NEE-B"},{value:"NEE-B d'ofici",text:"NEE-B d'ofici"},{value:"Ordinari d'ofici",text:"Ordinari d'ofici"}],marcaAuto:[{value:"Canviar a NEE-A",text:"Canviar a NEE-A"},{value:"Canviar a NEE-A (si centre ordinari)",text:"Canviar a NEE-A (si centre ordinari)"},{value:"Canviar a NEE-B",text:" Canviar a NEE-B"},{value:"Canviar a ordinari",text:" Canviar a ordinari"},{value:"Desacord. Tractament individualitzat cas",text:"Desacord. Tractament individualitzat cas"},{value:"Manca informar acord/desacord",text:"Manca informar acord/desacord"},{value:"Marcatge correcte",text:"Marcatge correcte"},{value:"Marcatge correcte (si centre ordinari)",text:"Marcatge correcte (si centre ordinari)"},{value:"Pendent avaluació EAP",text:"Pendent avaluació EAP"},{value:"Pendent inclusiva",text:"Pendent inclusiva"},{value:"Pendent TS",text:"Pendent TS"},{value:"Sense sol·licitud a GEDAC",text:"Sense sol·licitud a GEDAC"},{value:"S'orienta a CEE",text:"S'orienta a CEE"}],marcaManual:[{value:"NEE-A",text:"NEE-A"},{value:"NEE-B",text:"NEE-B"},{value:"Ordinari",text:"Ordinari"}],marcaFinal:[{value:"NEE-A",text:"NEE-A"},{value:"NEE-B",text:"NEE-B"},{value:"Ordinari",text:"Ordinari"},{value:"CEE",text:"CEE"}],tipusAssignacions:[{value:"Manual",text:"Manual"},{value:"Manual GEDAC",text:"Manual GEDAC"},{value:"Existeix germà",text:"Existeix germà"},{value:"Centre Proposat",text:"Centre Proposat"},{value:"Calculada",text:"Calculada"},{value:"Ofici",text:"Ofici"}]},O=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"IDALU",label:"IDALU",type:"string",maxlength:15,gridColumn:{width:"80px"}},{name:"LLIGAM_IDALU",label:"Llligam IDALU",type:"string",disabled:!0,readonly:!0},{name:"DATA_LLIGAM_IDALU",label:"Lligam IDALU",type:"date",disabled:!0,readonly:!0},{name:"IDALU_RALC",label:"IDALU és al RALC",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"90px"}},{name:"IDALU_GEDAC",label:"IDALU és a GEDAC",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ESTATIDALU",label:"Estat IDALU",type:"choice",dataType:"number",disabled:!0,readonly:!0,options:g.EstatIdalu},{name:"ID_GEDAC",label:"Nº preinscripció",type:"lookup",dataType:"number",disabled:!0,readonly:!0,entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"NUM_SOLICITUD"},gridColumn:{width:"140px"}},{name:"ID_GEDAC_INI",label:"Nº preinscripció Inicial",type:"lookup",dataType:"number",disabled:!0,readonly:!0,entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"NUM_SOLICITUD"},gridColumn:{width:"140px"}},{name:"NUM_SOLICITUD_GEDAC",label:"N.Sol. GEDAC",type:"string",disabled:!0,maxlength:48,gridColumn:{width:"140px"}},{name:"INSCRIT_ORDINARI_GEDAC",label:"Preinscrit ordinari",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ASSIGNACIO_MANUAL_GEDAC",label:"Assignació manual GEDAC",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ID_RAV_ALUMNE",label:"IDALU RAV",type:"lookup",dataType:"number",disabled:!0,entity:{name:"RAV_ALUMNE",primaryKey:"ID",targetKey:"IDALU"}},{name:"ESTATPREINSCRIPCIO",label:"Estat preinscripció",type:"choice",dataType:"number",disabled:!0,options:g.EstatPreinscripcio,gridColumn:{width:"130px"}},{name:"NUM_SOLICITUD_EE",label:"N.Sol. Ed.Especial",type:"string",maxlength:48,gridColumn:{width:"110px"}},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL",gridColumn:{width:"110px"}},{name:"ID_ORIGEN",label:"Font dades",type:"dictionary",dataType:"number",defaultValue:1,disabled:!0,entityName:"AANEE_ORIGEN_INFORMACIO",gridColumn:{width:"100px"}},{name:"REFERENCIA",label:"Referència",type:"string",maxlength:40,gridColumn:{width:"100px"}},{name:"TIPUS_ALUMNE",label:"T.alumne",type:"choice",dataType:"string",options:g.tipusAlumne,required:!0,defaultValue:"NEE-A",maxlength:12,gridColumn:{width:"80px"}},{name:"TIPUS_ALUMNE_GEDAC",label:"Tipus GEDAC",type:"choice",dataType:"string",options:g.tipusAlumneGEDAC,disabled:!0,maxlength:12,gridColumn:{width:"90px"}},{name:"CODI_CENTRE_PROCEDENCIA",label:"Codi Centre procedència",type:"string",readonly:!0,disabled:!0,gridColumn:{width:"110px"}},{name:"ID_CENTRE_PROCEDENCIA",label:"Centre procedència (RALC)",type:"lookup",clearValueOnDisabled:!0,entityName:"GEN_CENTRE",disabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE6"},gridColumn:{width:"230px"}},{name:"ID_CENTRE_ASSIGNAT_CEB",label:"Centre assignat manualment",type:"lookup",clearValueOnDisabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},gridColumn:{width:"230px"}},{name:"ID_EAP",label:"EAP",type:"dictionaryCustom",dataType:"number",entityName:"GEN_EAP",disabled:!0,defaultValue:function(){const e=T();return e.data.idEap?parseInt(e.data.idEap):null},clearValueOnDisabled:!0,gridColumn:{width:"160px"}},{name:"MANCA_EAP",label:"Manca EAP",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"90px"}},{name:"NOM",label:"Nom alumne",type:"string",required:!0,maxlength:80,gridColumn:{width:"160px"}},{name:"COGNOM1",label:"1r cognom alumne",type:"string",required:!0,maxlength:80,gridColumn:{width:"160px"}},{name:"COGNOM2",label:"2n cognom alumne",type:"string",maxlength:80,gridColumn:{width:"160px"}},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string",disabled:!0,readonly:!0,gridColumn:{width:"200px"}},{name:"IDALUCOGNOMSINOM",label:"IDALU, cognoms i nom",type:"string",disabled:!0,readonly:!0,gridColumn:{width:"160px"}},{name:"COGNOMSINOMIDALU",label:"Cognoms, nom i IDALU",type:"string",disabled:!0,readonly:!0,gridColumn:{width:"160px"}},{name:"DATA_NAIXEMENT",label:"D. Naixement",type:"date",detailsColumn:{align:"center",width:"90px"},gridColumn:{align:"center",width:"80px"}},{name:"IDENTIFICACIO_FISCAL",label:"Id. fiscal",type:"string",maxlength:32,gridColumn:{width:"80px"}},{name:"ADRECA_RESIDENCIA",label:"Adreça",type:"string",maxlength:255,gridColumn:{width:"160px"}},{name:"CP_RESIDENCIA",label:"C.P.",type:"string",maxlength:5,gridColumn:{width:"70px"}},{name:"ID_DISTRICTE_RESIDENCIA",label:"Districte",type:"dictionary",dataType:"number",entityName:"GEN_DISTRICTE",gridColumn:{width:"100px"}},{name:"NOM_TUTOR1",label:"Nom 1r tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"COGNOM1_TUTOR1",label:"1r cognom 1r tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"COGNOM2_TUTOR1",label:"2n cognom 1r tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"IDENTIFICACIO_FISCAL_TUTOR1",label:"Id. fiscal 1r tutor",type:"string",maxlength:32,gridColumn:{width:"120px"}},{name:"TELEFON_TUTOR1",label:"Tel. 1r tutor",type:"string",maxlength:9,pattern:/^\d{9}$/,gridColumn:{width:"80px"}},{name:"EMAIL_TUTOR1",label:"eMail 1r tutor",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,maxlength:255,gridColumn:{width:"140px"}},{name:"NOM_TUTOR2",label:"Nom 2nr tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"COGNOM1_TUTOR2",label:"1r cognom 2n tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"COGNOM2_TUTOR2",label:"2n cognom 2n tutor",type:"string",maxlength:80,gridColumn:{width:"120px"}},{name:"IDENTIFICACIO_FISCAL_TUTOR2",label:"Id. fiscal 2n tutor",type:"string",maxlength:32,gridColumn:{width:"100px"}},{name:"TELEFON_TUTOR2",label:"Tel. 2n tutor",type:"string",maxlength:9,pattern:/^\d{9}$/,gridColumn:{width:"80px"}},{name:"EMAIL_TUTOR2",label:"eMail 2n tutor",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,maxlength:255,gridColumn:{width:"140px"}},{name:"GEDAC_IDALU",label:"IDALU GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",dataType:"number",disabled:!0,readonly:!0,entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"IDALU"}},{name:"GEDAC_NOM",label:"Nom GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"NOM"}},{name:"GEDAC_COGNOM1",label:"1r cognom GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"COGNOM1"}},{name:"GEDAC_COGNOM2",label:"2n cognom GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"COGNOM2"}},{name:"GEDAC_IDFISCAL",label:"Id. fiscal GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"IDENTIFICACIO_FISCAL"}},{name:"GEDAC_NOM_TUTOR1",label:"Nom 1r tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"NOM_TUTOR1"}},{name:"GEDAC_COGNOM1_TUTOR1",label:"1r cognom 1r tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"COGNOM1_TUTOR1"}},{name:"GEDAC_IDFISCAL_T1",label:"id. fiscal 1r tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"IDENTIFICACIO_FISCAL_TUTOR1"}},{name:"GEDAC_IDFISCAL_TEL",label:"Telèfon GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"TELEFON"}},{name:"GEDAC_IDFISCAL_EMAIL",label:"Email GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"EMAIL"}},{name:"GEDAC_NOM_TUTOR2",label:"Nom 2n tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"NOM_TUTOR2"}},{name:"GEDAC_COGNOM1_TUTOR2",label:"1r cognom 2n tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",dataType:"number",disabled:!0,readonly:!0,entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"COGNOM1_TUTOR2"}},{name:"GEDAC_IDFISCAL_T2",label:"id. fiscal 2n tutor GEDAC",type:"lookupDetail",baseName:"ID_GEDAC",dataType:"number",disabled:!0,readonly:!0,entity:{name:"GEDAC_ALUMNE",primaryKey:"ID",targetKey:"IDENTIFICACIO_FISCAL_TUTOR2"}},{name:"OBS_INCLUSIVA",label:"Observacions inclusiva",type:"string",multiline:!0,maxlength:4e3,gridColumn:{width:"300px"}},{name:"OBS_ESCOLARITZACIO",label:"Observacions escolarització",type:"string",multiline:!0,maxlength:4e3,gridColumn:{width:"300px"}},{name:"OBS_NEEB",label:"Observacions NEE-B",type:"string",maxlength:4e3,gridColumn:{width:"300px"}},{name:"ID_CENTRE_PROPOSAT1",label:"1r centre proposat",type:"lookup",clearValueOnDisabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE1"},gridColumn:{width:"230px"}},{name:"DISTANCIA_CENTRE_PROPOSAT1",type:"number",decimals:0,disabled:!0,align:"right",suffix:"min",maxlength:12},{name:"ID_CENTRE_PROPOSAT2",label:"2n centre proposat",type:"lookup",clearValueOnDisabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE2"},gridColumn:{width:"230px"}},{name:"DISTANCIA_CENTRE_PROPOSAT2",type:"number",decimals:0,disabled:!0,align:"right",suffix:"min",maxlength:12},{name:"ID_CENTRE_PROPOSAT3",label:"3r centre proposat",type:"lookup",clearValueOnDisabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE3"},gridColumn:{width:"230px"}},{name:"DISTANCIA_CENTRE_PROPOSAT3",type:"number",decimals:0,align:"right",disabled:!0,suffix:"min",maxlength:12},{name:"ID_CENTRE_COMPARTIDA",label:"Centre compartida",type:"lookup",clearValueOnDisabled:!0,entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE4"},gridColumn:{width:"230px"}},{name:"DISTANCIA_CENTRE_COMPARTIDA",type:"number",decimals:0,disabled:!0,align:"right",suffix:"min",maxlength:12},{name:"ID_MOTIU_NESE",label:"Motiu NESE",type:"lookupMultiCache",dataType:"number",clearValueOnDisabled:!0,junction:{name:"AANEE_ALUMNE_MOTIU_NESE",primaryKey:"ID",ownerKey:"ID_ALUMNE",targetKey:"ID_MOTIU_NESE",dictionaryKey:"ID_MOTIU_NESE"},data:{name:"GEN_MOTIU_NESE",primaryKey:"ID",targetKey:"MOTIU_NESE"},gridColumn:{width:"310px"}},{name:"DATA_ULTIMAACCIO",label:"D. última acció",type:"date",gridColumn:{width:"90px"}},{name:"RESULTAT_ULTIMAACCIO",label:"Resultat últ. acció",type:"string",maxlength:24,gridColumn:{width:"160px"}},{name:"ES_NEEA",label:"És NEE-A",type:"choice",dataType:"string",options:g.esNEE,clearValueOnDisabled:!0,defaultValue:"Pendent d'avaluar",maxlength:24,gridColumn:{width:"150px"}},{name:"AVALUACIO_NEEA_EAP",label:"Avaluació EAP",type:"choiceStyled",options:g.avaluacioNEE,disabled:!0,defaultValue:"Incompleta",setStyle:e=>"NEE-B"===e.TIPUS_ALUMNE?null:"Completa"===e.AVALUACIO_NEEA_EAP?{color:"green"}:{color:"red","font-weight":"bold"},gridColumn:{width:"120px"}},{name:"AVALUACIO_NEEA",label:"Avaluació Inclusiva",type:"choiceStyled",options:g.avaluacioNEE,disabled:!0,defaultValue:"Incompleta",setStyle:e=>"NEE-B"===e.TIPUS_ALUMNE?null:"Completa"===e.AVALUACIO_NEEA?{color:"green"}:{color:"red","font-weight":"bold"},gridColumn:{width:"120px"}},{name:"ACORD_NEEA",label:"Conformitat família",type:"choice",options:g.acordsNEEA,dataType:"string",clearValueOnDisabled:!0,maxlength:24,gridColumn:{width:"110px"}},{name:"TIPUS_ESCOLARITZACIO",label:"Tipus escolarització",type:"choice",options:g.tipusEscolaritzacio,dataType:"string",clearValueOnDisabled:!0,maxlength:12,gridColumn:{width:"120px"}},{name:"PENDENT_INSCRIPCIO_FINAL_NEEA",label:"Manca Preinscripció final",type:"boolean",disabled:!0,readonly:!0,detailsColumn:{align:"center"},gridColumn:{width:"110px"}},{name:"INSCRIPCIOFINAL_NEEA",label:"Preinscripció final",type:"choice",options:g.inscripcioFinalNEEA,dataType:"string",clearValueOnDisabled:!0,maxlength:36,gridColumn:{width:"90px"}},{name:"SENSE_BARRERES",label:"Sense barreres",type:"choice",options:g.siNo,clearValueOnDisabled:!0,maxlength:2,gridColumn:{width:"90px"}},{name:"SIEI",label:"SIEI",type:"choice",options:g.siNo,clearValueOnDisabled:!0,maxlength:2,gridColumn:{width:"50px"}},{name:"SIAL",label:"SIAL",type:"choice",options:g.siNo,clearValueOnDisabled:!0,maxlength:2,gridColumn:{width:"50px"}},{name:"RETENCIO",label:"Retenció",gridAlign:"center",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"70px"}},{name:"CEEPSIR",label:"CEEPSIR",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"70px"}},{name:"CENTRE_CRAE",label:"Centre CRAE",type:"boolean",clearValueOnDisabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"70px"}},{name:"ACOLLIMENT_DGAIA",label:"Acolliment DGAIA",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"PROFESSIONAL_ASSIGNAT_NEEA",label:"Professional assignat NEE-A",type:"string",clearValueOnDisabled:!0,maxlength:80,gridColumn:{width:"180px"}},{name:"GERMANS_ESTUDIEN_BCN",label:"Germans estudien BCN",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"ID_CENTRE_GERMANS",label:"Centre germans",type:"lookup",entity:{primaryKey:"ID",targetKey:"CODIINOM_CENTRE",navigationKey:"GEN_CENTRE5"},gridColumn:{width:"230px"}},{name:"GERMA_BESSO_ORDINARI",label:"Germà bessó ordinari",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"ES_NEEB",label:"És NEE-B",type:"choice",dataType:"string",options:g.esNEE,clearValueOnDisabled:!0,maxlength:24,gridColumn:{width:"120px"}},{name:"MODIFICACIO_ESNEEB",label:"Modificació NEE-B",type:"boolean",detailsColumn:{align:"center"},gridColumn:{width:"90px"}},{name:"AVALUACIO_NEEB",label:"Avaluació NEE-B",type:"choiceStyled",options:g.avaluacioNEE,disabled:!0,setStyle:e=>"Completa"===e.AVALUACIO_NEEB?{color:"green"}:{color:"red",fontStyle:"bold"},gridColumn:{width:"120px"},maxlength:24},{name:"PROFESSIONAL_ASSIGNAT_NEEB",label:"Professional assignat NEE-B",type:"string",maxlength:80,gridColumn:{width:"180px"}},{name:"INSCRIPCIOFINAL_NEEB",label:"Preinscripció final (si NEE-B preinscrit ordinari)",type:"choice",dataType:"string",options:g.preinscripcioFinalNEEB,clearValueOnDisabled:!0,maxlength:36,gridColumn:{width:"140px"}},{name:"INSCRIPCIOFINAL_INICIAL_NEEB",label:"Preinscripció final (inicial)",type:"choice",dataType:"string",options:g.preinscripcioFinalNEEB,disabled:!0,maxlength:36,clearValueOnDisabled:!0,gridColumn:{width:"140px"}},{name:"ENTREVISTAR_NEEB",label:"Fer entrevista",type:"boolean",clearValueOnDisabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"DATATRUCADA_NEEB",label:"D. trucada",type:"date",clearValueOnDisabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ESTA_RAV",label:"Està al RAV",type:"boolean",disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"ID_MOTIU_VULNERABILITAT",label:"Motiu Vulnerabilitat",type:"dictionary",entityName:"RAV_MOTIU_VULNERABILITAT",clearValueOnDisabled:!0,gridColumn:{width:"150px"}},{name:"ID_MOTIU_VULNERABILITAT_RAV",label:"Motiu Vulnerabilitat RAV",type:"dictionary",entityName:"RAV_MOTIU_VULNERABILITAT",navigationKey:"RAV_MOTIU_VULNERABILITAT1",disabled:!0,gridColumn:{width:"120px"}},{name:"MOTIU_VULNERABILITAT_DIFERENT",label:"Motiu vulnerabilitat diferent al RAV",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"80px"}},{name:"ID_ESTAT_VULNERABLE",label:"Estat vulnerable",type:"dictionary",entityName:"RAV_ESTAT_VULNERABLE",readonly:!0,disabled:!0,gridColumn:{width:"120px"}},{name:"ID_ESTAT_PLAXOC",label:"Estat pla de xoc",type:"dictionary",entityName:"RAV_ESTAT_PLAXOC",readonly:!0,disabled:!0,gridColumn:{width:"120px"}},{name:"ID_ESTAT_RAV",label:"Estat RAV",type:"dictionary",entityName:"RAV_ESTAT",readonly:!0,disabled:!0,gridColumn:{width:"120px"}},{name:"NUM_GERMANS_VULNERABLES",label:"Nº germans vulner.",type:"number",decimal:0,readonly:!0,disabled:!0,gridColumn:{width:"120px"}},{name:"NUM_GERMANS_NOVULNERABLES",label:"Nº germans NO vulner.",type:"number",decimal:0,disabled:!0,gridColumn:{width:"120px"}},{name:"RENDA_MINIMA",label:"Renda mínima (alumne)",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"RENDA_MINIMA_VALIDAT",label:"Renda mínima (validat)",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ACOLLIMENT_FAMILIAR",label:"Acolliment familiar (alumne)",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"ACOLLIMENT_FAMILIAR_VALIDAT",label:"Acolliment familiar (validat)",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"SITUACIO_ACOLLIMENT",label:"Situació d'acolliment",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"90px"}},{name:"MARCA_AUTO",label:"Orientació automàtica de marcatge",type:"choice",options:g.marcaAuto,disabled:!0,gridColumn:{width:"120px"}},{name:"MARCA_MANUAL",label:"Orientació manual",type:"choice",options:g.marcaManual,gridColumn:{width:"100px"}},{name:"MARCA_FINAL",label:"Marc.final",type:"choice",options:g.marcaFinal,disabled:!0,gridColumn:{width:"100px"}},{name:"RENDA_MINIMA",label:"Renda mínima (alumne)",type:"boolean",readonly:!0,disabled:!0,detailsColumn:{align:"center"},gridColumn:{width:"100px"}},{name:"DISTANCIA_CENTRE_ASSIGNAT_CEB",label:"Distància",type:"number",align:"right",suffix:"min.",decimals:0,useGrouping:!0,maximumFractionDigits:0,disabled:!0},{name:"CREATED",label:"D.creació",type:"date",readonly:!0,detailsColumn:{align:"center",width:"90px"},gridColumn:{align:"center",width:"80px"}},{name:"CREATEDBY",label:"Creat per",type:"string",maxlength:64,readonly:!0},{name:"MODIFIED",label:"D. últ. mod.",type:"date",readonly:!0,detailsColumn:{align:"center",width:"100px"},gridColumn:{align:"center",width:"100px"}},{name:"MODIFIEDBY",label:"Modificat per",type:"string",maxlength:64,readonly:!0},{name:"AANEE_ALUMNE_CANVI/odata.count",type:"childCount",navigationKey:"AANEE_ALUMNE_CANVI",loadAlwaysInView:!0}],S=[{filterGroup:"Dades alumnes Gestió i escolarització",label:"IDALUs a cercar separats per, o per salts de línia",name:"IDALU",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Estat validació IDALU",name:"ESTATIDALU",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Cognoms i nom contenen",name:"COGNOMSINOM",operation:"contains"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"TIPUS_ALUMNE",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"ID_NIVELL",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"ESTATPREINSCRIPCIO",label:"Estat preinscripció",operation:"eq"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Nº Sol·licitud GEDAC conté",name:"NUM_SOLICITUD_GEDAC",operation:"contains"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Nº Sol·licitud E.Especial conté",name:"NUM_SOLICITUD_EE",operation:"contains"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"TIPUS_ALUMNE_GEDAC",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"CODI_CENTRE_PROCEDENCIA",operation:"eq"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"MARCA_AUTO",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"MARCA_MANUAL",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"MARCA_FINAL",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"ASSIGNACIO_MANUAL_GEDAC",label:"Assignació manual a GEDAC",operation:"eq"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Modificat per conté",name:"MODIFIEDBY",operation:"contains"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Data modificació",name:"MODIFIED",operation:"between"},{filterGroup:"Dades alumnes Gestió i escolarització",label:"Origen de la informació",name:"ID_ORIGEN",operation:"in"},{filterGroup:"Dades alumnes Gestió i escolarització",name:"REFERENCIA",label:"Referència de la càrrega de dades conté",operation:"contains"},{filterGroup:"Dades NEE-A",name:"ID_EAP",label:"EAP",setDisabled:e=>"EAP"===e.data.role,setValue:e=>e.data.idEap,defaultValue:2,operation:"eq"},{filterGroup:"Dades NEE-A",label:"Manca informar EAP",name:"MANCA_EAP",operation:"eq"},{filterGroup:"Dades NEE-A",name:"AVALUACIO_NEEA_EAP",operation:"eq"},{filterGroup:"Dades NEE-A",name:"AVALUACIO_NEEA",operation:"eq"},{filterGroup:"Dades NEE-A",label:"eMail professional assignat conté",name:"PROFESSIONAL_ASSIGNAT_NEEA",operation:"in"},{filterGroup:"Dades NEE-A",name:"ES_NEEA",operation:"in"},{filterGroup:"Dades NEE-A",name:"TIPUS_ESCOLARITZACIO",operation:"in"},{filterGroup:"Dades NEE-A",name:"SENSE_BARRERES",operation:"eq"},{filterGroup:"Dades NEE-A",name:"SIEI",operation:"eq"},{filterGroup:"Dades NEE-A",name:"SIAL",operation:"eq"},{filterGroup:"Dades NEE-A",name:"RETENCIO",operation:"eq"},{filterGroup:"Dades NEE-A",name:"CEEPSIR",operation:"eq"},{filterGroup:"Dades NEE-A",name:"ACORD_NEEA",operation:"in"},{filterGroup:"Dades NEE-A",name:"ID_MOTIU_NESE",operation:"in"},{filterGroup:"Dades NEE-A",label:"Preinscripció final (si NEE-A preinscrit ordinari)",name:"INSCRIPCIOFINAL_NEEA",operation:"in"},{filterGroup:"Dades NEE-A",label:"Manca informar preinscripció final",name:"PENDENT_INSCRIPCIO_FINAL_NEEA",operation:"eq"},{filterGroup:"Dades NEE-B",name:"AVALUACIO_NEEB",operation:"eq"},{filterGroup:"Dades NEE-B",name:"ENTREVISTAR_NEEB",operation:"eq"},{filterGroup:"Dades NEE-B",label:"eMail professional assignat conté",name:"PROFESSIONAL_ASSIGNAT_NEEB",operation:"contains"},{filterGroup:"Dades NEE-B",name:"ES_NEEB",operation:"in"},{filterGroup:"Dades NEE-B",name:"ID_MOTIU_VULNERABILITAT",operation:"in"},{filterGroup:"Dades NEE-B",name:"MOTIU_VULNERABILITAT_DIFERENT",operation:"eq"},{filterGroup:"Dades NEE-B",name:"INSCRIPCIOFINAL_NEEB",operation:"in"},{filterGroup:"Dades NEE-B",name:"ID_ESTAT_RAV",operation:"in"},{filterGroup:"Dades NEE-B",name:"ID_ESTAT_VULNERABLE",operation:"in"},{filterGroup:"Dades NEE-B",name:"ID_MOTIU_VULNERABILITAT_RAV",operation:"in"},{filterGroup:"Dades NEE-B",name:"ID_ESTAT_PLAXOC",operation:"in"},{filterGroup:"Dades NEE-B",name:"NUM_GERMANS_VULNERABLES",operation:"between"},{filterGroup:"Dades NEE-B",name:"NUM_GERMANS_NOVULNERABLES",operation:"between"},{filterGroup:"Dades NEE-B",label:"Observacions inclusiva contenen",name:"OBS_INCLUSIVA",operation:"contains"},{filterGroup:"Dades NEE-B",name:"ESTA_RAV",operation:"eq"},{filterGroup:"Dades NEE-B",name:"VULNERABLE",operation:"eq"},{filterGroup:"Dades NEE-B",name:"PLADEXOC",operation:"eq"},{filterGroup:"Dades NEE-B",name:"RENDA_MINIMA",operation:"eq"},{filterGroup:"Dades NEE-B",name:"RENDA_MINIMA_VALIDAT",operation:"eq"},{filterGroup:"Dades NEE-B",name:"ACOLLIMENT_FAMILIAR",operation:"eq"},{filterGroup:"Dades NEE-B",name:"ACOLLIMENT_FAMILIAR_VALIDAT",operation:"eq"},{filterGroup:"Dades NEE-B",name:"SITUACIO_ACOLLIMENT",operation:"eq"}];async function b(e,t){const a=await fetch(`${m}/Stored/pr_AANEE_AvaluacioNEE`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:e.jwt},body:JSON.stringify({NUM_SOLICITUD_GEDAC:t.NUM_SOLICITUD_GEDAC,TIPUS_ALUMNE:t.TIPUS_ALUMNE,TIPUS_ALUMNE_GEDAC:t.TIPUS_ALUMNE_GEDAC,ES_NEEA:t.ES_NEEA,ID_MOTIU_NESE:t.AANEE_ALUMNE_MOTIU_NESE.length,INSCRIPCIOFINAL_NEEA:t.INSCRIPCIOFINAL_NEEA,TIPUS_ESCOLARITZACIO:t.TIPUS_ESCOLARITZACIO,RECURSOS:t.RECURSOS,ACORD_NEEA:t.ACORD_NEEA,SENSE_BARRERES:t.SENSE_BARRERES,SIEI:t.SIEI,SIAL:t.SIAL,ID_CENTRE_PROPOSAT1:t.ID_CENTRE_PROPOSAT1,ID_CENTRE_PROPOSAT2:t.ID_CENTRE_PROPOSAT2,ID_CENTRE_COMPARTIDA:t.ID_CENTRE_COMPARTIDA,ES_NEEB:t.ES_NEEB,ID_MOTIU_VULNERABILITAT:t.ID_MOTIU_VULNERABILITAT,ID_ESTAT_RAV:t.ID_ESTAT_RAV,ID_ESTAT_VULNERABLE:t.ID_ESTAT_VULNERABLE,INSCRIPCIOFINAL_NEEB:t.INSCRIPCIOFINAL_NEEB,MARCA_MANUAL:t.MARCA_MANUAL,ENTREVISTAR_NEEB:t.ENTREVISTAR_NEEB,output:""})});if(200===a.status){const e=await a.json(),t=JSON.parse(e);return 0===t.ID_MOTIU_VULNERABILITAT&&(t.ID_MOTIU_VULNERABILITAT=null),e=>{e.AVALUACIO_NEEA_EAP=t.AVALUACIO_NEEA_EAP,e.AVALUACIO_NEEA=t.AVALUACIO_NEEA,e.AVALUACIO_NEEB=t.AVALUACIO_NEEB,e.INSCRIPCIOFINAL_NEEB=t.INSCRIPCIOFINAL_NEEB,e.ENTREVISTAR_NEEB=t.ENTREVISTAR_NEEB,e.MARCA_AUTO=t.MARCA_AUTO,e.MARCA_FINAL=t.MARCA_FINAL,e.PENDENT_INSCRIPCIO_FINAL_NEEA="Sí"===e.ES_NEEA&&"Ordinari"===e.TIPUS_ALUMNE_GEDAC&&(!e.INSCRIPCIOFINAL_NEEA||"Pendent decisió"===e.INSCRIPCIOFINAL_NEEA)}}}function D(e,t){if(!["AVALUACIO_NEEA","AVALUACIO_NEEA_EAP","ES_NEEA","TIPUS_ESCOLARITZACIO","ID_MOTIU_NESE","SENSE_BARRERES","SIEI","SIAL","ACORD_NEEA","ID_MOTIU_NESE","INSCRIPCIOFINAL_NEEA","ID_MOTIU_VULNERABILITAT","INSCRIPCIOFINAL_NEEB","ID_CENTRE_PROPOSAT1","ID_CENTRE_PROPOSAT2","ID_CENTRE_COMPARTIDA"].includes(t.name))return["ES_NEEB","AVALUACIO_NEEB"].includes(t.name)?"Completa"===e.AVALUACIO_NEEB?"avaluacioValid":"avaluacioInvalid":null;switch(t.name){case"AVALUACIO_NEEA":return"Completa"===e.AVALUACIO_NEEA?"avaluacioValid":"avaluacioInvalid";case"AVALUACIO_NEEA_EAP":return"Completa"===e.AVALUACIO_NEEA_EAP?"avaluacioValid":"avaluacioInvalid";case"ES_NEEA":return e.ES_NEEA&&"Pendent d'avaluar"!==e.ES_NEEA?null:"avaluacioInvalid";case"ID_MOTIU_NESE":return"Sí"===e.ES_NEEA&&0===e.AANEE_ALUMNE_MOTIU_NESE.length?"avaluacioInvalid":null;case"TIPUS_ESCOLARITZACIO":return e.TIPUS_ESCOLARITZACIO||"Sí"!==e.ES_NEEA?null:"avaluacioInvalid";case"SENSE_BARRERES":return e.SENSE_BARRERES||"Ordinària"!==e.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid";case"SIEI":return e.SIEI||"Ordinària"!==e.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid";case"SIAL":return e.SIAL||"Ordinària"!==e.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid";case"ID_CENTRE_PROPOSAT1":return e.ID_CENTRE_PROPOSAT1||"Sí"!==e.SENSE_BARRERES&&!["Especial","Compartida"].includes(e.TIPUS_ESCOLARITZACIO)?null:"avaluacioInvalid";case"ID_CENTRE_PROPOSAT2":return e.ID_CENTRE_PROPOSAT2||"Especial"!==e.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid";case"ID_CENTRE_PROPOSAT_COMPARTIDA":return e.ID_CENTRE_COMPARTIDA||"Compartida"!==e.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid";case"ACORD_NEEA":return e.ACORD_NEEA||!e.TIPUS_ESCOLARITZACIO||"Ordinària"===e.TIPUS_ESCOLARITZACIO&&"Sí"!==e.SIEI?null:"avaluacioInvalid";case"INSCRIPCIOFINAL_NEEA":return"Sí"===e.ES_NEEA&&"Ordinària"===e.TIPUS_ESCOLARITZACIO&&"Pendent decisió"===(!e.INSCRIPCIOFINAL_NEEA||e.INSCRIPCIOFINAL_NEEA)?"avaluacioInvalid":null;case"INSCRIPCIOFINAL_NEEB":return"Sí"!==e.ES_NEEB||"Ordinari"!==e.TIPUS_ALUMNE_GEDAC||e.INSCRIPCIOFINAL_NEEB?null:"avaluacioInvalid";case"ID_MOTIU_VULNERABILITAT":return"Sí"!==e.ES_NEEB||e.ID_MOTIU_VULNERABILITAT?null:"avaluacioInvalid"}}const v={__name:"details-cell-boolean",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.computed)((()=>t.row[t.field.name]));return(e,t)=>{const l=(0,n.resolveComponent)("fura-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[!0===(0,n.unref)(a)||1===(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,class:"detailsCellBoolean-true",name:"CheckMark"})):((0,n.openBlock)(),(0,n.createBlock)(l,{key:1,class:"detailsCellBoolean-false",name:"Cancel"}))])}}};var R=d(744);const h=(0,R.Z)(v,[["__scopeId","data-v-3f173500"]]),L={__name:"form-field-boolean",props:{label:{type:String,default:void 0},boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0},align:{type:String,default:void 0,validator:e=>!e||["left","center","right"].includes(e)}},emits:["change"],setup(e,{emit:t}){const a=e;a.validations?.createField(a.name??a.field.name,(0,n.computed)((()=>a.entity[a.name??a.field.name])));const l=(0,n.computed)((()=>(a.nullable??a.field.nullable)&&null===a.entity[a.name??a.field.name])),i=(0,n.computed)((()=>{const e=a.align??a.field.align;return["left","center","right"].includes(e)?`formFieldBoolean-${e}`:null}));function o(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(0,n.watch)([()=>a.disabled,()=>a.field?.disabled],(([e,n])=>{if(null!=(e??n)&&(a.clearValueOnDisabled??a.field.clearValueOnDisabled)){const e=a.name??a.field.name;a.nullable??a.field.nullable?t("change",(t=>{t[e]=null})):t("change",(t=>{t[e]=!1}))}})),(t,a)=>{const r=(0,n.resolveComponent)("fura-checkbox");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)((0,n.unref)(i))},[(0,n.createVNode)(r,{label:e.label??e.field.label,"box-side":e.boxSide??e.field.boxSide,disabled:e.disabled??e.field.disabled,readonly:e.readonly??e.field.readonly,indeterminate:(0,n.unref)(l),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":o},null,8,["label","box-side","disabled","readonly","indeterminate","model-value"])],2)}}},x=(0,R.Z)(L,[["__scopeId","data-v-2f45898e"]]),U={__name:"grid-field-boolean",props:{boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0},alignGrid:{type:String,default:"center"}},emits:["change"],setup(e,{emit:t}){const a=e;return(l,i)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(x),(0,n.mergeProps)({...a,label:""},{align:e.alignGrid??e.field.alignGrid,class:"field",onChange:i[0]||(i[0]=e=>t("change",e))}),null,16,["align"]))}};function M(e,t){return t[e.name]?"Sí":!1===t[e.name]?"No":""}const P={detailsCell:h,formField:x,gridField:(0,R.Z)(U,[["__scopeId","data-v-1198e7f8"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){if("eq"===e.operation)return`${e.name} eq @${e.name}`},getFilterInterface(e){if("eq"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"boolean"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:M,getCsvValueFromEntity:M},V={eq:40,ne:30,gt:70,ge:50,lt:80,le:60,and:20,or:10,add:100,sub:90,mul:130,div:120,mod:110,has:150,in:140},F=Object.keys(V),w=["cast","ceiling","concat","contains","date","day","endswith","fractionalseconds","floor","hassubsequence","hassubset","hour","indexof","isof","length","matchesPattern","maxdatetime","mindatetime","minute","month","now","replace","round","second","startswith","substring","substringof","time","tolower","totaloffsetminutes","totalseconds","toupper","trim","year"],G=["all","any"];class B extends Error{constructor(e,t,a){super(`${e}. Starting at position ${t} and ending at ${a}.`),this.displayMessage=e,this.indexStart=t,this.indexEnd=a}}const k=new RegExp(`^(${F.join("|")})\\b`,"i"),$=new RegExp(`^(${w.join("|")})\\b`,"i"),q=new RegExp(`^(${["not","true","false","null","NaN","INF"].join("|")})\\b`);function j(e){return function(t,a){const n=t.substring(a),[l]=n.match(e);return{value:l,newIndex:a+l.length}}}const K=[{name:"EOS",test:(e,t)=>t>=e.length,reader:(e,t)=>({value:null,newIndex:e.length})},{name:"WHITESPACE",test:(e,t)=>/\s/.test(e[t]??""),reader:j(/^(\s+)/)},{name:"LITERAL",test:(e,t)=>"$"===e[t],reader:j(/^(\$[a-zA-Z]\w+)/)},{name:"ALIAS",test:(e,t)=>"@"===e[t],reader:j(/^(@[a-zA-Z]\w+)/)},{name:"GUID",test:(e,t)=>/^\d{8}-\d{4}-\d{4}-\d{4}-\d{12}/.test(e.substring(t)),reader:j(/^(\d{8}-\d{4}-\d{4}-\d{4}-\d{12})/)},{name:"DATE",test:(e,t)=>/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)/.test(e.substring(t)),reader:function(e,t){const a=j(/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z))/)(e,t);return a.value=new Date(a.value),a}},{name:"NUMBER",test:(e,t)=>/^-?\d/.test(e.substring(t)),reader:function(e,t){const a=j(/^(-?\d+(?:\.\d+)?(?:e-?\d+)?)/)(e,t);return a.value=Number(a.value),a}},{name:"PUNCTUATION",test:(e,t)=>["/","(",")","[","]",",",".",":","-"].includes(e[t]),reader:(e,t)=>({value:e[t],newIndex:t+1})},{name:"STRING",test:(e,t)=>"'"===e[t],reader:function(e,t){let a="",n=t+1,l=!0;for(;l;){if(n>=e.length)throw new B("Unclosed string",t,n);const i=e[n];n+=1,"'"===i?"'"===e[n]?(a+="'",n+=1):l=!1:a+=i}return{value:a,newIndex:n}}},{name:"OPERATOR",test:(e,t)=>k.test(e.substring(t)),reader:j(k)},{name:"FUNCTION",test:(e,t)=>$.test(e.substring(t)),reader:j($)},{name:"KEYWORD",test:(e,t)=>q.test(e.substring(t)),reader:j(q)},{name:"NAME",test:(e,t)=>/[a-zA-Z]/.test(e[t]??""),reader:j(/^\w*/)}];function z(e,t){for(const a of K)if(a.test(e,t)){const{value:n,newIndex:l}=a.reader(e,t);return{type:a.name,value:n,indexStart:Math.min(t,e.length),indexEnd:l}}throw new B(`Unexpected character '${e[t]}'`,t,t+1)}function Z(e,t){let a=z(e,t);for(;"WHITESPACE"===a.type;)a=z(e,a.indexEnd);return a}function X(e){return W(e)}function W(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=H(e);return e.advance("PUNCTUATION",")"),t}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=H(e);return e.advance("PUNCTUATION","]"),t}if(e.check("KEYWORD",["true","false"]))return function(e){return{type:"boolean",value:e.advance("KEYWORD",["true","false"]).value}}(e);if(e.check("KEYWORD",["null","NaN","INF"]))return function(e){return{type:"constant",value:e.advance("KEYWORD",["null","NaN","INF"]).value}}(e);if(e.check("DATE"))return function(e){return{type:"date",value:e.advance("DATE").value}}(e);if(e.check("NUMBER"))return function(e){return{type:"number",value:e.advance("NUMBER").value}}(e);if(e.check("GUID"))return function(e){return{type:"guid",value:e.advance("GUID").value}}(e);if(e.check("STRING"))return function(e){return{type:"string",value:e.advance("STRING").value}}(e);if(e.check("ALIAS"))return function(e){return{type:"alias",value:e.advance("ALIAS").value}}(e);if(e.check("PUNCTUATION","-")||e.check("KEYWORD","not"))return function(e){return e.check("PUNCTUATION","-")?e.advance("PUNCTUATION","-"):e.check("KEYWORD","not")&&e.advance("KEYWORD","not"),{type:"negative",value:W(e)}}(e);if(e.check("FUNCTION"))return function(e){const t=e.advance("FUNCTION"),a=function(e){const t=[];let a=!0;for(e.advance("PUNCTUATION","(");!e.check("EOS")&&!e.check("PUNCTUATION",")");)a?a=!1:e.advance("PUNCTUATION",","),t.push(X(e));return e.advance("PUNCTUATION",")"),t}(e);return{type:"functionCall",name:t.value,parameters:a}}(e);if(e.check("NAME")||e.check("LITERAL"))return function(e){const t=[];for(;e.check(["NAME","LITERAL"])&&e.checkNext("PUNCTUATION","/");)t.push(e.advance(["NAME","LITERAL"]).value),e.advance("PUNCTUATION","/");if(G.some((t=>e.check("NAME",t)))&&e.checkNext("PUNCTUATION","(")){const a=e.advance("NAME").value;e.advance("PUNCTUATION","(");const n=e.advance("NAME").value;e.advance("PUNCTUATION",":");const l=J(e);return e.advance("PUNCTUATION",")"),{type:"lambda",navigation:t.length>0?t:null,operation:a,name:n,expression:l}}if(e.check("NAME"))return{type:"property",navigation:t.length>0?t:null,value:e.advance("NAME").value};if(e.check("LITERAL"))return{type:"literal",navigation:t.length>0?t:null,value:e.advance("LITERAL").value};throw new B(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}(e);throw new B(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}function H(e){const t=[J(e)];for(;e.check("PUNCTUATION",",");)e.advance("PUNCTUATION",","),t.push(J(e));return{type:"collection",value:t}}function Y(e,t,a=0){if(e.check("OPERATOR")){const n=V[e.current.value];if(n>a){const l=e.advance("OPERATOR").value,i=Y(e,W(e),n);return Y(e,{type:"binaryOp",operator:l,left:t,right:i},a)}}return t}function J(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=H(e);return e.advance("PUNCTUATION",")"),Y(e,t)}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=H(e);return e.advance("PUNCTUATION","]"),Y(e,t)}return Y(e,W(e))}const Q={collection:e=>1===e.value.length?ae(e.value[0]):e.value.map(ae),boolean(e){if("true"===e.value)return!0;if("false"===e.value)return!1;throw new Error},constant(e){if("null"===e.value)return null;if("NaN"===e.value)return NaN;if("INF"===e.value)return Number.POSITIVE_INFINITY;throw new Error},date:e=>e.value,number:e=>e.value,string:e=>e.value,guid:e=>({guid:e.value}),alias:e=>({alias:e.value}),negative:e=>({not:ee(e.value)}),functionCall:e=>({[e.name]:e.parameters.map(ee)}),lambda:e=>({lambda:e.operation,path:e.navigation?.join("/"),name:e.name,expression:ae(e.expression)}),property:e=>({property:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value}),literal:e=>({literal:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value})};function ee(e){return Array.isArray(e)?e.map((e=>ae(e))):e.type in Q?Q[e.type](e):void 0}function te(e){if(["and","or","add","sub","mul","div"].includes(e.operator)){const t=[],a=a=>"binaryOp"===a.type&&a.operator===e.operator?t.push(...te(a)[e.operator]):t.push(ae(a));return a(e.left),a(e.right),{[e.operator]:t}}return{[e.operator]:[ae(e.left),ae(e.right)]}}function ae(e){return"collection"===e.type?1===e.value.length&&["binaryOp","collection","lambda","functionCall"].includes(e.value[0].type)?ae(e.value[0]):e.value.map(ae):"binaryOp"===e.type?te(e):ee(e)}function ne(e){const t=function(e){let t=0,a=Z(e,t),n=Z(e,a.indexEnd);return t=n.indexEnd,{get current(){return a},get next(){return n},check(e,t){if(null!=e){if(Array.isArray(e))return e.includes(a.type);if(e!==a.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(a.value);if(t!==a.value)return!1}return!0},checkNext(e,t){if(null!=e){if(Array.isArray(e))return e.includes(n.type);if(e!==n.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(n.value);if(t!==n.value)return!1}return!0},advance(l,i){if(null!=l)if(Array.isArray(l)){if(!l.includes(a.type))throw new B(`Expected a token with a set of types, but found '${a.type}'`,a.indexStart,a.indexEnd)}else if(a.type!==l)throw new B(`Expected a token with type '${l}', but found '${a.type}'`,a.indexStart,a.indexEnd);if(null!=i)if(Array.isArray(i)){if(!i.includes(a.value))throw new B(`Expected a token with a set of values, but found '${a.value}'`,a.indexStart,a.indexEnd)}else if(a.value!==i)throw new B(`Expected a token with value '${i}', but found '${a.value}'`,a.indexStart,a.indexEnd);const o=a;return a=n,n=Z(e,t),t=n.indexEnd,o},advanceIfExists(e,t){if(e&&a.type!==e)return null;if(null!=t)if(Array.isArray(t)){if(!t.includes(a.value))return null}else if(a.value!==t)return null;return this.advance(e,t)}}}(e);var a;return ae(Y(a=t,J(a)))}function le(e,t){if(void 0===e||"symbol"==typeof e)return;if(null===e)return"null";if(e===Number.POSITIVE_INFINITY)return"INF";if(e===isNaN)return"NaN";if(e instanceof Date)return e.toISOString();if("string"==typeof e)return e.includes("'")?`'${e.replace(/'/g,"''")}'`:`'${e}'`;if("number"==typeof e||"bigint"==typeof e||"boolean"==typeof e)return String(e);if(e.not)return"-"+le(e.not,t);if(Array.isArray(e))return`(${e.map((e=>le(e,t))).join()})`;if(e.lambda)return`${e.path}/${e.lambda}(${e.name}:${le(e.expression,t)})`;if(e.guid)return e.guid;if(e.alias){const a=e.alias.substring(1),n=Array.isArray(t)&&t.find((([e])=>e===a));return n?le(n[1],t):e.alias}if(e.property)return e.property;if(e.literal)return e.literal;const a=w.find((t=>t in e));if(a)return Array.isArray(e[a])?`${a}(${e[a].map((e=>le(e,t))).join()})`:`${a}(${le(e[a],t)})`;const n=F.find((t=>t in e));if(n)return`(${e[n].map((e=>le(e,t))).join(` ${n} `)})`;throw new Error("El filtro odata no se reconoce.")}const ie={collection(e,t,a,n){for(let l=0;l<e.length;l+=1)if(oe(e[l],t,a,[...n,l]))return!0},negative(e,t,a,n){if("pre"===a.order){if(t(e,n))return!0;if(oe(e.not,t,a,[...n,"not"]))return!0}else if("post"===a.order){if(oe(e.not,t,a,[...n,"not"]))return!0;if(t(e,n))return!0}},functionCall(e,t,a,n){const l=w.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(ie.collection(e[l],t,a,[...n,l]))return!0}else if("post"===a.order){if(ie.collection(e[l],t,a,[...n,l]))return!0;if(t(e,n))return!0}},lambda(e,t,a,n){const l=`${e.path}/${e.lambda}`;if("pre"===a.order){if(t(e,n))return!0;if(oe(e.expression,t,a,[...n,l]))return!0}else if("post"===a.order){if(oe(e.expression,t,a,[...n,l]))return!0;if(t(e,n))return!0}},operators(e,t,a,n){const l=F.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(ie.collection(e[l],t,a,[...n,l]))return!0}else if("post"===a.order){if(ie.collection(e[l],t,a,[...n,l]))return!0;if(t(e,n))return!0}}};function oe(e,t,a={order:"post"},n=[]){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e||e===isNaN||e===Number.POSITIVE_INFINITY||e instanceof Date||e.guid||e.alias||e.property||e.literal?t(e,n):Array.isArray(e)?ie.collection(e,t,a,n):e.not?ie.negative(e,t,a,n):w.some((t=>t in e))?ie.functionCall(e,t,a,n):e.lambda?ie.lambda(e,t,a,n):F.some((t=>t in e))?ie.operators(e,t,a,n):void 0}function re(e,t,a){if(Array.isArray(a)&&"string"==typeof e?.alias&&1===Object.keys(e).length)return a.push([e.alias.substring(1),t]),!0;if(typeof e==typeof t){if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){const n=Array.isArray(a)?[]:null;let l=!0;for(let a=0;a<e.length;a+=1){const i=re(e[a],t[a],n);if(!1===i)return!1;Array.isArray(i)&&(l=i)}return l&&n?.length>0&&a.push(...n),l}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("object"==typeof e){const n=Object.keys(e),l=Object.keys(t);if(n.length===l.length&&n.every((e=>l.includes(e)))){const l=Array.isArray(a)?[]:null;let i=!0;for(const a of n){const n=re(e[a],t[a],l);if(!1===n)return!1;Array.isArray(n)&&(i=n)}return i&&l?.length>0&&a.push(...l),i}}return e===t}return!1}class se{constructor(e,t=null){this.conditions=[];for(const t of e)if(t instanceof se)this.conditions.push(t);else{if("string"!=typeof t)throw new Error;{const e=ne(t),a=[];oe(e,((e,t)=>{e.alias&&a.push({name:e.alias.substring(1),path:e.path})})),this.conditions.push({filter:t,structure:e,aliases:a})}}this.aggrupationOperation=t}getConditionValue(e){const t=[];for(const a of this.conditions)if(a instanceof se){const n=a.getConditionValue(e);n.length>0&&t.push(...n)}else re(a.structure,e,t);return t}readFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];if(e){const a=ne(e),n=Array.isArray(a[this.aggrupationOperation])?[a,...a[this.aggrupationOperation]]:[a];for(const e of n){const a=this.getConditionValue(e);a.length>0&&t.push(...a)}}return t}findValuesInFilter(e){const t=[];return oe(ne(e),(e=>{const a=this.getConditionValue(e);a.length>0&&t.push(...a)})),t}writeFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];for(const a of this.conditions)if(a instanceof se){const n=a.writeFilter(e);n&&t.push(n)}else a.aliases.every((t=>e.some((([e])=>t.name===e))))&&t.push(le(a.structure,e));return t.length>0?`(${t.join(` ${this.aggrupationOperation} `)})`:""}}const de=["textContent"],ue={__name:"details-cell-generic",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.ref)("");return(0,n.watchEffect)((async()=>{if(t.field&&t.row){const e=kt[t.field.type];a.value="function"==typeof e?.getTextValueFromEntity?await e.getTextValueFromEntity(t.field,t.row):t.row[t.field.name]}else a.value=""})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{textContent:(0,n.toDisplayString)(a.value)},null,8,de))}},ce=(0,R.Z)(ue,[["__scopeId","data-v-29f5092a"]]);function me(e,t){return t[e.navigationKey]?.["@odata.count"]??""}const Ee={detailsCell:ce,getDetailsODataQuery:e=>({$expand:`${e.navigationKey}($count=true;$top=0)`}),getOrderbySentence:e=>`${e.navigationKey}/$count`,getFilterCondition:e=>"eq"===e.operation?`${e.navigationKey}/$count eq @${e.name}`:"between"===e.operation?new se([`${e.navigationKey}/$count gt @${e.name}_gt`,`${e.navigationKey}/$count lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} >=`},{type:"number",name:`${e.name}_lt`,label:`${e.label} <=`}]:void 0,getTextValueFromEntity:me,getCsvValueFromEntity:me},pe={__name:"form-field-choice",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>(a.options||a.field.options).map((e=>"string"==typeof e?{value:e,text:e}:e))));function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,o)=>{const r=(0,n.resolveComponent)("llesca-field-dropdown");return(0,n.openBlock)(),(0,n.createBlock)(r,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,options:(0,n.unref)(l),placeholder:e.placeholder??e.field.placeholder,readonly:e.readonly??e.field.readonly,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i,onFocus:o[0]||(o[0]=e=>t("focus",e)),onBlur:o[1]||(o[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","options","placeholder","readonly","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","model-value"])}}};function Ae({focusHandler:e,blurHandler:t,$emit:a}={}){const l=(0,n.ref)(!1),i=(0,n.computed)((()=>!l.value));return{focus:l,borderless:i,handleFocus(t){l.value=!0,e?.(t),a?.("focus",t)},handleBlur(e){l.value=!1,t?.(e),a?.("blur",e)}}}const Ie={__name:"grid-field-choice",props:{invalid:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(pe),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},Ne=(0,R.Z)(Ie,[["__scopeId","data-v-ce6a5b82"]]);function ye(e,t){return t[e.name]??""}const Ce={detailsCell:ce,formField:pe,gridField:Ne,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface(e){if(["eq","in"].includes(e.operation))return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation}},loadCache:async e=>e.options.map((e=>"string"==typeof e?{value:e,text:e}:e)),getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:ye,getCsvValueFromEntity:ye},fe=["textContent"],_e={__name:"details-cell-custom",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.ref)(""),l=(0,n.ref)("red");return(0,n.watchEffect)((async()=>{if(t.field&&t.row){l.value=t.field.setStyle&&"function"==typeof t.field.setStyle?t.field.setStyle(t.row):null;const e=kt[t.field.type];a.value="function"==typeof e?.getTextValueFromEntity?await e.getTextValueFromEntity(t.field,t.row):t.row[t.field.name]}else a.value=""})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{textContent:(0,n.toDisplayString)(a.value),style:(0,n.normalizeStyle)(l.value)},null,12,fe))}},Te=(0,R.Z)(_e,[["__scopeId","data-v-d1615be0"]]);function ge(e,t){return t[e.name]??""}const Oe={detailsCell:Te,formField:pe,gridField:Ne,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface(e){if(["eq","in"].includes(e.operation))return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation}},loadCache:async e=>e.options.map((e=>"string"==typeof e?{value:e,text:e}:e)),getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:ge,getCsvValueFromEntity:ge},Se={__name:"form-field-date",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-date");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,placeholder:e.placeholder??e.field.placeholder,"not-writable":e.notWritable??e.field.notWritable,days:e.days??e.field.days,months:e.months??e.field.months,"go-today":e.goToday??e.field.goToday,"first-day-of-the-week":e.firstDayOfTheWeek??e.field.firstDayOfTheWeek,today:e.today??e.field.today,parse:e.parse??e.field.parse,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,stringify:e.stringify??e.field.stringify,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","placeholder","not-writable","days","months","go-today","first-day-of-the-week","today","parse","stringify-focus","stringify","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},be={__name:"grid-field-date",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Se),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function De(e,t=2){return e.toString().padStart(t,"0")}function ve(e,t){if(!t[e.name])return"";const a=new Date(t[e.name]);return a?`${De(a.getDate())}/${De(a.getMonth()+1)}/${De(a.getFullYear(),4)}`:void 0}const Re={detailsCell:ce,formField:Se,gridField:(0,R.Z)(be,[["__scopeId","data-v-1980b3b4"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new se([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"date",name:e.name,label:e.label}:"between"===e.operation?[{type:"date",name:`${e.name}_gt`,label:`${e.label} <`},{type:"date",name:`${e.name}_lt`,label:`${e.label} >`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name],dateKeys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):e.defaultValue instanceof Date&&(t[e.name]=new Date(e.defaultValue.getTime())))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:ve,getCsvValueFromEntity:ve},he=(0,l.defineStore)({id:"dialog",state:()=>({loading:new Set,alertList:[],confirmList:[]}),actions:{loadStart(e){this.loading.add(e)},loadEnd(e){this.loading.delete(e)},alert(e){this.alertList.push(e)},alertClose(){const e=this.alertList.shift();if("function"==typeof e?.close)return e.close()},confirm(e){this.confirmList.push(e)},confirmAccept(){const e=this.confirmList.shift();if("function"==typeof e?.accept)return e.accept()},confirmCancel(){const e=this.confirmList.shift();if("function"==typeof e?.cancel)return e.cancel()}}});async function Le(e,t,a){const n=he();a||n.loadStart(e);try{const a=await t();return n.loadEnd(e),a}catch(t){throw n.loadEnd(e),t}}function xe(e,t,a={},{withoutDialog:n=!1}={}){return Le(Symbol("requestGet"),(()=>o.odata.requestGet([m,e].flat(),t,{Authorization:T().jwt,...a})),n)}function Ue(e,t,a={},{withoutDialog:n=!1}={}){return Le(Symbol("requestDelete"),(()=>o.odata.requestDelete([m,e].flat(),t,{Authorization:T().jwt,...a})),n)}function Me(e){const t=[],a=[];for(const n of e){const l=kt[n.type];if(l){const i=l.getDetailsODataQuery(n,e);i.$select&&!t.includes(i.$select)&&t.push(i.$select),!i.$expand||a.includes(i.$expand)||a.some((e=>e.startsWith(i.$expand)||i.$expand.startsWith(e)))||a.push(i.$expand)}}return{$select:t.length>0?t:void 0,$expand:a.length>0?a:void 0}}function Pe(e){return kt[e.type]?.getOrderbySentence(e)}function Ve(e,t,{notOverwrite:a}={}){for(const n of e.fields)kt[n.type].setDetaultValueToEntity?.(n,t,{notOverwrite:a})}function Fe(e){return Object.fromEntries(En().filter((e=>"dictionary"===e.type)).map((t=>[t.name,"function"==typeof e?e():e])))}const we=(0,l.defineStore)({id:"dictionary",state:()=>({data:Fe(null),loading:Fe((()=>({state:!1,callbacks:null})))}),actions:{loadDictionary(e,{force:t=!1}={}){const a=(0,n.unref)(e);if(En(a)&&"dictionary"===En(a).type){if(this.loading[a].state)return new Promise((e=>{this.loading[a].callbacks.push(e)}));if(!this.data[a]||t)return new Promise((e=>{const t=he();this.loading[a].state=!0,this.loading[a].callbacks=[],t.loadStart(`dictionary/${a}/load`),xe(a,{...Me(En(a).fields)}).then((n=>{this.data[a]=n.value,t.loadEnd(`dictionary/${a}/load`);const l=[e,...this.loading[a].callbacks];this.loading[a].state=!1,this.loading[a].callbacks=null,l.forEach((e=>e()))}))}))}return Promise.resolve()}}});function Ge(e,t){const a=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{const l=e.filter??e.field?.filter,i=e.useFilter??e.field?.useFilter;a.value="function"==typeof l?(0,n.unref)(t).filter(l):"function"==typeof i?(0,n.unref)(t).filter(i(e.entity)):(0,n.unref)(t)})),{filteredData:a}}const Be={__name:"form-field-dictionary",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=we(),i=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(i,(async e=>{await l.loadDictionary(e),o.value=l.data[e]}),{immediate:!0});const{filteredData:r}=Ge(a,o),s=(0,n.computed)((()=>En(i.value))),d=(0,n.computed)((()=>s.value.fields.find((e=>e.primary)).name)),u=(0,n.computed)((()=>s.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[d.value],text:e[u.value]})))));function m(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(c),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":m,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},ke={__name:"grid-field-dictionary",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(r,s)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Be),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:s[0]||(s[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}},$e=(0,R.Z)(ke,[["__scopeId","data-v-52de4e9c"]]);async function qe(e,t){const a=we();await a.loadDictionary(e.entityName);const n=En(e.entityName),l=n.fields.find((e=>e.primary)).name,i=n.fields.find((e=>e.defaultField)).name,o=t[e.name],r=a.data[e.entityName]?.find((e=>e[l]===o));return r?.[i]??""}const je={detailsCell:ce,formField:Be,gridField:$e,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>`${e.navigationKey||e.entityName}/${En(e.entityName).fields.find((e=>e.defaultField)).name}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.navigationKey||e.entityName}/${En(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0,getFilterInterface(e){if("eq"===e.operation){const t=En(e.entityName);return{type:"combo",name:e.name,label:e.label,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("in"===e.operation){const t=En(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=we();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:qe,getCsvValueFromEntity:qe};async function Ke(e,t){const a=we();await a.loadDictionary(e.entityName);const n=En(e.entityName),l=n.fields.find((e=>e.primary)).name,i=n.fields.find((e=>e.defaultField)).name,o=t[e.name],r=a.data[e.entityName]?.find((e=>e[l]===o));return r?.[i]??""}const ze={detailsCell:ce,formField:Be,gridField:$e,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>`${e.navigationKey||e.entityName}/${En(e.entityName).fields.find((e=>e.defaultField)).name}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.navigationKey||e.entityName}/${En(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0,getFilterInterface(e){if("eq"===e.operation){const t=En(e.entityName);return{type:"comboCustom",name:e.name,label:e.label,setDisabled:e.setDisabled,setValue:e.setValue,defaultValue:e.defaultValue,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("in"===e.operation){const t=En(e.entityName);return{type:"comboCustom",name:e.name,label:e.label,multiple:!0,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=we();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Ke,getCsvValueFromEntity:Ke},Ze={__name:"form-field-dictionary-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=we(),i=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(i,(async e=>{await l.loadDictionary(e),o.value=l.data[e]}),{immediate:!0});const{filteredData:r}=Ge(a,o),s=(0,n.computed)((()=>En(i.value))),d=(0,n.computed)((()=>s.value.fields.find((e=>e.primary)).name)),u=(0,n.computed)((()=>s.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[d.value],text:e[u.value]}))))),m=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),E=(0,n.computed)({get(){const e=a.junctionDictionaryKey??a.field.junction.dictionaryKey;return a.entity[m.value].map((t=>t[e]))},set(e){const n=a.junctionDictionaryKey??a.field.junction.dictionaryKey;t("change",(t=>{const a=t[m.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(c),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(E),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.isRef)(E)?E.value=e:null),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},Xe={__name:"grid-field-dictionary-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ze),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};async function We(e,t){const a=we();await a.loadDictionary(e.entityName);const n=En(e.entityName),l=n.fields.find((e=>e.primary)).name,i=n.fields.find((e=>e.defaultField)).name,o=e.junction.navigationKey||e.junction.name,r=a.data[e.entityName];return t[o]?.map((t=>r?.find((a=>a[l]===t[e.junction.dictionaryKey]))?.[i])).filter((e=>e)).join(", ")||""}const He={detailsCell:ce,formField:Ze,gridField:(0,R.Z)(Xe,[["__scopeId","data-v-e6e02e5c"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($select=${e.junction.primaryKey},${e.junction.dictionaryKey})`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.dictionaryKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${En(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0},getFilterInterface(e){if("in"===e.operation){const t=En(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=we();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:l,ownerKey:i,dictionaryKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:l,foreingKey:i,keys:[l,i,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.dictionaryKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:We,getCsvValueFromEntity:We};function Ye(e){const t=et(e,e.form);return(0,o.useEntity)(t)}function Je(e){const t=T();return(0,o.entitySave)(e,m,{Authorization:t.jwt})}function Qe(e){const t=T();return(0,o.entityDelete)(e,m,{Authorization:t.jwt})}function et(e,{navigationKey:t=null,children:a=[],foreingKey:n=null,detailFields:l=[]}){const i={navigationKey:t,entityName:e.name||e.entityName,primaryKey:e.fields.find((e=>e.primary)).name,foreingKey:n,keys:null,dateKeys:null,children:null,details:null};for(const e of a){const t=En(e.listName);i.children=nt(i.children,[et(t,e)])}for(const t of e.fields){const{getPropertyDefinition:e}=kt[t.type]||{};if("function"==typeof e){const a=e(t,!0===l||l?.includes(t.name));i.keys=at(i.keys,a.keys),i.ignoredKeys=at(i.ignoredKeys,a.ignoredKeys),i.dateKeys=at(i.dateKeys,a.dateKeys),i.children=nt(i.children,a.children),i.details=nt(i.details,a.details)}}return i}function tt(e,...t){for(const a of t)at(e.keys,a.keys),at(e.dateKeys,a.dateKeys),nt(e.children,a.children),nt(e.details,a.details);return e}function at(e,t){if(lt(e)&&lt(t))for(const a of t)e.includes(a)||e.push(a);else if(!lt(e)&&lt(t))return t;return e}function nt(e,t){if(lt(e)&&lt(t)){const a=[...t];for(const t of e){const e=a.findIndex((e=>t.navigationKey==e.navigationKey&&t.entityName===e.entityName&&t.primaryKey===e.primaryKey&&t.foreingKey===e.foreingKey));if(e>=0){const[n]=a.splice(e,1);tt(t,n)}}e.push(...a)}else if(!lt(e)&&lt(t))return t;return e}function lt(e){return Array.isArray(e)&&e.length>0}function it(e,t){const{navigationKey:a,name:n,nameKey:l}=e.entity;return t[a||n]?.map((e=>e[l])).join()??""}const ot={detailsCell:ce,formField:{__name:"form-field-file-multi",props:{label:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},maxFiles:{type:Number,default:void 0},modelValue:{type:Array,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},navigationKey:{type:String,default:void 0},primaryKey:{type:String,default:void 0},foreingKey:{type:String,default:void 0},nameKey:{type:String,default:void 0},contentKey:{type:String,default:void 0},typeKey:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=he();function i(e){const t=new FileReader;t.addEventListener("load",(t=>{const n=a.entityName??a.field.entity?.name,l=a.navigationKey??a.field.entity?.navigationKey,i=a.nameKey??a.field.entity?.nameKey,o=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;a.entity[l??n].add({[i]:e.name,[r]:e.type,[o]:t.target.result.replace(/^.+,/,"")})})),t.addEventListener("error",(()=>l.alert({title:"Error",message:"Error al llegir el arxiu."}))),t.readAsDataURL(e)}function r(e){const t=a.entityName??a.field.entity?.name,n=a.navigationKey??a.field.entity?.navigationKey;a.entity[n??t].delete(e)}const s=(0,n.computed)((()=>{const e=a.entityName??a.field.entity?.name,t=a.navigationKey??a.field.entity?.navigationKey,n=a.primaryKey??a.field.entity?.primaryKey,l=a.nameKey??a.field.entity?.nameKey,i=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;return(0,o.entityData)(a.entity[t??e]).map((t=>[t[l],async()=>{if(!t[i]){const a=await xe(`${e}(${t[n]})`,{$select:i});t[i]=a[i]}return`data:application/octet-stream;base64,${t[i]}`},t[r]]))}));return(a,l)=>{const o=(0,n.resolveComponent)("fura-file-multi");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,disabled:e.disabled??e.field.disabled,required:e.required??e.field.required,readonly:e.readonly??e.field.readonly,"max-files":e.maxFiles??e.field.maxFiles,"model-value":(0,n.unref)(s),onLoad:i,onDelete:r,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","disabled","required","readonly","max-files","model-value"])}}},getDetailsODataQuery(e){const{name:t,navigationKey:a,primaryKey:n,foreingKey:l,nameKey:i,contentKey:o,typeKey:r}=e.entity;return{$expand:`${a||t}($select=${n},${l},${i},${o},${r})`}},getOrderbySentence:e=>null,getFilterCondition(e){if("has"===e.operation)return`(${e.entity.navigationKey||e.entity.name}/$count ne 0) eq @${e.name}`},getFilterInterface(e){if("has"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition(e,t){const{name:a,navigationKey:n,primaryKey:l,foreingKey:i,nameKey:o,contentKey:r,typeKey:s}=e.entity;return{children:[{navigationKey:n,entityName:a,primaryKey:l,foreingKey:i,keys:[l,i,o,r,s],ignoredKeys:[r]}]}},getTextValueFromEntity:it,getCsvValueFromEntity:it},rt=["value"];function st(e,t){return t[e.name]??""}const dt={detailsCell:ce,formField:{__name:"form-field-hidden",props:{name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e){const t=e,a=t.name||t.field.name,l=(0,n.computed)((()=>t.entity[a]));return t.validations.createField(a,l),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("input",{type:"hidden",value:String((0,n.unref)(l))},null,8,rt))}},getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){},getFilterInterface(e){},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:st,getCsvValueFromEntity:st},ut={__name:"form-field-lookup",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=T(),i=he(),r=(0,n.computed)((()=>a.entityName??a.field.entity.name)),s=(0,n.computed)((()=>a.primaryKey??a.field.entity.primaryKey)),d=(0,n.computed)((()=>a.targetKey??a.field.entity.targetKey)),{options:u,isLoading:c}=(0,o.useOptionsLoader)(m,r,s,d,{$filter:(0,n.computed)((()=>a.filter??a.field.filter))},{Authorization:l.jwt});function E(e){const n=a.name??a.field.name,l=(a.navigationKey??a.field.entity.navigationKey)||r.value,i=u.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[l]={[d.value]:i}}))}return(0,n.watch)(c,(e=>e&&r.value?i.loadStart(`list/${r.value}/load`):i.loadEnd(`list/${r.value}/load`)),{immediate:!0}),(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(u),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":E,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},ct={__name:"grid-field-lookup",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(r,s)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ut),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:s[0]||(s[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function mt(e,t){const{navigationKey:a,name:n,targetKey:l}=e.entity;return t[a||n]?.[l]??""}const Et={detailsCell:ce,formField:ut,gridField:(0,R.Z)(ct,[["__scopeId","data-v-3746c692"]]),getDetailsODataQuery(e){const t=e.entity.navigationKey||e.entity.name;return{$select:e.name,$expand:`${t}($select=${e.entity.targetKey})`}},getOrderbySentence:e=>`${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}, @${e.name})`:void 0,getFilterInterface:e=>"eq"===e.operation?{type:"combo",name:e.name,label:e.label,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t=!1)=>({keys:[e.name],details:t?[{navigationKey:e.entity.navigationKey,entityName:e.entity.name,keys:[e.entity.targetKey]}]:null}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:mt,getCsvValueFromEntity:mt},pt=(0,l.defineStore)({id:"listCache",state:()=>({contextName:null,data:{}}),actions:{setContextName(e){const t=(0,n.toRaw)(e);this.contextName!==t&&(this.contextName=t,this.data={})},async load(e,{force:t=!1}={}){const a=(0,n.toRaw)(e);if(t||!(a in this.data)){const e=En(a);if(e){this.data[a]={};const t=[];for(const a of e.fields)kt[a.type]?.loadCache&&t.push({name:a.name,promise:kt[a.type].loadCache(a,e.fields)});const n=await Promise.all(t.map((e=>e.promise)));for(let e=0;e<n.length;e+=1){const l=t[e].name;this.data[a][l]=n[e]}}}},async reloadField(e,t){const a=(0,n.toRaw)(e);if(this.data[a]){const e=En(a);if(e){const l=e.fields.find((e=>e.name===(0,n.toRaw)(t)));if(l){const t=kt[l.type];t&&t.loadCache&&(this.data[a][l.name]=await t.loadCache(l,e.fields))}}}},setData(e,t){this.data[e]=t}}}),At={__name:"form-field-lookup-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=pt(),i=(0,n.computed)((()=>l.data[a.cacheName]?.[a.field.name]||[])),{filteredData:o}=Ge(a,i),r=(0,n.computed)((()=>a.field.entity.primaryKey)),s=(0,n.computed)((()=>a.field.entity.targetKey)),d=(0,n.computed)((()=>o.value.map((e=>({value:e[r.value],text:e[s.value]})))));function u(e){const n=a.name??a.field.name,l=a.field.entity.navigationKey||a.field.entity.name,i=d.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[l]={[s.value]:i}}))}return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(d),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":u,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},It={__name:"grid-field-lookup-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(At),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},Nt=(0,R.Z)(It,[["__scopeId","data-v-bccf8768"]]),yt={...Et,formField:At,gridField:Nt,loadCache:async e=>(await xe(e.entity.name,{$select:[e.entity.primaryKey,e.entity.targetKey,...e.entity.cache||[]],$orderby:e.entity.targetKey})).value},Ct={__name:"grid-field-lookup-detail",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(r,s)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ut),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:s[0]||(s[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function ft(e,t){const{navigationKey:a,name:n,targetKey:l}=e.entity;return t[a||n]?.[l]??""}const _t={detailsCell:ce,formField:ut,gridField:(0,R.Z)(Ct,[["__scopeId","data-v-7d8388f4"]]),getDetailsODataQuery(e){const t=e.entity.navigationKey||e.entity.name;return{$select:e.baseName,$expand:`${t}($select=${e.entity.targetKey})`}},getOrderbySentence:e=>`${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}, @${e.name})`:void 0,getFilterInterface:e=>"eq"===e.operation?{type:"combo",name:e.baseName||e.name,label:e.label,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"in"===e.operation?{type:"combo",name:e.baseName||e.name,label:e.label,multiple:!0,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"contains"===e.operation?{type:"text",name:e.baseName||e.name,label:e.label}:void 0,getPropertyDefinition:(e,t=!1)=>({keys:[e.name],details:t?[{navigationKey:e.entity.navigationKey,entityName:e.entity.name,keys:[e.entity.targetKey]}]:null}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.baseName],getTextValueFromEntity:ft,getCsvValueFromEntity:ft},Tt={__name:"form-field-lookup-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.shallowRef)([]);(0,n.watchEffect)((async()=>{const e=a.dataEntityName??a.field.data?.name,t=a.dataPrimaryKey??a.field.data?.primaryKey,n=a.dataTargetKey??a.field.data?.targetKey,i=a.filter??a.field.data.filter,o=await xe(e,{$select:`${t},${n}`,$filter:i||void 0,$orderby:`${n} asc`});l.value=o.value.map((e=>({value:e[t],text:e[n]})))}));const i=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),r=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[i.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[i.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(o,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(l),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(r),"onUpdate:modelValue":i[0]||(i[0]=e=>(0,n.isRef)(r)?r.value=e:null),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},gt=Tt,Ot={__name:"grid-field-lookup-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(r,s)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(gt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:s[0]||(s[0]=e=>t("change",e)),"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}};function St(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.data.navigationKey||e.data.name,l=e.data.targetKey;return t[a]?.map((e=>e[n][l])).join(", ")??""}const bt={detailsCell:ce,formField:gt,gridField:(0,R.Z)(Ot,[["__scopeId","data-v-a34b1a5c"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($expand=${e.data.navigationKey||e.data.name}($select=${e.data.primaryKey},${e.data.targetKey};$orderby=${e.data.targetKey}))`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.targetKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${e.entity.targetKey}, @${e.name})`:void 0},getFilterInterface:e=>"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:e.data.primaryKey,textKey:e.data.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:l,ownerKey:i,targetKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:l,foreingKey:i,keys:[l,i,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.targetKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:St,getCsvValueFromEntity:St},Dt={__name:"form-field-lookup-multi-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=pt(),i=(0,n.computed)((()=>l.data[a.cacheName]?.[a.field.name]||[])),{filteredData:r}=Ge(a,i),s=(0,n.computed)((()=>a.field.data.primaryKey)),d=(0,n.computed)((()=>a.field.data.targetKey)),u=(0,n.computed)((()=>r.value.map((e=>({value:e[s.value],text:e[d.value]}))))),c=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),m=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[c.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[c.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(u),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(m),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.isRef)(m)?m.value=e:null),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},vt={__name:"grid-field-lookup-multi-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Dt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},Rt=(0,R.Z)(vt,[["__scopeId","data-v-754a3117"]]),ht={...bt,formField:Dt,gridField:Rt,loadCache:async e=>(await xe(e.data.name,{$select:[e.data.primaryKey,e.data.targetKey,...e.data.cache||[]],$orderby:e.data.targetKey})).value},Lt={__name:"form-field-number",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-number");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,maxlength:e.maxlength??e.field.maxlength,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,"format-style":e.formatStyle??e.field.formatStyle,"use-grouping":e.useGrouping??e.field.useGrouping,"minimum-integer-digits":e.minimumIntegerDigits??e.field.minimumIntegerDigits,"minimum-fraction-digits":e.minimumFractionDigits??e.field.minimumFractionDigits,"maximum-fraction-digits":e.maximumFractionDigits??e.field.maximumFractionDigits,"minimum-significant-digits":e.minimumSignificantDigits??e.field.minimumSignificantDigits,"maximum-significant-digits":e.maximumSignificantDigits??e.field.maximumSignificantDigits,parse:e.parse??e.field.parse,stringify:e.stringify??e.field.stringify,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,align:e.align??e.field.align,"align-focus":e.alignFocus??e.field.alignFocus,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","maxlength","unresizable","auto-adjust-height","format-style","use-grouping","minimum-integer-digits","minimum-fraction-digits","maximum-fraction-digits","minimum-significant-digits","maximum-significant-digits","parse","stringify","stringify-focus","align","align-focus","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},xt={__name:"grid-field-number",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Lt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onClick:r[1]||(r[1]=e=>t("click",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},Ut=(0,R.Z)(xt,[["__scopeId","data-v-794c5b06"]]),Mt={detailsCell:ce,formField:Lt,gridField:Ut,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new se([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} >`},{type:"number",name:`${e.name}_lt`,label:`${e.label} <`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"number"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity(e,t){const a=t[e.name];if(null==a||isNaN(a))return"";const n={style:e.formatStyle,currency:"EUR",useGrouping:e.useGrouping,minimumIntegerDigits:e.minimumIntegerDigits,minimumFractionDigits:e.minimumFractionDigits,maximumFractionDigits:e.maximumFractionDigits};return e.minimumSignificantDigits>0&&e.minimumSignificantDigits<22&&(n.minimumSignificantDigits=e.minimumSignificantDigits),e.maximumSignificantDigits>0&&e.maximumSignificantDigits<22&&(n.maximumSignificantDigits=e.maximumSignificantDigits),("percent"===e.formatStyle?a/100:a).toLocaleString("ca-ES",n)},getCsvValueFromEntity(e,t){const a=t[e.name];return null==a||isNaN(a)?"":String(a)}},Pt={detailsCell:Te,formField:Lt,gridField:Ut,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new se([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} >`},{type:"number",name:`${e.name}_lt`,label:`${e.label} <`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"number"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity(e,t){const a=t[e.name];if(null==a||isNaN(a))return"";const n={style:e.formatStyle,currency:"EUR",useGrouping:e.useGrouping,minimumIntegerDigits:e.minimumIntegerDigits,minimumFractionDigits:e.minimumFractionDigits,maximumFractionDigits:e.maximumFractionDigits};return e.minimumSignificantDigits>0&&e.minimumSignificantDigits<22&&(n.minimumSignificantDigits=e.minimumSignificantDigits),e.maximumSignificantDigits>0&&e.maximumSignificantDigits<22&&(n.maximumSignificantDigits=e.maximumSignificantDigits),("percent"===e.formatStyle?a/100:a).toLocaleString("ca-ES",n)},getCsvValueFromEntity(e,t){const a=t[e.name];return null==a||isNaN(a)?"":String(a)}},Vt={__name:"form-field-string",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-text");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,password:e.password??e.field.password,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,maxlength:e.maxlength??e.field.maxlength,pattern:e.pattern??e.field.pattern,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onClick:i[0]||(i[0]=e=>t("click")),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e)),onKeydown:i[3]||(i[3]=e=>t("keydown",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","unresizable","auto-adjust-height","password","required","disabled","maxlength","pattern","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},Ft={__name:"grid-field-string",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=Ae({$emit:t});return(r,s)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Vt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,onChange:s[0]||(s[0]=e=>t("change",e)),onClick:s[1]||(s[1]=e=>t("click",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o),onKeydown:s[2]||(s[2]=e=>t("keydown",e))}),null,16,["borderless","clear-value-on-disabled","onFocus","onBlur"]))}},wt=(0,R.Z)(Ft,[["__scopeId","data-v-2a27fa3a"]]);function Gt(e,t){return t[e.name]??""}function Bt(e,t){return t[e.name]??""}const kt={boolean:P,childCount:Ee,choice:Ce,choiceStyled:Oe,date:Re,dictionary:je,dictionaryCustom:ze,dictionaryMulti:He,fileMulti:ot,hidden:dt,lookup:Et,lookupCache:yt,lookupDetail:_t,lookupMulti:bt,lookupMultiCache:ht,number:Mt,numberStyled:Pt,string:{detailsCell:ce,formField:Vt,gridField:wt,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"contains"===e.operation?`contains(${e.name}, @${e.name})`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface:e=>["eq","contains"].includes(e.operation)?{type:"text",name:e.name,label:e.label}:"in"===e.operation?{type:"csv",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Gt,getCsvValueFromEntity:Gt},stringCustom:{detailsCell:Te,formField:Vt,gridField:wt,getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"contains"===e.operation?`contains(${e.name}, @${e.name})`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface:e=>["eq","contains"].includes(e.operation)?{type:"text",name:e.name,label:e.label}:"in"===e.operation?{type:"csv",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Bt,getCsvValueFromEntity:Bt}},$t={__name:"form-field-collection",props:{fields:{type:Array,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0},withClass:{type:[Boolean,Function],default:null},withAreaName:{type:[Boolean,Function],default:null},cacheName:{type:String,default:""}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.filter((e=>!e.primary&&e.type))));function i(e,t){return!0===a.withClass?`formField-${e.name}`:"function"==typeof a.withClass?a.withClass.call(null,e,t):void 0}function o(e){return!0===a.withAreaName?{gridArea:e.name}:"function"==typeof a.withAreaName?{gridArea:a.withAreaName.call(null,e)}:void 0}return(r,s)=>((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(l),(l=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[l.type].formField),{key:l.name,entity:e.entity,field:l,validations:e.validations,class:(0,n.normalizeClass)(i(l,e.entity)),style:(0,n.normalizeStyle)(o(l,e.entity)),"cache-name":e.cacheName,onChange:e=>async function(e,n){if(t("change",{field:e,action:n}),"function"==typeof e.onChange){const n=await e.onChange(a.entity);"function"==typeof n&&t("change",{field:e,action:n})}}(l,e),onFocus:e=>async function(e,n){if("function"==typeof e.onFocus){const l=await e.onFocus(a.entity,n);"function"==typeof l&&t("change",{field:e,action:l})}}(l,e),onBlur:e=>async function(e,n){if("function"==typeof e.onBlur){const l=await e.onBlur(a.entity,n);"function"==typeof l&&t("change",{field:e,action:l})}}(l,e)},null,40,["entity","field","validations","class","style","cache-name","onChange","onFocus","onBlur"])))),128))}},qt={class:"AANEE_ALUMNE-editItem-general"},jt={__name:"form-alumne",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e;let l=null;const i=T(),o=i.data.role,r="AANEE_ALUMNE",s=En(r);pt().load(r);const d=(0,n.computed)((()=>"EAP"===o?[{value:"NEE-A",text:"NEE-A"},{value:"NEE-A+B",text:"NEE-A+B"}]:[{value:"NEE-A",text:"NEE-A"},{value:"NEE-B",text:"NEE-B"},{value:"NEE-A+B",text:"NEE-A+B"}])),u=async function(){switch(a.entity.TIPUS_ALUMNE){case"NEE-A+B":a.entity.ES_NEEA||t("change",(e=>{e.ES_NEEA="Pendent d'avaluar",e.AVALUACIO_NEEA="Incompleta"})),a.entity.ES_NEEB||t("change",(e=>{e.ES_NEEB="Pendent d'avaluar",e.AVALUACIO_NEEB="Incompleta"}));break;case"NEE-A":t("change",(e=>{e.ES_NEEB=null,e.AVALUACIO_NEEB=null}));break;case"NEE-B":t("change",(e=>{e.ES_NEEA=null,e.AVALUACIO_NEEA_EAP=null}))}return await b(i,a.entity)},c=(0,n.reactive)({error:null}),{errorMessage:m}=a.validations.createValidation("generals",{rules:[async e=>{const t=await xe("AANEE_ALUMNE",{$select:"COGNOMSINOM",$expand:"GEN_EAP($select=NOM)",$filter:`ID ne ${a.entity.ID||0} and IDALU eq '${a.entity.IDALU}'`,$count:!0,$top:1});if(t.value.length>0>0)return`IDALU corrrespon a ${t.value[0].COGNOMSINOM}, ${t.value[0].GEN_EAP?.NOM||""}`}]}),E=(0,n.computed)((()=>pn(s,[{name:"IDALU",onBlur:p},{name:"NOM",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM1",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM2",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"TIPUS_ALUMNE",options:d.value,onChange:u,disabled:!a.entity.ID},"ID_NIVELL",{name:"DATA_NAIXEMENT",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"ID_EAP",disabled:"NEE-B"===a.entity.TIPUS_ALUMNE||["SSOCIALS","SIMULACIONS"].includes(o)||"EAP"===o&&!a.entity.ID},{name:"MARCA_AUTO",type:"string"},{name:"MARCA_MANUAL",disabled:"ESCOLARITZACIO"!==o,onChange:A},"ID_ORIGEN","MARCA_FINAL","CREATED"])));async function p(e){if(e.IDALU){if(e.IDALU&&(!l||e.IDALU!==l)){l=e.IDALU;const n=[{name:"AANEE",promise:xe("AANEE_ALUMNE",{$filter:`ID ne ${a.entity.ID||0} and IDALU eq '${a.entity.IDALU}'`,$select:"COGNOMSINOM,TIPUS_ALUMNE,ID_EAP",$expand:"GEN_EAP($select=NOM)"},{withoutDialog:!0})},{name:"RALC",promise:xe("RALC_HISTORIC_ALUMNE",{$filter:`IDALU eq '${e.IDALU}'`,$select:"NOM, COGNOM1, COGNOM2,DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1,COGNOM1_TUTOR1,COGNOM2_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR1,NOM_TUTOR2,COGNOM1_TUTOR1,COGNOM2_TUTOR2,IDENTIFICACIO_FISCAL_TUTOR2, CODI_CENTRE, ID_CENTRE"},{withoutDialog:!0})},{name:"GEDAC",promise:xe("GEDAC_ALUMNE",{$filter:`IDALU eq '${a.entity.IDALU}'`,$select:"NOM, COGNOM1, COGNOM2,DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1,COGNOM1_TUTOR1,COGNOM2_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR1,NOM_TUTOR2,COGNOM1_TUTOR1,COGNOM2_TUTOR2,IDENTIFICACIO_FISCAL_TUTOR2, ID, NUM_SOLICITUD, TIPUS_ALUMNE"},{withoutDialog:!0})},{name:"RAV",promise:xe("RAV_ALUMNE",{$filter:`IDALU eq '${a.entity.IDALU}' and (ID_ESTAT eq 12 or ID_ESTATVULNERABLE eq 2)`,$select:"ID,ID_ESTAT,ID_ESTATVULNERABLE, ID_ESTATPDX,ID_MOTIUVULNER"},{withoutDialog:!0})}],o=await Promise.all(n.map((e=>e.promise))),r=o[0].value,s=o[1].value,d=o[2].value,u=o[3].value;if(r.length>0)c.error=`IDALU corrrespon a ${r[0].COGNOMSINOM}, ${r[0].GEN_EAP?.NOM||""}`,t("change",(e=>{e.IDALU_RALC=s.length>0,e.IDALU_GEDAC=d.length>0}));else if(0===s.length&&0===d.length)c.error=`IDALU ${e.IDALU} no existeix al RALC ni a les preinscripcions`,t("change",(e=>{e.IDALU_RALC=!1,e.IDALU_GEDAC=!1}));else{c.error=null;const e=d.length>0?d[0]:s[0],n=u.length>0?u[0]:{};t("change",(t=>{t.IDALU_RALC=s.length>0,t.CODI_CENTRE_PROCEDENCIA=s.length>0?s[0].CODI_CENTRE:null,t.ID_CENTRE_PROCEDENCIA=s.length>0?s[0].ID_CENTRE:null,t.NOM=e.NOM,t.COGNOM1=e.COGNOM1,t.COGNOM2=e.COGNOM2,t.DATA_NAIXEMENT=e.DATA_NAIXEMENT?new Date(e.DATA_NAIXEMENT):null,t.IDENTIFICACIO_FISCAL=e.IDENTIFICACIO_FISCAL,t.CP_RESIDENCIA=e.CP_RESIDENCIA,t.NOM_TUTOR1=e.NOM_TUTOR1,t.COGNOM1_TUTOR1=e.COGNOM1_TUTOR1,t.COGNOM2_TUTOR1=e.COGNOM2_TUTOR1,t.IDENTIFICACIO_FISCAL_TUTOR1=e.IDENTIFICACIO_FISCAL_TUTOR1,t.NOM_TUTOR2=e.NOM_TUTOR2,t.COGNOM1_TUTOR2=e.COGNOM1_TUTOR2,t.COGNOM2_TUTOR2=e.COGNOM2_TUTOR2,t.IDENTIFICACIO_FISCAL_TUTOR2=e.IDENTIFICACIO_FISCAL_TUTOR2,t.TIPUS_ALUMNE=n.ID?"NEE-A+B":a.entity.TIPUS_ALUMNE,t.TIPUS_ALUMNE_GEDAC=d.length>0?d[0].TIPUS_ALUMNE:null,t.IDALU_GEDAC=d.length>0,t.ID_GEDAC_INI=d.length>0?d[0].ID:null,t.ID_GEDAC=d.length>0?d[0].ID:null,t.NUM_SOLICITUD_GEDAC=d.length>0?d[0].NUM_SOLICITUD:null,t.ID_RAV=n.ID,t.ID_ESTAT_VULNERABLE=n.ID_ESTATVULNERABLE,t.ID_ESTAT_PLAXOC=n.ID_ESTATPDX,t.ID_ESTAT_RAV=n.ID_ESTAT,t.ID_MOTIU_VULNERABILITAT=n.ID_MOTIUVULNER,t.ID_MOTIU_VULNERABILITAT_RAV=n.ID_MOTIUVULNER,t.ES_NEEB=d.length>0&&"NEE-B"===e.TIPUS_ALUMNE?"Sí":null}));const l=await b(i,a.entity);t("change",l)}}}else l=null,c.error=null,t("change",(e=>{e.IDALU_RALC=!1,e.IDALU_GEDAC=!1}))}async function A(){return await b(i,a.entity)}return(0,n.onMounted)((async()=>{l=a.entity.IDALU;const e="$formFieldCentre",t=pt();t.setData(e,[]);const n=await xe("GEN_CENTRE",{$select:["ID","CODI_CENTRE","NOM_CENTRE","CODI_DISTRICTE","TITULARITAT"],$expand:"GEN_CENTRE_ZONA($select=ID_ETAPA,CODI_ZONA,ID_ZONA)"});t.setData(e,n.value)})),(a,l)=>{const i=(0,n.resolveComponent)("fura-label"),o=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",qt,[(0,n.createVNode)(i,{style:{"grid-area":"LABEL_MARCA","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Marcatge ")])),_:1}),(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(E),entity:e.entity,validations:e.validations,"cache-name":r,onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"]),(0,n.unref)(m)||c.error?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,style:{"grid-area":"errorMessage","margin-top":"6px"},type:"error",singleline:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(m)||c.error),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)])}}},Kt=(0,R.Z)(jt,[["__scopeId","data-v-aaab3aa0"]]),zt={class:"AANEE_ALUMNE-PERSONAL-editItem-personal"},Zt={key:0,style:{"grid-area":"GEDAC"},class:"gedac"},Xt={__name:"form-personal",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=pn(En("AANEE_ALUMNE"),[{name:"IDENTIFICACIO_FISCAL",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},"ADRECA_RESIDENCIA","CP_RESIDENCIA","ID_DISTRICTE_RESIDENCIA",{name:"NOM_TUTOR1",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM1_TUTOR1",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM2_TUTOR1",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"IDENTIFICACIO_FISCAL_TUTOR1",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},"EMAIL_TUTOR1","TELEFON_TUTOR1",{name:"NOM_TUTOR2",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM1_TUTOR2",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"COGNOM2_TUTOR2",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},{name:"IDENTIFICACIO_FISCAL_TUTOR2",disabled:!!a.entity.IDALU_RALC||!!a.entity.IDALU_GEDAC},"EMAIL_TUTOR2","TELEFON_TUTOR2","ID_CENTRE_PROCEDENCIA"]),i=pn(En("GEDAC_ALUMNE"),["IDALU_GEDAC","NOM","COGNOM1","COGNOM2","IDENTIFICACIO_FISCAL","DATA_NAIXEMENT","ADRECA_RESIDENCIA","CP_RESIDENCIA","MUNICIPI_RESIDENCIA","NOM_TUTOR1","COGNOM1_TUTOR1","COGNOM2_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR1","EMAIL","TELEFON","NOM_TUTOR2","COGNOM1_TUTOR2","COGNOM2_TUTOR2","IDENTIFICACIO_FISCAL_TUTOR2","ID_NIVELL","ID_CENTRE_1AOPCIO","TITULARITAT_CENTRE_1AOPCIO","ID_CENTRE_PROCEDENCIA","TITULARITAT_CENTRE_PROCEDENCIA"]),o=(0,n.reactive)({ID:a.entity.ID_GEDAC,COGNOMSINOM:""});return(0,n.onMounted)((async()=>{if(a.entity.ID_GEDAC){const e=await xe(`GEDAC_ALUMNE(${a.entity.ID_GEDAC})`);e.DATA_NAIXEMENT&&(e.DATA_NAIXEMENT=new Date(e.DATA_NAIXEMENT)),i.forEach((function(t){o[t.name]=e[t.name]}))}else if(a.entity.IDALU){const e=await xe("RALC_HISTORIC_ALUMNE",{$filter:`IDALU eq '${a.entity.IDALU}'`}),t=e.value.length>0?e.value[0]:{};t.DATA_NAIXEMENT&&(t.DATA_NAIXEMENT=new Date(t.DATA_NAIXEMENT)),i.forEach((function(e){o[e.name]=t[e.name]}))}})),(a,r)=>{const s=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",zt,[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":"AANEE_ALUMNE",onChange:r[0]||(r[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"]),e.entity.ID_GEDAC||e.entity.IDALU?((0,n.openBlock)(),(0,n.createElementBlock)("div",Zt,[(0,n.createVNode)(s,{style:{"grid-area":"LABEL_GEDAC","margin-top":"32px","font-weight":"800",color:"#ff0000"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.entity.ID_GEDAC?"Dades GEDAC":"Dades RALC"),1)])),_:1}),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(i),(t=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[t.type].formField),{style:(0,n.normalizeStyle)({gridArea:t.name}),class:(0,n.normalizeClass)(o[t.name]&&e.entity[t.name]&&e.entity[t.name]===o[t.name]?"valid":null),key:t.name,entity:o,field:t,disabled:""},null,8,["style","class","entity","field"])))),128))])):(0,n.createCommentVNode)("v-if",!0)])}}},Wt=(0,R.Z)(Xt,[["__scopeId","data-v-1c76b632"]]),Ht=[];function Yt(e){Ht.length>0&&"function"==typeof e&&Ht[Ht.length-1].push(e)}function Jt(){Ht.push([])}function Qt(){Ht.pop()}function ea(...e){if(Ht.length>0){const t=Ht[Ht.length-1];for(const a of t)a(...e)}}function ta(e,t){return t?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase():e.toLowerCase()}function aa(e,t){return t.split("/").reduce(((e,t)=>e[t]),e)}function na(e,t){return{sortedData:(0,n.computed)((()=>{const a=Array.from((0,n.unref)(e)||[]),l=Array.from((0,n.unref)(t)||[]).reverse();for(const e of l)"asc"===e.direction?a.sort(((t,a)=>{const n=ta(aa(t,e.sentence),!0),l=ta(aa(a,e.sentence),!0);return n>l?1:n<l?-1:0})):"desc"===e.direction&&a.sort(((t,a)=>{const n=ta(aa(t,e.sentence),!0),l=ta(aa(a,e.sentence),!0);return n>l?-1:n<l?1:0}));return a}))}}const la={__name:"form-field-centre",props:{labelCodi:{type:String,default:void 0},labelNom:{type:String,default:void 0},classCodi:{type:String,default:void 0},classNom:{type:String,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},validations:{type:Object,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change"],setup(e,{expose:t,emit:a}){const l=e,i="$formFieldCentre",o=pt(),r=(0,n.computed)((()=>o.data[i]||[])),{filteredData:s}=Ge(l,r),d=(0,n.computed)((()=>s.value.map((e=>({value:e.ID,text:e.CODI_CENTRE}))))),u=(0,n.computed)((()=>s.value.map((e=>({value:e.ID,text:e.NOM_CENTRE}))))),{sortedData:c}=na(u,[{sentence:"text",direction:"asc"}]);(0,n.watch)(s,(e=>{e.some((e=>e.ID===l.entity[l.name]))||a("change",(e=>{e[l.name]=null}))}));const m=(0,n.computed)((()=>[l.required&&(e=>!e&&"Aquest camp es requerit."),...l.rules||[]].filter((e=>e)))),{errorMessage:E,validate:p,clear:A,destroy:I}=l.validations?.createField?l.validations.createField(l.name,(0,n.computed)((()=>l.entity[l.name])),{rules:m,skip:(0,n.toRef)(l,"disabled")}):{errorMessage:(0,n.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};function N(e){a("change",(t=>{t[l.name]=e})),"update"===l.autoValidate&&(0,n.nextTick)((()=>p()))}function y(){"blur"===l.autoValidate&&p()}return(0,n.watch)((()=>l.disabled),(e=>{e&&l.clearValueOnDisabled&&a("change",(e=>{e[l.name]=null}))})),(0,n.onMounted)((async()=>{if(!o.data[i]){o.setData(i,[]);const e=await xe("GEN_CENTRE",{$select:["ID","CODI_CENTRE","NOM_CENTRE","CODI_DISTRICTE","TITULARITAT"],$expand:"GEN_CENTRE_ZONA($select=ID_ETAPA,CODI_ZONA,ID_ZONA)"});o.setData(i,e.value)}})),(0,n.onBeforeUnmount)(I),t({validate:p,clear:A}),(t,a)=>{const l=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(l,{style:(0,n.normalizeStyle)({gridArea:`${e.name}Codi`}),class:(0,n.normalizeClass)(e.classCodi),label:e.labelCodi,"allow-freeform":"","auto-complete":"","immediate-scroll":"","accent-insensitive":"",required:e.required,disabled:e.disabled,readonly:e.readonly,"error-message":(0,n.unref)(E),options:(0,n.unref)(d),"model-value":e.entity[e.name],"onUpdate:modelValue":N,onBlur:y},null,8,["style","class","label","required","disabled","readonly","error-message","options","model-value"]),(0,n.createVNode)(l,{style:(0,n.normalizeStyle)({gridArea:`${e.name}Nom`}),class:(0,n.normalizeClass)(e.classNom),label:e.labelNom,"allow-freeform":"","auto-complete":"","immediate-scroll":"","accent-insensitive":"",required:e.required,disabled:e.disabled,readonly:e.readonly,"error-message":(0,n.unref)(E),options:(0,n.unref)(c),"model-value":e.entity[e.name],"onUpdate:modelValue":N,onBlur:y},null,8,["style","class","label","required","disabled","readonly","error-message","options","model-value"])],64)}}},ia={class:"AANEE-ALUMNE-editItem-NEEA"},oa={__name:"form-neea",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change","blur"],setup(e,{emit:t}){const a=e,l=T(),i=l.data.role,r=(0,o.entityDefinition)(a.entity).entityName;pt().load(r);const s=En(r),d=!["EAP","INCLUSIVA","ESCOLARITZACIO"].includes(i),u=(0,n.computed)((()=>!["ESCOLARITZACIO","INCLUSIVA","EAP"].includes(i)||"NEE-B"===a.entity.TIPUS_ALUMNE||"No"===a.entity.ES_NEEA)),c=(0,n.computed)((()=>pn(s,[{name:"PROFESSIONAL_ASSIGNAT_NEEA",disabled:d||"NEE-B"===a.entity.TIPUS_ALUMNE},{name:"NUM_SOLICITUD_EE",disabled:d||"NEE-B"===a.entity.TIPUS_ALUMNE},{name:"ES_NEEA",disabled:d||"NEE-B"===a.entity.TIPUS_ALUMNE,onChange:C,required:!d},{name:"TIPUS_ESCOLARITZACIO",disabled:u.value||"Sí"!==a.entity.ES_NEEA,onChange:C},{name:"SENSE_BARRERES",disabled:u.value||!["Ordinària","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO),onChange:C},{name:"SIEI",disabled:u.value||!["Ordinària","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO),onChange:C},{name:"SIAL",disabled:u.value||!["Ordinària","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO),onChange:C},{name:"ACORD_NEEA",onChange:C,disabled:u.value},{name:"ID_MOTIU_NESE",onChange:C,disabled:u.value},{name:"INSCRIPCIOFINAL_NEEA",disabled:u.value,onChange:C},{name:"CENTRE_CRAE",disabled:u.value},{name:"GERMA_BESSO_ORDINARI",disabled:u.value},{name:"ACOLLIMENT_DGAIA",disabled:u.value},{name:"RETENCIO",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(i)||"NEE-B"===a.entity.TIPUS_ALUMNE||"No"===a.entity.ES_NEEA},{name:"CEEPSIR",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(i)||"NEE-B"===a.entity.TIPUS_ALUMNE||"No"===a.entity.ES_NEEA},{name:"AVALUACIO_NEEA_EAP",type:"string"},{name:"AVALUACIO_NEEA",type:"string"},{name:"DISTANCIA_CENTRE_PROPOSAT1",label:" "},{name:"DISTANCIA_CENTRE_PROPOSAT2",label:" "},{name:"DISTANCIA_CENTRE_PROPOSAT3",label:" "},{name:"DISTANCIA_CENTRE_COMPARTIDA",label:" "},"INSCRIT_ORDINARI_GEDAC","PENDENT_INSCRIPCIO_FINAL_NEEA"]))),m=pn(s,["NUM_SOLICITUD_EE","AVALUACIO_NEEA_EAP","AVALUACIO_NEEA","PROFESSIONAL_ASSIGNAT_NEEA","ES_NEEA","TIPUS_ESCOLARITZACIO","SENSE_BARRERES","SIEI","SIAL","ACORD_NEEA","ID_CENTRE_GERMANS",{name:"ID_CENTRE_PROPOSAT1",label:" "},{name:"ID_CENTRE_PROPOSAT2",label:" "},{name:"ID_CENTRE_PROPOSAT3",label:" "},{name:"ID_CENTRE_COMPARTIDA",label:" "},"INSCRIPCIOFINAL_NEEA","INSCRIT_ORDINARI_GEDAC","CENTRE_CRAE","RETENCIO","CEEPSIR","GERMA_BESSO_ORDINARI","ACOLLIMENT_DGAIA",{name:"DISTANCIA_CENTRE_PROPOSAT1",label:" "},{name:"DISTANCIA_CENTRE_PROPOSAT2",label:" "},{name:"DISTANCIA_CENTRE_PROPOSAT3",label:" "},{name:"DISTANCIA_CENTRE_COMPARTIDA",label:" "}]),E=(0,n.reactive)({AANEE_ALUMNE_MOTIU_NESE:[]});function p(e){return D(a.entity,e)}Yt((async()=>{if(a.entity.ID){const e=await xe("AANEE_ALUMNE_CANVI",{$filter:`ID_AANEE eq ${a.entity.ID}`,$orderby:"ID",$top:1}),t=e.value&&e.value.length>0?e.value[0]:{};c.value.forEach((function(e){E[e.name]=t[e.name]}))}}));const A=(0,n.computed)((()=>a.entity.ID_CENTRE_PROPOSAT1||"Sí"!==a.entity.SENSE_BARRERES&&!["Especial","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO)?null:"avaluacioInvalid")),I=(0,n.computed)((()=>a.entity.ID_CENTRE_PROPOSAT2||"Especial"!==a.entity.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid")),N=(0,n.computed)((()=>a.entity.ID_CENTRE_COMPARTIDA||"Compartida"!==a.entity.TIPUS_ESCOLARITZACIO?null:"avaluacioInvalid")),y=(0,n.computed)((function(){return!["ESCOLARITZACIO","INCLUSIVA","EAP"].includes(i)||"NEE-B"===a.entity.TIPUS_ALUMNE||"No"===a.entity.ES_NEEA||"EAP"===i&&!(["Especial","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO)||"Sí"===a.entity.SENSE_BARRERES)}));async function C(){return await b(l,a.entity)}const f=(0,n.computed)((function(){return a.entity.ID_NIVELL?["Especial","Compartida"].includes(a.entity.TIPUS_ESCOLARITZACIO)||1===a.entity.ID_NIVELL?e=>e.GEN_CENTRE_ZONA.some((e=>5===e.ID_ETAPA)):a.entity.ID_NIVELL<5?e=>e.GEN_CENTRE_ZONA.some((e=>1===e.ID_ETAPA)):a.entity.ID_NIVELL<11?e=>e.GEN_CENTRE_ZONA.some((e=>2===e.ID_ETAPA)):e=>e.GEN_CENTRE_ZONA.some((e=>3===e.ID_ETAPA)):e=>0===e.ID})),_=(0,n.computed)((function(){return a.entity.ID_NIVELL?1===a.entity.ID_NIVELL?e=>e.GEN_CENTRE_ZONA.some((e=>5===e.ID_ETAPA)):a.entity.ID_NIVELL<5?e=>e.GEN_CENTRE_ZONA.some((e=>1===e.ID_ETAPA)):a.entity.ID_NIVELL<11?e=>e.GEN_CENTRE_ZONA.some((e=>2===e.ID_ETAPA)):e=>e.GEN_CENTRE_ZONA.some((e=>3===e.ID_ETAPA)):e=>0===e.ID}));async function g(e,n,i){if(t("change",i),["ID_CENTRE_PROPOSAT1","ID_CENTRE_PROPOSAT2","ID_CENTRE_COMPARTIDA"].includes(e)){const e=await b(l,a.entity);t("change",e)}let o=1;switch(a.entity.ID_NIVELL){case 1:o=5;break;case 2:case 3:case 4:o=1;break;case 5:case 6:case 7:case 8:case 9:case 10:o=2;break;default:o=3}if(a.entity.ID_GEDAC){const l=await xe(`GEDAC_ALUMNE(${a.entity.ID_GEDAC})`,{$select:"ID",$expand:`GEN_CENTRE($select=CODI_CENTRE;$expand=GEN_CENTRE_DISTANCIA($select=DISTANCIA;$filter=ID_ETAPA eq ${o} and ID_CENTRE_DESTI eq ${a.entity[e]}))`});l.GEN_CENTRE.GEN_CENTRE_DISTANCIA.length>0?t("change",(e=>{e[n]=parseInt(l.GEN_CENTRE.GEN_CENTRE_DISTANCIA[0].DISTANCIA)})):t("change",(e=>{e[n]=0}))}else t("change",(e=>{e[n]=null}))}return(l,i)=>{const o=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ia,[(0,n.createVNode)(o,{style:{"grid-area":"LABEL_NEEA_I","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Inicial ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE_G_I","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre germans ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE1_I","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 1r Centre proposat ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE2_I","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 2n Centre proposa ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE3_I","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 3r Centre proposat ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"COMPARTIDA_I","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre Ed. compartida ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"DISTANCIES_I","margin-top":"32px","text-align":"right"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Distàncies ")])),_:1}),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(m),(e=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name+"_I"}),key:e.name,entity:E,field:e,disabled:""},null,8,["style","entity","field"])))),128)),(0,n.createVNode)(o,{style:{"grid-area":"LABEL_NEEA","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Actual ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE_G","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre germans ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE1","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 1r Centre proposat ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE2","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 2n Centre proposat ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"CENTRE3","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" 3r Centre proposat ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"COMPARTIDA","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre Ed. compartida ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"DISTANCIES","margin-top":"32px","text-align":"right"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Distàncies ")])),_:1}),(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"","with-class":p,fields:(0,n.unref)(c),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(r),onChange:i[0]||(i[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",disabled:(0,n.unref)(y),"class-codi":(0,n.unref)(A),"class-nom":(0,n.unref)(A),"clear-value-on-disabled":"",name:"ID_CENTRE_PROPOSAT1",entity:e.entity,filter:(0,n.unref)(f),validations:e.validations,onChange:i[1]||(i[1]=e=>g("ID_CENTRE_PROPOSAT1","DISTANCIA_CENTRE_PROPOSAT1",e))},null,8,["disabled","class-codi","class-nom","entity","filter","validations"]),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",disabled:(0,n.unref)(y),"class-codi":(0,n.unref)(I),"class-nom":(0,n.unref)(I),"clear-value-on-disabled":"",name:"ID_CENTRE_PROPOSAT2",entity:e.entity,filter:(0,n.unref)(f),validations:e.validations,onChange:i[2]||(i[2]=e=>g("ID_CENTRE_PROPOSAT2","DISTANCIA_CENTRE_PROPOSAT2",e))},null,8,["disabled","class-codi","class-nom","entity","filter","validations"]),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",disabled:(0,n.unref)(y),"clear-value-on-disabled":"",name:"ID_CENTRE_PROPOSAT3",entity:e.entity,filter:(0,n.unref)(f),validations:e.validations,onChange:i[3]||(i[3]=e=>g("ID_CENTRE_PROPOSAT3","DISTANCIA_CENTRE_PROPOSAT3",e))},null,8,["disabled","entity","filter","validations"]),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",disabled:(0,n.unref)(y)||"Compartida"!==a.entity.TIPUS_ESCOLARITZACIO,"class-codi":(0,n.unref)(N),"class-nom":(0,n.unref)(N),"clear-value-on-disabled":"",name:"ID_CENTRE_COMPARTIDA",entity:e.entity,filter:(0,n.unref)(_),validations:e.validations,onChange:i[4]||(i[4]=e=>g("ID_CENTRE_COMPARTIDA","DISTANCIA_CENTRE_COMPARTIDA",e))},null,8,["disabled","class-codi","class-nom","entity","filter","validations"]),(0,n.createVNode)((0,n.unref)(la),{"label-codi":"C.Centre","label-nom":"Centre germans",disabled:(0,n.unref)(u),"clear-value-on-disabled":"",name:"ID_CENTRE_GERMANS",entity:e.entity,validations:e.validations,onChange:i[5]||(i[5]=e=>t("change",e))},null,8,["disabled","entity","validations"])])}}},ra=oa,sa={class:"AANEE_ALUMNE-editItem-neeb"},da={__name:"form-neeb",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=T(),i=l.data.role,r=(0,n.computed)((()=>"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i||"No"===a.entity.ES_NEEB)),s=(0,o.entityDefinition)(a.entity).entityName,d=En(s),u=(0,n.computed)((()=>pn(d,[{name:"ES_NEEB",onChange:m,disabled:"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i,clearValueOnDisabled:!0},{name:"PROFESSIONAL_ASSIGNAT_NEEB",disabled:"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i},{name:"INSCRIPCIOFINAL_NEEB",onChange:m,disabled:"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i||"No"===a.entity.ES_NEEB||"Ordinari"!==a.entity.TIPUS_ALUMNE_GEDAC||"NEE-B"===a.entity.TIPUS_ALUMNE_GEDAC||2===a.entity.ID_ESTAT_VULNERABLE},{name:"ENTREVISTAR_NEEB",disabled:r.value},{name:"DATATRUCADA_NEEB",disabled:r.value},{name:"ID_MOTIU_VULNERABILITAT",onChange:m,disabled:"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i||"Sí"!==a.entity.ES_NEEB},{name:"OBS_NEEB",disabled:"NEE-A"===a.entity.TIPUS_ALUMNE||"EAP"===i},"AVALUACIO_NEEB","INSCRIT_ORDINARI_GEDAC","ESTA_RAV","ID_ESTAT_RAV","ID_ESTAT_VULNERABLE","ID_MOTIU_VULNERABILITAT_RAV","ID_ESTAT_PLAXOC","RENDA_MINIMA","RENDA_MINIMA_VALIDAT","ACOLLIMENT_FAMILIAR","ACOLLIMENT_FAMILIAR_VALIDAT","SITUACIO_ACOLLIMENT"])));function c(e){return D(a.entity,e)}async function m(){return await b(l,a.entity)}return(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",sa,[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"","with-class":c,fields:(0,n.unref)(u),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(s),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},ua=(0,R.Z)(da,[["__scopeId","data-v-58128ee3"]]),ca={__name:"form-rav",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},setup(e){const t=e,a=(0,n.ref)([]),l=[{key:"COGNOMSINOM",title:"Cognoms i nom"},{key:"COGNOM1_TUTOR1",title:"1r cognom 1r tutor"},{key:"COGNOM1_TUTOR2",title:"1r cognom 2n tutor"},{key:"ESTAT_RAV",title:"Estat RAV"},{key:"ESTAT_VULNERABLE",title:"Estat vulner."},{key:"MOTIU_VULNERABIITAT",title:"Motiu vulner."},{key:"ESTAT_PLAXOC",title:"Estat pla xoc"}];return(0,n.onMounted)((async()=>{if(t.entity.IDALU&&(t.entity.IDENTIFICACIO_FISCAL_TUTOR1||t.entity.IDENTIFICACIO_FISCAL_TUTOR2)){const e=`('${t.entity.IDENTIFICACIO_FISCAL_TUTOR1||""}','${t.entity.IDENTIFICACIO_FISCAL_TUTOR2}')`,n=await xe("RAV_ALUMNE",{$select:"NOM_TUTOR1,  COGNOM1_TUTOR1, IDENTIFICACIO_FISCAL_TUTOR1, NOM_TUTOR2,  COGNOM1_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR2, COGNOMSINOM, IDALU, ",$filter:`IDALU ne '${t.entity.IDALU}' and (IDENTIFICACIO_FISCAL_TUTOR1 in ${e} or IDENTIFICACIO_FISCAL_TUTOR2 in ${e})`,$expand:"RAV_MOTIU_VULNERABILITAT($select=MOTIU),RAV_ESTAT($select=ESTAT_RAV),RAV_ESTAT_PLAXOC($select=ESTAT_PLAXOC),RAV_ESTAT_VULNERABLE($select=ESTAT_VULNERABLE)",$orderby:"NOM_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR1",$top:64});n.value.forEach((function(e){e.ESTAT_RAV=e.RAV_ESTAT?.ESTAT_RAV,e.ESTAT_VULNERABLE=e.RAV_ESTAT_VULNERABLE?.ESTAT_VULNERABLE,e.MOTIU_VULNERABIITAT=e.RAV_MOTIU_VULNERABILITAT?.MOTIU,e.ESTAT_PLAXOC=e.RAV_ESTAT_PLAXOC?.ESTAT_PLAXOC})),a.value=n.value||[]}})),(e,t)=>{const i=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)(i,{compact:"",columns:l,data:a.value,"auto-layout":"auto"},null,8,["data"])}}},ma=ca,Ea={class:"AANEE_ALUMNE-editItem-gedac"},pa={__name:"form-gedac",props:{entity:{type:Object,required:!0}},setup(e){const t=e,a=pn(En("GEDAC_ALUMNE"),["NUM_SOLICITUD","TIPUS_ALUMNE","ID_NIVELL","ID_CENTRE_PROCEDENCIA","ID_CENTRE_1AOPCIO"]),l=(0,n.reactive)({}),i=(0,n.reactive)({});return(0,n.onMounted)((async()=>{if(t.entity.ID_GEDAC_INI){const e=await xe(`GEDAC_ALUMNE(${t.entity.ID_GEDAC_INI})`);a.forEach((function(t){i[t.name]=e[t.name]}))}if(t.entity.ID_GEDAC){const e=await xe(`GEDAC_ALUMNE(${t.entity.ID_GEDAC})`);a.forEach((function(t){l[t.name]=e[t.name]}))}})),(e,t)=>{const o=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ea,[(0,n.createVNode)(o,{style:{"grid-area":"LABEL_GEDAC_I","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Inicial ")])),_:1}),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(a),(e=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name+"_I"}),key:e.name,entity:i,field:e,disabled:""},null,8,["style","entity","field"])))),128)),(0,n.createVNode)(o,{style:{"grid-area":"LABEL_GEDAC","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Actual ")])),_:1}),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(a),(e=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name}),key:e.name,entity:l,field:e,disabled:""},null,8,["style","entity","field"])))),128))])}}},Aa=(0,R.Z)(pa,[["__scopeId","data-v-214d0099"]]),Ia={class:"AANEE_ALUMNE-editItem-assignacio"},Na={__name:"form-assignacio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=T().data.role,i=pn(En("AANEE_ALUMNE"),["ASSIGNACIO_MANUAL_GEDAC",{name:"DISTANCIA_CENTRE_ASSIGNAT_CEB",label:" "}]),o=pn(En("AANEE_ALUMNE_ASSIGNACIO"),["GRUP_ASSIGNACIO","ORDRE_ASSIGNACIO","ASSIGNACIO_OFICI","TIPUS_ASSIGNACIO","OPCIO_ASSIGNACIO","LLISTA_ESPERA",{name:"DISTANCIA_CENTRE_ASSIGNAT",label:" "}]),r=(0,n.reactive)({});(0,n.onMounted)((async()=>{if(a.entity.ID){const e=await xe("AANEE_ALUMNE_ASSIGNACIO",{$filter:`ID_AANEE eq ${a.entity.ID}`});e.value.length>0&&(o.forEach((function(t){r[t.name]=e.value[0][t.name]})),r.ID_CENTRE_ASSIGNAT=e.value[0].ID_CENTRE_ASSIGNAT,r.ID_CENTRE_1AOPCIO=e.value[0].ID_CENTRE_1AOPCIO)}}));const s=(0,n.computed)((function(){return a.entity.ID_NIVELL?1===a.entity.ID_NIVELL?e=>e.GEN_CENTRE_ZONA.some((e=>5===e.ID_ETAPA)):a.entity.ID_NIVELL<5?e=>e.GEN_CENTRE_ZONA.some((e=>1===e.ID_ETAPA)):a.entity.ID_NIVELL<11?e=>e.GEN_CENTRE_ZONA.some((e=>2===e.ID_ETAPA)):e=>e.GEN_CENTRE_ZONA.some((e=>3===e.ID_ETAPA)):e=>e.GEN_CENTRE_ZONA.some((e=>99===e.ID_ETAPA))}));return(d,u)=>{const c=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ia,[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(i),entity:e.entity,validations:e.validations,"cache-name":"AANEE_ALUMNE",onChange:u[0]||(u[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(o),(e=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name}),key:e.name,entity:r,field:e,disabled:""},null,8,["style","entity","field"])))),128)),(0,n.createVNode)(c,{style:{"grid-area":"DISTANCIES"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Distàncies ")])),_:1}),(0,n.createVNode)(c,{style:{"grid-area":"LABEL_ASSIGNACIO_CEB","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Assignació manual CEB ")])),_:1}),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",disabled:"ESCOLARITZACIO"!==(0,n.unref)(l),name:"ID_CENTRE_ASSIGNAT_CEB",entity:e.entity,filter:(0,n.unref)(s),validations:e.validations,onChange:u[1]||(u[1]=e=>async function(e){if(t("change",e),a.entity.ID_GEDAC){let e=1;switch(a.entity.ID_NIVELL){case 1:e=5;break;case 2:case 3:case 4:e=1;break;case 5:case 6:case 7:case 8:case 9:case 10:e=2;break;default:e=3}const n=await xe(`GEDAC_ALUMNE(${a.entity.ID_GEDAC})`,{$select:"ID",$expand:`GEN_CENTRE($select=CODI_CENTRE;$expand=GEN_CENTRE_DISTANCIA($select=DISTANCIA;$filter=ID_ETAPA eq ${e} and ID_CENTRE_DESTI eq ${a.entity.ID_CENTRE_ASSIGNAT_CEB}))`});n.GEN_CENTRE.GEN_CENTRE_DISTANCIA.length>0?t("change",(e=>{e.DISTANCIA_CENTRE_ASSIGNAT_CEB=parseInt(n.GEN_CENTRE.GEN_CENTRE_DISTANCIA[0].DISTANCIA)})):t("change",(e=>{e.DISTANCIA_CENTRE_ASSIGNAT_CEB=null}))}}(e))},null,8,["disabled","entity","filter","validations"]),(0,n.createVNode)(c,{style:{"grid-area":"LABEL_1AOPCIO","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre 1a opció ")])),_:1}),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",name:"ID_CENTRE_1AOPCIO",entity:r,filter:(0,n.unref)(s),disabled:""},null,8,["entity","filter"]),(0,n.createVNode)(c,{style:{"grid-area":"LABEL_ASSIGNACIO","margin-top":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Centre assignat ")])),_:1}),(0,n.createVNode)((0,n.unref)(la),{"label-codi":" ","label-nom":" ",name:"ID_CENTRE_ASSIGNAT",filter:(0,n.unref)(s),disabled:"",entity:r},null,8,["filter","entity"])])}}},ya=(0,R.Z)(Na,[["__scopeId","data-v-6b794062"]]),Ca={class:"AANEE_ALUMNE-editItem-layout-observacions"},fa={__name:"form-observacions",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=T().data.role,i=(0,o.entityDefinition)(a.entity).entityName;pt().load(i);const r=pn(En(i),[{name:"OBS_INCLUSIVA",disabled:"INCLUSIVA"!==l},{name:"OBS_ESCOLARITZACIO",disabled:"ESCOLARITZACIO"!==l}]);return(a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Ca,[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(r),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"])]))}},_a=(0,R.Z)(fa,[["__scopeId","data-v-74083f44"]]),Ta={entityName:"AANEE_ALUMNE",component:(0,n.markRaw)(Kt),maxWidth:"1080px",tabs:[{name:"PERSONAL",title:"Dades personals",icon:"Contact",component:(0,n.markRaw)(Wt)},{name:"NEEA",title:"NEE-A",icon:"Database",component:(0,n.markRaw)(ra)},{name:"NEEB",icon:"Database",title:"NEE-B",component:(0,n.markRaw)(ua)},{name:"RAV",icon:"Database",title:"Germans al RAV",component:(0,n.markRaw)(ma)},{name:"OBS",title:"Observacions",icon:"EditNote",component:(0,n.markRaw)(_a)},{name:"GEDAC",title:"Dades preinscripció",component:(0,n.markRaw)(Aa)},{name:"ASSIG",title:"Dades assignació",component:(0,n.markRaw)(ya)}]},ga={name:"AANEE_ALUMNE",type:"listSplitted",label:"Alumnes",pageSize:parseInt(localStorage.getItem("alumnePageRows")||"4"),fields:O,filter:S,form:Ta,menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),l=T().data.role,i=t?[{value:"logs",text:"Registre de canvis",icon:"Search",disabled:t["AANEE_ALUMNE_CANVI@odata.count"]<2,action:()=>a.push({path:"/modificacions",query:{id:t.ID,return:n.fullPath}})},{value:"idalu",text:t.IDALU?"Verificar IDALU":"Cercar IDALU alumne seleccionat",icon:"FollowUser",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE",title:"Cercar o validar IDALU",filter:`ID eq ${t.ID}`,return:n.fullPath}})},{value:"lligam",text:"Verificar lligam amb GEDAC",icon:"Search",disabled:"ESCOLARITZACIO"!==l,action:()=>a.push({path:"/lligamGedac",query:{listname:"AANEE_ALUMNE",filter:`ID eq ${t.ID}`,return:n.fullPath}})},{value:"duplicatsonly",text:"Verificar duplicats",icon:"DuplicateRow",action:()=>a.push({path:"/findduplicats",query:{return:n.fullPath}})}]:[{value:"idalu",text:"Cercar o verificar IDALU",icon:"FollowUser",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(l),children:[{value:"tots",text:"Cercar tots els alumnes sense IDALU",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE",filter:"IDALU eq null",title:"Alumnes sense IDALU validat",return:n.fullPath}})},{value:"tots",text:"Cercar tots els alumnes sense IDALU validat",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE",filter:"(IDALU eq null or ESTATIDALU lt 2)",title:"Alumnes sense IDALU validat",return:n.fullPath}})},{value:"tots",text:"Cercar els alumnes seleccionats sense IDALU validat",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE",filter:"(IDALU eq null or ESTATIDALU lt 2)"+(n.query.filter?" and "+n.query.filter:""),title:"Seleccionats sense IDALU validat",return:n.fullPath}})},{value:"nocercats",text:"Cercar els alumnes seleccionats no cercats",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE",title:"Seleccionats no cercats abans",filter:"(IDALU eq null or ESTATIDALU lt 2) eq null and IDALU_NOCERCAR ne true "+(n.query.filter?" and "+n.query.filter:""),return:n.fullPath}})}]},{value:"duplicats",text:"Cercar possibles duplicats",icon:"DuplicateRow",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(l),action:()=>a.push({path:"/findduplicats",query:{return:n.fullPath}})},{value:"lligam",text:"Cercar lligam amb GEDAC",icon:"Search",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(l),children:[{value:"tots",text:"Tots els lligams no trobats",icon:"Search",action:()=>a.push({path:"/lligamGedac",query:{listname:"AANEE_ALUMNE",filter:"ID_GEDAC eq null",return:n.fullPath}})},{value:"nocercats",text:"Verificar els lligams fet",icon:"Search",action:()=>a.push({path:"/lligamGedac",query:{listname:"AANEE_ALUMNE",onlyNews:!0,filter:"ID_GEDAC ne null",return:n.fullPath}})},{value:"selntrobats",text:"Verficar els lligams seleccionats",icon:"Search",action:()=>a.push({path:"/lligamGedac",query:{listname:"AANEE_ALUMNE",filter:"ID_GEDAC ne null"+(n.query.filter?" and "+n.query.filter:""),return:n.fullPath}})},{value:"sel",text:"Cercar alumnes seleccionats no cercats",icon:"Search",action:()=>a.push({path:"/lligamGedac",query:{listname:"AANEE_ALUMNE",filter:"GEDAC_NOCERCAR ne true and ID_GEDAC eq null"+(n.query.filter?" and "+n.query.filter:""),return:n.fullPath}})}]},{value:"lligamRAV",text:"Lligam amb RAV",icon:"Search",disabled:!["INCLUSIVA","ESCOLARITZACIO"].includes(l),children:[{value:"lligam",text:"Cercar alumnes no lligats amb el RAV",action:()=>a.push({path:"/lligamRav",query:{title:"Cercar lligams amb el RAV",listName:"AANEE_ALUMNE",return:n.fullPath}})},{value:"lligam",text:"Cercar alumnes seleccionats no lligats amb el RAV",action:()=>a.push({path:"/lligamRav",query:{title:"Cercar lligams amb el RAV",listName:"AANEE_ALUMNE",filter:n.query.filter,return:n.fullPath}})}]},{value:"assignacio",text:"Càlcul assignació",icon:"Print",disabled:"ESCOLARITZACIO"!==l,action:()=>a.push({path:"/calcul-assignacio",query:{return:n.fullPath}})}];return e.concat(i)},detailsFilter:function(){const e=T();return e.data.idEap?`ID_EAP eq ${e.data.idEap}`:"ID gt 0"}},Oa={component:"auto",class:"AANEE_ALUMNE_GRID-editItem-layout",maxWidth:"900px",withClass:function(e,t){return D(t,e)},fields(e){const t=T(),a=t.data.role,n=!["EAP","INCLUSIVA","ESCOLARITZACIO"].includes(a)||"NEE-B"===e.TIPUS_ALUMNE,l=!["SSOCIALS","INCLUSIVA","ESCOLARITZACIO"].includes(a)||"NEE-A"===e.TIPUS_ALUMNE;async function i(){return await b(t,e)}function o(t){return e.ID_NIVELL?["Especial","Compartida"].includes(e.TIPUS_ESCOLARITZACIO)||1===e.ID_NIVELL?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 5)":e.ID_NIVELL<5?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 1)":e.ID_NIVELL<11?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 2)":"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 3)":"ID eq 0"}return[{name:"IDALU",disabled:!0},{name:"COGNOMSINOM",disabled:!0},{name:"NOM",disabled:!0},{name:"ID_NIVELL",disabled:!0},{name:"TIPUS_ALUMNE",disabled:!0},"ESTATIDALU","LLIGAM_IDALU","IDALU_RALC","IDALU_GEDAC","MANCA_EAP","ESTATIDALU","NUM_SOLICITUD_GEDAC","REFERENCIA","INSCRIT_ORDINARI_GEDAC","AMB_PREINSCRIPCIO","NUM_SOLICITUD_EE","TIPUS_ALUMNE_GEDAC","ID_ORIGEN","ID_MOTIU_VULNERABIITAT","AVALUACIO_NEEA_EAP","AVALUACIO_NEEA","AVALUACIO_NEEB","MARCA_AUTO","GERMANS_ESTUDIEN_BCN",{name:"MARCA_FINAL",type:"string",maxlength:48},{name:"ESTATPREINSCRIPCIO",type:"string"},{name:"ID_EAP",disabled:n},{name:"ID_CENTRE_ASSIGNAT_CEB",type:"lookup",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},disabled:"ESCOLARITZACIO"!==a},{name:"NUM_SOLICITUD_EE",disabled:n},{name:"RETENCIO",disabled:n,clearValueOnDisabled:!0},{name:"CEEPSIR",disabled:n,clearValueOnDisabled:!0},{name:"CENTRE_CRAE",disabled:n,clearValueOnDisabled:!0},{name:"GERMA_BESSO_ORDINARI",disabled:n,clearValueOnDisabled:!0},{name:"ACOLLIMENT_DGAIA",disabled:n,clearValueOnDisabled:!0},{name:"ES_NEEA",disabled:n,onChange:i,clearValueOnDisabled:!0,required:!n},{name:"TIPUS_ESCOLARITZACIO",disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,onChange:i},{name:"SENSE_BARRERES",disabled:n||!["Ordinària","Compartida"].includes(e.TIPUS_ESCOLARITZACIO),clearValueOnDisabled:!0,onChange:i},{name:"SIEI",disabled:n||!["Ordinària","Compartida"].includes(e.TIPUS_ESCOLARITZACIO),clearValueOnDisabled:!0,onChange:i},{name:"SIAL",disabled:n||!["Ordinària","Compartida"].includes(e.TIPUS_ESCOLARITZACIO),onChange:i,clearValueOnDisabled:!0},{name:"ACORD_NEEA",disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,onChange:i},{name:"ID_MOTIU_NESE",disabled:n||"Sí"!==e.ES_NEEA,onChange:i},{name:"PROFESSIONAL_ASSIGNAT_NEEA",clearValueOnDisabled:!0,disabled:n||"Sí"!==e.ES_NEEA},{name:"ID_CENTRE_PROPOSAT1",type:"lookup",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,filter:o(),onChange:i},{name:"ID_CENTRE_PROPOSAT2",type:"lookup",disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,filter:o(),entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},onChange:i},{name:"ID_CENTRE_PROPOSAT3",type:"lookup",disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,filter:o(),entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},onChange:i},{name:"ID_CENTRE_COMPARTIDA",type:"lookup",disabled:n||"Sí"!==e.ES_NEEA||"Compartida"!==e.TIPUS_ESCOLARITZACIO,clearValueOnDisabled:!0,filter:e.ID_NIVELL?1===e.ID_NIVELL?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 5)":e.ID_NIVELL<5?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 1)":e.ID_NIVELL<11?"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 2)":"GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq 3)":"ID eq 0",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"},onChange:i},{name:"INSCRIPCIOFINAL_NEEA",disabled:n||"Sí"!==e.ES_NEEA,clearValueOnDisabled:!0,onChange:i},{name:"MARCA_MANUAL",disabled:"ESCOLARITZACIO"!==a,onChange:i},{name:"MARCA_FINAL",disabled:!0},{name:"ES_NEEB",onChange:i,disabled:l},{name:"PROFESSIONAL_ASSIGNAT_NEEB",disabled:l},{name:"OBS_INCLUSIVA",disabled:"INCLUSIVA"!==a},{name:"OBS_NEEB",disabled:l},{name:"OBS_ESCOLARITZACIO",disabled:"ESCOLARITZACIO"!==a},{name:"INSCRIPCIOFINAL_NEEB",onChange:i,disabled:l||"Sí"!==e.ES_NEEB||"Ordinari"!==e.TIPUS_ALUMNE_GEDAC||2===e.ID_ESTAT_VULNERABLE},{name:"ENTREVISTAR_NEEB",disabled:l||"No"===e.ES_NEEB},{name:"DATATRUCADA_NEEB",disabled:l||"No"===e.ES_NEEB},{name:"ID_MOTIU_VULNERABILITAT",onChange:i,disabled:l||"No"===e.ES_NEEB||e.RENDA_MINIMA_VALIDAT||e.ACOLLIMENT_FAMILIAR_VALIDAT||e.SITUACIO_ACOLLIMENT},"AVALUACIO_NEEB","ESTA_RAV","ID_ESTAT_RAV","DATA_RESOLUCIO_ALTA","DATA_RESOLUCIO_BAIXA","ID_MOTIU_BAIXAVULNER","ID_ESTAT_VULNERABLE","ID_MOTIU_VULNERABILITAT_RAV","ID_ESTAT_PLAXOC","RENDA_MINIMA","RENDA_MINIMA_VALIDAT","ACOLLIMENT_FAMILIAR","ACOLLIMENT_FAMILIAR_VALIDAT","SITUACIO_ACOLLIMENT","NUM_GERMANS_VULNERABLES","NUM_GERMANS_NOVULNERABLES"]},rules:[]},Sa={name:"AANEE_ALUMNE_GRID",type:"listSplitted",label:"Edició ràpida d'Alumnes",pageSize:parseInt(localStorage.getItem("alumneEditPageRows")||"120"),fields:O,filter:S,form:Oa,menuUpdater:function(e,t){return t&&e.shift(),e},permissionDenied:e=>({create:!0,edit:!1,delete:!0,export:!0}),detailsFilter:function(){const e=T();return e.data.idEap?`ID_EAP eq ${e.data.idEap}`:"ID gt 0"}},ba={name:"AANEE_ALUMNE_ASSIGNACIO",type:"listJoined",label:"Assignació de places",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_AANEE",label:"Alumne AANEE",type:"lookup",dataType:"number",disabled:!0,entity:{name:"AANEE_ALUMNE",primaryKey:"ID",targetKey:"IDALU"}},{name:"ID_CENTRE_1AOPCIO",label:"Centre assignat",type:"dictionary",entityName:"GEN_CENTRE",disabled:!0},{name:"ID_CENTRE_ASSIGNAT",label:"Centre assignat",type:"dictionary",entityName:"GEN_CENTRE",navigationKey:"GEN_CENTRE1",disabled:!0},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL",disabled:!0},{name:"TIPUS_ALUMNE_CALCUL",label:"Tipus alumne càlcul",type:"choice",dataType:"string",options:g.tipusAlumneGEDAC,disabled:!0,maxlength:12},{name:"TIPUS_ASSIGNACIO",label:"Tipus assignació",type:"string",disabled:!0,maxlength:32},{name:"OPCIO_ASSIGNACIO",label:"Opció assignació",type:"number",disabled:!0},{name:"GRUP_ASSIGNACIO",label:"Grup assignació",type:"string",disabled:!0,maxlength:32},{name:"ORDRE_ASSIGNACIO",label:"Ordre",disabled:!0,type:"number"},{name:"ASSIGNACIO_OFICI",label:"Assignació d'ofici",disabled:!0,type:"boolean"},{name:"LLISTA_ESPERA",label:"Llista d'espera",disabled:!0,type:"boolean"},{name:"DISTANCIA_CENTRE_ASSIGNAT",label:"Distància",type:"number",decimals:0,disabled:!0,align:"right",suffix:"min.",maxlength:12}],permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},Da=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CREATED",label:"D.modificació",type:"date"},{name:"IDALU_SEARCH",label:"IDALU actual",type:"string",maxlength:15},{name:"NOM_SEARCH",label:"Nom actual",type:"string",required:!0,maxlength:80},{name:"COGNOM1_SEARCH",label:"1r cognom actual",type:"string",required:!0,maxlength:80},{name:"IDENTIFICACIO_FISCAL_SEARCH",label:"Id. fiscal actual",type:"string",maxlength:32},{name:"ID_EAP_SEARCH",label:"EAP actual",type:"dictionary",dataType:"number",entityName:"GEN_EAP",navigationKey:"GEN_EAP1"},{name:"PROFESSIONAL_ASSIGNAT_NEEA_SEARCH",label:"Professional assignat NEE-A actual",type:"text",dataType:"string",maxlength:80},{name:"PROFESSIONAL_ASSIGNAT_NEEB_SEARCH",label:"Professional assignat NEE-B actual",type:"text",dataType:"string",maxlength:80},{name:"ID_NIVELL_SEARCH",label:"Nivell actual",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL",navigationKey:"GEN_NIVELL1"},{name:"IDALU",label:"IDALU",type:"string",maxlength:15},{name:"NUM_SOLICITUD_GEDAC",label:"N.Sol. GEDAC",type:"string",disabled:!0,maxlength:48},{name:"NUM_SOLICITUD_EE",label:"N.Sol. Ed.Especial",type:"string",maxlength:48},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL"},{name:"TIPUS_ALUMNE",label:"Tipus alumne",type:"choice",dataType:"string",options:g.tipusAlumne,required:!0,maxlength:12},{name:"NOM",label:"Nom",type:"string",required:!0,maxlength:80},{name:"COGNOM1",label:"1r cognom",type:"string",required:!0,maxlength:80},{name:"COGNOM2",label:"2n cognom",type:"string",required:!0,maxlength:80},{name:"DATA_NAIXEMENT",label:"D. Naixement",type:"date"},{name:"IDENTIFICACIO_FISCAL",label:"Id. fiscal",type:"string",maxlength:32},{name:"ID_EAP",label:"EAP",type:"dictionary",dataType:"number",entityName:"GEN_EAP"},{name:"PROFESSIONAL_ASSIGNAT_NEEA",label:"Professional assignat NEE-A",type:"text",dataType:"string",maxlength:80},{name:"SENSE_BARRERES",label:"Sense barreres",type:"string",options:g.siNo,maxlength:2},{name:"SIEI",label:"SIEI",type:"string",options:g.siNo,maxlength:2},{name:"SIAL",label:"SIAL",type:"string",options:g.siNo,maxlength:2},{name:"RETENCIO",label:"Retenció",type:"boolean",detailsColumn:{align:"center"}},{name:"CEEPSIR",label:"CEEPSIR",type:"boolean",detailsColumn:{align:"center"}},{name:"CENTRE_CRAE",label:"Centre CRAE",type:"boolean",detailsColumn:{align:"center"}},{name:"ACOLLIMENT_DGAIA",label:"Acolliment DGAIA",type:"boolean",detailsColumn:{align:"center"}},{name:"ES_NEEA",label:"És NEE-A",type:"choice",dataType:"string",options:g.esNEE,maxlength:24},{name:"AVALUACIO_NEEA_EAP",label:"Avaluació EAP",type:"string",disabled:!0,maxlength:24},{name:"AVALUACIO_NEEA",label:"Avaluació NEE-A",type:"string",disabled:!0,maxlength:24},{name:"ACORD_NEEA",label:"Conformitat família.",type:"choice",options:g.acords,dataType:"string",maxlength:24},{name:"TIPUS_ESCOLARITZACIO",label:"Tipus escolarització",type:"choice",options:g.tipusEscolaritzacio,dataType:"string",maxlength:12},{name:"ID_CENTRE_PROPOSAT1",label:"1r centre proposat",type:"lookup",entity:{name:"GEN_CENTRE",navigationKey:"GEN_CENTRE1",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"ID_CENTRE_COMPARTIDA",label:"Centre compartida",type:"lookup",entity:{name:"GEN_CENTRE",navigationKey:"GEN_CENTRE2",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"INSCRIPCIOFINAL_NEEA",label:"Preinscripció final",type:"choice",options:g.inscripcioFinalNEEA,dataType:"string",disabled:!0,maxlength:36},{name:"MARCA_MANUAL",label:"Orientació automàtica marcatge",type:"choice",options:g.marcaManual,maxlength:48},{name:"ID_CENTRE_ASSIGNAT_CEB",label:"Centre assignat manualment",type:"lookup",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"ES_NEEB",label:"És NEE-B",type:"choice",dataType:"string",options:g.esNEE,maxlength:24},{name:"PROFESSIONAL_ASSIGNAT_NEEB",label:"Professional assignat NEE-B",type:"text",dataType:"string",maxlength:80},{name:"INSCRIPCIOFINAL_NEEB",label:"Preinscripció final (si NEE-B preinscrit ordinari)",type:"choice",dataType:"string",options:g.preinscripcioFinalNEEB,required:!0,maxlength:36},{name:"ID_MOTIU_VULNERABILITAT",label:"Motiu Vulnerabilitat",type:"dictionary",entityName:"RAV_MOTIU_VULNERABILITAT",navigationKey:"RAV_MOTIU_VULNERABILITAT"},{name:"AVALUACIO_NEEB",label:"Avaluació NEE-B",type:"choiceStyled",options:g.avaluacioNEE,disabled:!0,setStyle:e=>"Completa"===e.AVALUACIO_NEEB?{color:"green"}:{color:"red",fontStyle:"bold"},maxlength:24},{name:"CREATEDBY",label:"Mod. per",type:"string"}],va={name:"AANEE_ALUMNE_CANVI",type:"listSplitted",label:"Canvis dades d'alumnes",fields:Da,filter:[{name:"IDALU_SEARCH",operation:"in"},{name:"NOM_SEARCH",label:"Nom actual de l'alumne conté",operation:"contains"},{name:"COGNOM1_SEARCH",label:"1r cognom actual de l'alumne conté",operation:"contains"},{name:"IDENTIFICACIO_FISCAL_SEARCH",label:"Id. fiscal actual de l'alumne conté",operation:"contains"},{name:"ID_EAP_SEARCHL",operation:"in"},{name:"ID_NIVELL_SERACH",operation:"in"},{name:"PROFESSIONAL_ASSIGNAT_NEEA_SEARCH",label:"Professional assignat NEE-A actual conté",operation:"contains"},{name:"PROFESSIONAL_ASSIGNAT_NEEB_SEARCH",label:"Professional assignat NEE-B actual conté",operation:"contains"}],permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},Ra={name:"AANEE_ALUMNE_IMPORTAT",type:"listJoined",label:"Alumnes pendents traspas a AANEE",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"IDALU",label:"IDALU",type:"string",maxlength:15},{name:"NUM_SOLICITUD_EE",label:"N.Sol. Ed.Especial",type:"string",maxlength:48},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL"},{name:"ID_ORIGEN",label:"Font de les dades",type:"dictionary",dataType:"number",defaultValue:1,disabled:!0,entityName:"AANEE_ORIGEN_INFORMACIO"},{name:"REFERENCIA",label:"Referència",type:"string",maxlength:40},{name:"ID_EAP",label:"EAP",type:"dictionary",dataType:"number",entityName:"GEN_EAP"},{name:"NOM",label:"Nom alumne",type:"string",required:!0,maxlength:80},{name:"COGNOM1",label:"1r cognom alumne",type:"string",required:!0,maxlength:80},{name:"COGNOM2",label:"2n cognom alumne",type:"string",required:!0,maxlength:80},{name:"DATA_NAIXEMENT",label:"D. Naixement",type:"date"},{name:"IDENTIFICACIO_FISCAL",label:"Id. fiscal alumne",type:"string",maxlength:32},{name:"ADRECA_RESIDENCIA",label:"Adreça",type:"string",maxlength:255},{name:"CP_RESIDENCIA",label:"C.P.",type:"string",maxlength:5},{name:"ID_DISTRICTE_RESIDENCIA",label:"Districte",type:"dictionary",dataType:"number",entityName:"GEN_DISTRICTE"},{name:"NOM_TUTOR1",label:"Nom 1r tutor",type:"string",maxlength:80},{name:"COGNOM1_TUTOR1",label:"1r cognom 1r tutor",type:"string",maxlength:80},{name:"COGNOM2_TUTOR1",label:"2n cognom 1r tutor",type:"string",maxlength:80},{name:"IDENTIFICACIO_FISCAL_TUTOR1",label:"Id. fiscal 1r tutor",type:"string",maxlength:32},{name:"TELEFON_TUTOR1",label:"Tel. 1r tutor",type:"string",maxlength:9,pattern:/^\d{9}$/},{name:"EMAIL_TUTOR1",label:"eMail 1r tutor",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,maxlength:255},{name:"NOM_TUTOR2",label:"Nom 2nr tutor",type:"string",maxlength:80},{name:"COGNOM1_TUTOR2",label:"1r cognom 2n tutor",type:"string",maxlength:80},{name:"COGNOM2_TUTOR2",label:"2n cognom 2n tutor",type:"string",maxlength:80},{name:"IDENTIFICACIO_FISCAL_TUTOR2",label:"Id. fiscal 2n tutor",type:"string",maxlength:32},{name:"TELEFON_TUTOR2",label:"Tel. 2n tutor",type:"string",maxlength:9,pattern:/^\d{9}$/},{name:"EMAIL_TUTOR2",label:"eMail 2n tutor",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,maxlength:255},{name:"ID_CENTRE_PROPOSAT1",label:"1r centre proposat",type:"dictionary",entityName:"GEN_CENTRE"},{name:"ID_CENTRE_PROPOSAT2",type:"dictionary",entityName:"GEN_CENTRE"},{name:"ID_CENTRE_PROPOSAT3",label:"3r centre proposat",type:"dictionary",entityName:"GEN_CENTRE"},{name:"ID_CENTRE_COMPARTIDA",label:"Centre compartida",type:"dictionary",entityName:"GEN_CENTRE"},{name:"ID_MOTIU_NESE1",label:"Motiu NESE",type:"dictionary",dataType:"number",entit:{Name:"GEN_MOTIU_NESE",primaryKey:"ID",targetKey:"MOTIU_NESE"}},{name:"ID_MOTIU_NESE2",label:"Motiu NESE",type:"dictionary",dataType:"number",entit:{Name:"GEN_MOTIU_NESE",primaryKey:"ID",targetKey:"MOTIU_NESE"}},{name:"ID_MOTIU_NESE3",label:"Motiu NESE",type:"dictionary",dataType:"number",entit:{Name:"GEN_MOTIU_NESE",primaryKey:"ID",targetKey:"MOTIU_NESE"}},{name:"ES_NEEA",label:"És NEE-A",type:"choice",dataType:"string",options:g.esNEE,maxlength:24},{name:"ACORD_NEEA",label:"Conformitat família",type:"choice",options:g.acordsNEEA,dataType:"string",maxlength:24},{name:"TIPUS_ESCOLARITZACIO",label:"Tipus escolarització",type:"choice",options:g.tipusEscolaritzacio,dataType:"string",maxlength:12},{name:"SENSE_BARRERES",label:"Sense barreres",type:"choice",options:g.siNo,maxlength:2},{name:"SIEI",label:"SIEI",type:"choice",options:g.siNo,maxlength:2},{name:"SIAL",label:"SIAL",type:"choice",options:g.siNo,maxlength:2},{name:"CENTRE_CRAE",label:"Centre CRAE",type:"boolean"},{name:"ACOLLIMENT_DGAIA",label:"Acolliment DGAIA",type:"boolean"},{name:"PROFESSIONAL_ASSIGNAT_NEEA",label:"Professional assignat NEE-A",type:"string",maxlength:80},{name:"GERMANS_ESTUDIEN_BCN",label:"Germans estudien BCN",type:"boolean"},{name:"ID_CENTRE_GERMANS",label:"Centre germans",type:"lookdictionary",entityName:"GEN_CENTRE"},{name:"GERMA_BESSO_ORDINARI",label:"Germà bessó ordinari",type:"boolean"},{name:"INSCRIPCIOFINAL_NEEA",label:"Preinscripció final",type:"choice",options:g.inscripcioFinalNEEA,dataType:"string",maxlength:36}],filter:[{name:"IDALU",operation:"eq"},{name:"COGNOMSINOM",label:"Cognoms i/o nom conté",operation:"contains"},{name:"ID_NIVELL",operation:"eq"}],menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),l=t?[{value:"idalu",text:"Cercar IDALUs",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE_IMPORTAT",filter:`ID eq ${t.ID}`,title:"Cercar o validar IDALU",return:n.fullPath}})},{value:"fussioUn",text:"Traspàs a AANEE",icon:"FollowUser",action:()=>a.push({path:"/lligam-csv",query:{filter:`ID eq ${t.ID}`,return:n.fullPath}})}]:[{value:"idalu",text:"Cercar o verificar IDALU",icon:"FollowUser",children:[{value:"tots",text:"Cercar tots els alumnes sense IDALU",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE_IMPORTAT",filter:"IDALU eq null",title:"Importats sense IDALU",return:n.fullPath}})},{value:"tots",text:"Cercar els alumnes seleccionats sense IDALU",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE_IMPORTAT",filter:"IDALU eq null"+(n.query.filter?" and "+n.query.filter:""),title:"Importats seleccionats sense IDALU",return:n.fullPath}})},{value:"nocercats",text:"Cercar els alumnes seleccionats no cercats",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"AANEE_ALUMNE_IMPORTAT",title:"Importats no cercats",filter:"IDALU eq null and IDALU_NOCERCAR ne true "+(n.query.filter?" and "+n.query.filter:""),return:n.fullPath}})}]},{value:"fussio",text:"Traspàs a AANEE",icon:"FollowUser",action:()=>a.push({path:"/lligam-csv",query:{filter:n.query.filter,return:n.fullPath}})}];return e.concat(l)},permissionDenied:e=>({create:!0,edit:!0,delete:!0})},ha={name:"AANEE_ALUMNE_NOIMPORTAT",type:"listSplitted",label:"Alumnes no importats",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"IDALU",label:"IDALU",type:"string"},{name:"IDENTIFICACIO_FISCAL",label:"ID. Fiscal",type:"string"},{name:"ID_ORIGEN",label:"Font de les dades",type:"dictionary",dataType:"number",defaultValue:1,disabled:!0,entityName:"AANEE_ORIGEN_INFORMACIO"},{name:"REFERENCIA",label:"Referència càrrega",type:"string"},{name:"ID_EAP",label:"EAP",type:"dictionary",dataType:"number",entityName:"GEN_EAP"},{name:"NOM",label:"Nom alumne",type:"string"},{name:"COGNOM1",label:"1r cognom",type:"string"},{name:"COGNOM2",label:"2n cognom",type:"string"},{name:"DATA_NAIXEMENT",label:"D.Naixement",type:"date",align:"center"},{name:"NOM_TUTOR1",label:"Nom 1r tutor",type:"string"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",label:"Id. Fiscal 1r tutor",type:"string"},{name:"ERROR",label:"Error detectat",type:"string"}],filter:[{name:"IDALU",operation:"eq"},{name:"COGNOM1",label:"Primer cognom alumne conté",operation:"contains"},{name:"NOM",label:"Nom alumne conté",operation:"contains"},{name:"TIPUS_ALUMNE",operation:"eq"},{name:"ID_NIVELL",operation:"eq"}],menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),l=t?[]:[{value:"delete",text:"Esborrar tots els registres",icon:"Delete",action:()=>async function(e,t){const a=T(),n=he();n.confirm({title:"Alumnes CSV no importats",message:"Esborrar tots els alumnes no importats ?",accept:async()=>{const l=await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:a.jwt},body:JSON.stringify({opcio:"noimportats"})}),i=await l.json();200===l.status?n.alert({title:"Alumnes CSV no importats",message:i}):n.alert({title:"Alumnes CSV no importats",message:"Error inesperat."}),e.push({path:"/AANEE_ALUMNE_NOIMPORTAT",query:{...t.query,reload:!0},reload:!0})}})}(a,n)}];return e.concat(l)},permissionDenied:e=>({create:!0,edit:!0,delete:!0})},La=(0,l.defineStore)({id:"config",state:()=>({dataCalcul:null,alumnePageRows:16,alumneEditPageRows:16,ofertaEditPageRows:16,loadCsv:!1,filesFindIdalus:16,filesLligamAanee:16,filesLlligamRav:16,alumnesOrdinarisP3:24,alumnesNeeaP3:1,alumnesNeebP3:4,alumnesNeeP3:5,alumnesOrdinaris1Eso:28,alumnesNeea1Eso:1,alumnesNeeb1Eso:4,alumnesNee1Eso:5,distanciaPrimariaTit:20,distanciaSecundariaTit:25,distanciaPrimaria:30,distanciaSecundaria:35}),actions:{saveConfig(e){this.dataCalcul=e.DATA_CALCUL,this.alumnePageRows=e.ALUMNE_PAGEROWS,this.alumneEditPageRows=e.ALUMNE_EDIT_PAGEROWS,this.ofertaEditPageRows=e.OFERTA_EDIT_PAGEROWS,this.loadCsv=e.LOAD_CSV,this.filesFindIdalus=e.FILES_FINDIDALUS,this.filesLligamAanee=e.FILES_LLIGAM_AANEE,this.filesLlligamRav=e.FILES_LLIGAM_RAV,this.alumnesOrdinarisP3=e.ALUMNES_ORD_GRUP_P3,this.alumnesNeeaP3=e.ALUMNES_NEEA_GRUP_P3,this.alumnesNeebP3=e.ALUMNES_NEEB_GRUP_P3,this.alumnesNeeP3=e.ALUMNES_NEE_GRUP_P3,this.alumnesOrdinaris1Eso=e.ALUMNES_ORD_GRUP_1ESO,this.alumnesNeea1Eso=e.ALUMNES_NEEA_GRUP_1ESO,this.alumnesNeeb1Eso=e.ALUMNES_NEEB_GRUP_1ESO,this.alumnesNee1Eso=e.ALUMNES_NEE_GRUP_1ESO,this.distanciaPrimariaTit=e.DISTANCIA_PRIMARIA_TIT,this.distanciaSecundariaTit=e.DISTANCIA_SECUNDARIA_TIT,this.distanciaPrimaria=e.DISTANCIA_PRIMARIA,this.distanciaSecundaria=e.DISTANCIA_SECUNDARIA,localStorage.setItem("alumnePageRows",e.ALUMNE_PAGEROWS),localStorage.setItem("alumneEditPageRows",e.ALUMNE_EDIT_PAGEROWS),localStorage.setItem("ofertaEditPageRows",e.OFERTA_EDIT_PAGEROWS)}}}),xa={class:"layoutBase-grid"},Ua={class:"layoutBase-logo"},Ma=["src"],Pa={class:"layoutBase-title"},Va={class:"layoutBase-menu"},Fa={class:"layoutBase-content"},wa={__name:"layout-base",props:{subtitle:{type:String,required:!0},hideMenu:{type:Boolean,default:!1}},setup(e){const t=T(),a=t.data.role,l=(0,r.useRouter)(),i=(0,r.useRoute)();function o(e,t){const a=En(t);if("list"===e)return{text:a.label,action:()=>l.push(`/${t}`)};if("dictionary"===e){const e=a.fields.find((e=>e.defaultField));return{text:a.label,action:()=>l.push({path:`/${t}`,query:{orderby:`${e.name} asc`}})}}}const d=[{text:"Alumnes",icon:"People",children:[o("list","AANEE_ALUMNE"),o("list","AANEE_ALUMNE_GRID"),o("list","AANEE_ALUMNE_CANVI"),{type:"divider"},o("list","RAV_ALUMNE"),{type:"divider"},o("list","GEDAC_ALUMNE"),o("list","RALC_HISTORIC_ALUMNE"),{type:"divider"},o("list","GEDAC_OFERTA_EDUCATIVA")]},{text:"Càrregues",disabled:!["ESCOLARITZACIO","INCLUSIVA"].includes(a),icon:"Upload",children:[{text:"Llegir d'arxius CSV alumnes NEE-A",action:()=>l.push("/load-csv?type=neea")},o("list","AANEE_ALUMNE_NOIMPORTAT"),o("list","AANEE_ALUMNE_IMPORTAT"),{type:"divider"},{text:"Càrrega dades personals GEDAC",action:()=>l.push("/load-csv?type=pers")},{text:"Càrrega oferta educativa GEDAC",action:()=>l.push("/load-csv?type=ofe")},{text:"Càrrega sol·licituds GEDAC",action:()=>l.push("/load-csv?type=pets")},{text:"Càrrega assignacions GEDAC",action:()=>l.push("/load-csv?type=ass")},{text:"Càrrega barems GEDAC",action:()=>l.push("/load-csv?type=barems")}]},{text:"Simulacions",icon:"BookmarkReport",disabled:!["ESCOLARITZACIO","SIMULACIONS"].includes(a),action:()=>l.push("/AANEE_SIMULACIO")},{text:"Administració",icon:"Settings",disabled:!["ESCOLARITZACIO","INCLUSIVA"].includes(a),children:[o("list","AANEE_USUARI"),{text:"Paràmetres aplicació",icon:"Permissions",action:()=>l.push({path:"/config",query:{return:i.fullPath}})}]},{text:t.data.name,icon:"SwitchUser",children:[{text:"Canviar la clau d'acces",icon:"Permissions",action:()=>l.push("/password-change")},{text:"Tancar sessió",icon:"LeaveUser",action:()=>{t.setJwt(),l.push("/")}}]}];return(t,a)=>{const l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",xa,[(0,n.createElementVNode)("div",Ua,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(s)}/images/logo.png`,width:"148"},null,8,Ma)]),(0,n.createElementVNode)("div",Pa,[(0,n.createVNode)(l,{class:"layoutBase-appTitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(c)),1)])),_:1}),(0,n.createVNode)(l,{class:"layoutBase-subtitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.subtitle),1)])),_:1})]),(0,n.createElementVNode)("div",Va,[e.hideMenu?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,"far-items":d}))]),(0,n.createElementVNode)("div",Fa,[(0,n.renderSlot)(t.$slots,"default")])])}}},Ga=(0,R.Z)(wa,[["__scopeId","data-v-509d1d50"]]),Ba={key:0},ka={class:"layoutListItem-actions"},$a={__name:"layout-list-item",props:{tabs:{type:Array,default:void 0},currentTab:{type:String,default:void 0},hasSave:{type:Boolean,default:!1},hasSaveAndNew:{type:Boolean,default:!1},hasSaveAndEdit:{type:Boolean,default:!1},hasSaveAndClose:{type:Boolean,default:!1},hasGoBack:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!1},hasReset:{type:Boolean,default:!1},hasRemove:{type:Boolean,default:!1},maxWidth:{type:String,default:null},selfAling:{type:String,default:"center",validator:e=>!e||["left","center","right"].includes(e)}},emits:["update:currentTab","save","saveAndNew","saveAndEdit","saveAndClose","goBack","close","reset","remove"],setup(e){const t=e;return(a,l)=>{const i=(0,n.resolveComponent)("fura-pivot"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(`layoutListItem-container layoutListItem-${t.selfAling}`),style:(0,n.normalizeStyle)({maxWidth:e.maxWidth})},[(0,n.createElementVNode)("div",null,[(0,n.renderSlot)(a.$slots,"default")]),e.tabs?.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",Ba,[(0,n.createVNode)(i,{tabs:e.tabs,"model-value":e.currentTab,"onUpdate:modelValue":l[0]||(l[0]=e=>a.$emit("update:currentTab",e))},null,8,["tabs","model-value"]),(0,n.renderSlot)(a.$slots,"child")])):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",ka,[e.hasSave?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,class:"layoutListItem-button",primary:"",text:"Guardar",icon:"Save",onClick:l[1]||(l[1]=e=>a.$emit("save"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndNew?((0,n.openBlock)(),(0,n.createBlock)(o,{key:1,class:"layoutListItem-button",primary:"",text:"Guardar i nou",icon:"SaveAs",onClick:l[2]||(l[2]=e=>a.$emit("saveAndNew"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndEdit?((0,n.openBlock)(),(0,n.createBlock)(o,{key:2,class:"layoutListItem-button",primary:"",text:"Guardar i continuar editant",icon:"SaveAs",onClick:l[3]||(l[3]=e=>a.$emit("saveAndEdit"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:3,class:"layoutListItem-button",primary:"",text:"Guardar i tancar",icon:"SaveAndClose",onClick:l[4]||(l[4]=e=>a.$emit("saveAndClose"))})):(0,n.createCommentVNode)("v-if",!0),e.hasGoBack?((0,n.openBlock)(),(0,n.createBlock)(o,{key:4,class:"layoutListItem-button",text:"Tornar",icon:"Back",onClick:l[5]||(l[5]=e=>a.$emit("goBack"))})):(0,n.createCommentVNode)("v-if",!0),e.hasClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:5,class:"layoutListItem-button",text:"Tancar",icon:"ChromeClose",onClick:l[6]||(l[6]=e=>a.$emit("close"))})):(0,n.createCommentVNode)("v-if",!0),e.hasReset?((0,n.openBlock)(),(0,n.createBlock)(o,{key:6,class:"layoutListItem-button",text:"Reiniciar",icon:"Refresh",onClick:l[7]||(l[7]=e=>a.$emit("reset"))})):(0,n.createCommentVNode)("v-if",!0),e.hasRemove?((0,n.openBlock)(),(0,n.createBlock)(o,{key:7,primary:"",class:"layoutListItem-button layoutListItem-alertButton",text:"Eliminar",icon:"Delete",onClick:l[8]||(l[8]=e=>a.$emit("remove"))})):(0,n.createCommentVNode)("v-if",!0)])],6)}}},qa=(0,R.Z)($a,[["__scopeId","data-v-f73b1a8e"]]),ja={class:"AANEE_SETTINGS-editItem"},Ka={__name:"form-settings",setup(e){const t=T(),a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=[],o=(0,n.reactive)({}),s=En("AANEE_SETTINGS"),d=(0,n.computed)((()=>pn(s,["ALUMNE_PAGEROWS","ALUMNE_EDIT_PAGEROWS","OFERTA_EDIT_PAGEROWS","FILES_FINDIDALUS","FILES_LLIGAM_AANEE","FILES_LLIGAM_RAV","ALUMNES_ORD_GRUP_P3","ALUMNES_NEEA_GRUP_P3","ALUMNES_NEEB_GRUP_P3","ALUMNES_NEE_GRUP_P3","ALUMNES_ORD_GRUP_1ESO","ALUMNES_NEEA_GRUP_1ESO","ALUMNES_NEEB_GRUP_1ESO","ALUMNES_NEE_GRUP_1ESO","DISTANCIA_PRIMARIA_TIT","DISTANCIA_SECUNDARIA_TIT","DISTANCIA_PRIMARIA","DISTANCIA_SECUNDARIA"])));async function u(){(await fetch(`${m}/AANEE_SETTINGS(1)`,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:t.jwt},body:JSON.stringify(o)})).status<=400?(La().saveConfig(o),l.push(a.query.return),l.push("/"),setTimeout((function(){location.reload()}),500)):alert("Error de comuncació amb el servidor")}function c(){l.push(a.query.return)}return(0,n.onMounted)((async()=>{const e=await xe("AANEE_SETTINGS(1)");d.value.forEach((function(t){o[t.name]=e[t.name]}))})),(e,t)=>{const a=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"itemListEdit-container",subtitle:(0,n.unref)(s).label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(qa),{"max-width":"930px","has-save":"","has-close":"",onSave:u,onClose:c},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ja,[(0,n.createVNode)(a,{style:{"grid-area":"PAGINACIO","margin-top":"32px","font-weight":"bold"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Paginació ")])),_:1}),(0,n.createVNode)(a,{style:{"grid-area":"FIND","margin-top":"32px","font-weight":"bold"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Files processos de cerca i lligam ")])),_:1}),(0,n.createVNode)(a,{style:{"grid-area":"SIMULACIONS","margin-top":"32px","font-weight":"bold"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Simulacions: Alumnes x grup ")])),_:1}),(0,n.createVNode)(a,{style:{"grid-area":"TEMPS","font-weight":"bold","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Tamps màxims (minuts) de viatge assignació places d'ofici ")])),_:1}),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(d),(e=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{key:e.name,entity:o,field:e,validations:i,style:(0,n.normalizeStyle)(`grid-area: ${e.name}`),"cache-name":"AANEE_SETTINGS",modelValue:o[e.name],"onUpdate:modelValue":t=>o[e.name]=t},null,8,["entity","field","style","modelValue","onUpdate:modelValue"])))),128))])])),_:1})])),_:1},8,["subtitle"])}}},za=(0,R.Z)(Ka,[["__scopeId","data-v-764fa502"]]),Za={name:"AANEE_SETTINGS",type:"listSplitted",label:"Configuració de l'aplicació",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"DATA_CALCUL",label:"Data càlcul",type:"date",readonlu:!0},{name:"ALUMNE_PAGEROWS",label:"Llistat d'alumnes",type:"number",decimals:0,defaultField:!0,min:10,max:100,align:"right",required:!0},{name:"ALUMNE_EDIT_PAGEROWS",label:"Edició ràpida d'alumnes",type:"number",decimals:0,min:10,max:60,align:"right",required:!0},{name:"OFERTA_EDIT_PAGEROWS",label:"Edició ràpida Oferta",type:"number",decimals:0,min:10,max:60,align:"right",required:!0},{name:"FILES_FINDIDALUS",label:"Cerca d'IDALUS",type:"number",decimals:0,min:8,max:32,align:"right",required:!0},{name:"FILES_LLIGAM_AANEE",label:"Cerca lligam GEDAC/AANEE",type:"number",decimals:0,min:8,max:32,align:"right",required:!0},{name:"FILES_LLIGAM_RAV",label:"Cerca lligam RAV",type:"number",decimals:0,min:8,max:32,align:"right",required:!0},{name:"ALUMNES_ORD_GRUP_P3",label:"Ordinaris P3",type:"number",decimals:0,min:8,max:40,align:"right",required:!0},{name:"ALUMNES_NEEA_GRUP_P3",label:"NEE-A P3",type:"number",align:"right",decimals:0,min:0,max:32,required:!0},{name:"ALUMNES_NEEB_GRUP_P3",label:"NEE-B P3",type:"number",decimals:0,min:0,max:32,align:"right",required:!0},{name:"ALUMNES_NEE_GRUP_P3",label:"NEE P3",type:"number",decimals:0,align:"right",disabled:!0},{name:"ALUMNES_ORD_GRUP_1ESO",label:"Ordinaris 1r ESO",type:"number",decimals:0,min:0,max:32,align:"right",required:!0},{name:"ALUMNES_NEEA_GRUP_1ESO",label:"NEE-A 1r ESO",type:"number",decimals:0,min:0,max:32,align:"right",required:!0},{name:"ALUMNES_NEEB_GRUP_1ESO",label:"NEE-B 1r ESO",type:"number",decimals:0,min:0,max:32,align:"right",required:!0},{name:"ALUMNES_NEE_GRUP_1ESO",label:"NEE 1r ESO",type:"number",decimals:0,align:"right",disabled:!0},{name:"DISTANCIA_PRIMARIA_TIT",label:"Primària igual Titularitat",type:"number",decimals:0,align:"right"},{name:"DISTANCIA_SECUNDARIA_TIT",label:"Secundària igual Titularitat",type:"number",decimals:0,align:"right"},{name:"DISTANCIA_PRIMARIA",label:"Primària titularitat diferent",type:"number",decimals:0,align:"right"},{name:"DISTANCIA_SECUNDARIA",label:"Secundària titularitat diferent",type:"number",decimals:0,align:"right"}],form:{entityName:"AANEE_SETTINGS",component:(0,n.markRaw)(za),maxWidth:"1200px"}};function Xa(){const e=(0,n.ref)(window.opener),t=(0,n.ref)(!!window.opener),a=[];function l(e){for(const t of a)t(e.detail)}return(0,n.onScopeDispose)((()=>{window.removeEventListener("message",l)})),(0,n.readonly)({isChildWindow:t,parentWindow:e,close:function(){window.close()},onMessage:function(e){a.push(e)},sendMessage:function(t){const a=new CustomEvent("message",{detail:t});e.value?.dispatchEvent(a)}})}const Wa={class:"AANEE_SIMULACIO-editItem-layout"},Ha={__name:"form-simulacio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l="AANEE_SIMULACIO",i=En(l),{open:o,onMessage:r}=function(){const e=(0,n.ref)(!1),t=(0,n.ref)(null);let a;const l=[],i=[];function o(e){for(const t of i)t(e.detail)}return(0,n.onScopeDispose)((()=>{clearInterval(a),window.removeEventListener("message",o)})),(0,n.readonly)({isOpen:e,childWindow:t,open:function(i,r="_blank",s){t.value=window.open((0,n.unref)(i),(0,n.unref)(r),(0,n.unref)(s)),e.value=!0,a=setInterval((()=>{if(t.value.closed){clearInterval(a),window.removeEventListener("message",o),a=null,e.value=!1;for(const e of l)e()}}),0),window.addEventListener("message",o)},close:function(){t.value.close()},onClose:function(e){l.push(e)},onMessage:function(e){i.push(e)},sendMessage:function(e){const a=new CustomEvent("message",{detail:e});t.value?.dispatchEvent(a)}})}();pt().load(l);const d=pn(i,[{name:"ID_NIVELL",disabled:!!a.entity.ID,useFilter:e=>e=>2===e.ID||11===e.ID},"CODI_SIMULACIO","NOM_SIMULACIO","PRIMERNUMERO_DESEMPAT","DATA_CALCUL","ASSIG_MANUALS_NEE","FORATERMINI_NEE","DUPLICADES_NEE","ESTAT_SOLICITUD","ASSIG_MANUALS_ORD","REASSIGNAR_NEE","REASSIGNAR_ORDINARIS","IGNORAR_FORACIUTAT","EMPRAR_MARCATGES_AANEE","EMPRAR_TIPUS_AANEE"]);return r((async function({action:e}){if("save"===e){const e=(await xe("AANEE_SIMULACIO_OFERTA",{$filter:`ID_SIMULACIO eq ${a.entity.ID}`,$expand:"GEN_CENTRE($select=CODIINOM_CENTRE),GEN_ZONA($select=CODI_ZONA)",$orderby:"ID_ZONA"})).value;t("change",(t=>{t.AANEE_SIMULACIO_OFERTA=e}))}})),(i,r)=>{const u=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Wa,[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(d),entity:e.entity,validations:e.validations,"cache-name":l,onChange:r[0]||(r[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"]),(0,n.createVNode)(u,{class:"alta",style:{"grid-area":"ALTA"},text:"Altes massives per zona",disabled:!e.entity.ID,onClick:r[1]||(r[1]=e=>(0,n.unref)(o)(`/${(0,n.unref)(s)}/AANEE_SIMULACIO_OFERTA/create?popup&selectedItemId=${a.entity.ID}&idnivell=${a.entity.ID_NIVELL}`))},null,8,["disabled"])])}}},Ya=(0,R.Z)(Ha,[["__scopeId","data-v-38cbc7e9"]]),Ja={class:"AANEE_SIMULACIO_OFERTA-edit-layout"},Qa={__name:"form-oferta-centre",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=La(),i=(0,o.entityDefinition)(a.entity).entityName,r=(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_NIVELL,s=2===(0,o.entityParent)((0,o.entityBase)(a.entity)??a.entity).ID_NIVELL?1:3;pt().load(i);const d=(0,n.computed)((()=>!!a.entity.MODIFICACIO_ORDINARIA_CENTRE||!!a.entity.MODIFICACIO_NEEA_CENTRE||!!a.entity.MODIFICACIO_NEEB_CENTRE)),u=(0,n.computed)((()=>!!a.entity.MODIFICACIO_ORDINARIA_GRUP||!!a.entity.MODIFICACIO_NEEA_GRUP||!!a.entity.MODIFICACIO_NEEB_GRUP)),c=En(i),m=(0,n.computed)((()=>pn(c,[{name:"ID_ZONA",filter:`ID_ETAPA eq ${s||0}`,disabled:!!a.entity.ID,onChange:I},{name:"TITULARITAT",disabled:!!a.entity.ID||!a.entity.ID_ZONA,required:!0,onChange:I},{name:"ID_CENTRE",disabled:!!a.entity.ID||!a.entity.ID_ZONA||!a.entity.TITULARITAT,required:!0,filter:C,onChange:A},{name:"MODIFICACIO_ORDINARIA_GRUP",label:" ",disabled:d.value,onChange:y},{name:"MODIFICACIO_NEEA_GRUP",label:" ",disabled:d.value,onChange:y},{name:"MODIFICACIO_NEEB_GRUP",label:" ",disabled:d.value,onChange:y},{name:"MODIFICACIO_GRUPS",label:" ",onBlur:N},{name:"MODIFICACIO_ORDINARIA_CENTRE",label:" ",disabled:u.value,onChange:y},{name:"MODIFICACIO_NEEA_CENTRE",label:" ",disabled:u.value,onChange:y},{name:"MODIFICACIO_NEEB_CENTRE",label:" ",disabled:u.value,onChange:y},{name:"MODIFICACIO_NEE_GRUP",label:" "},{name:"MODIFICACIO_NEE_CENTRE",label:" "}]))),E=[{name:"NCTES",label:"N. Centres",type:"number",align:"right",decimals:"0"},{name:"GRUPS_INI",label:"Grups",type:"number",align:"right",decimals:"0"},{name:"OFERTA_ORDINARIA_INI",label:"Of. ordinària",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEA_INI",label:"Of. NEE-A",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEB_INI",label:"Of. NEE-B",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEE_INI",label:"Of. NEE",type:"number",align:"right",decimals:"0"},{name:"GRUPS_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_ORDINARIA_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEA_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEB_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEE_FIN",label:" ",type:"number",align:"right",decimals:"0"}],p=(0,n.reactive)({NCTES:0,GRUPS_INI:0,OFERTA_ORDINARIA_INI:0,OFERTA_NEEA_INI:0,OFERTA_NEEB_INI:0,OFERTA_NEE_INI:0,GRUPS_FIN:0,OFERTA_ORDINARIA_FIN:0,OFERTA_NEEA_FIN:0,OFERTA_NEEB_FIN:0,OFERTA_NEE_FIN:0});async function A(){I()}async function I(){const e=await xe("GEDAC_OFERTA_EDUCATIVA",{$apply:`filter(${a.entity.ID_CENTRE?`ID_CENTRE eq ${a.entity.ID_CENTRE}`:a.entity.ID_ZONA&&a.entity.TITULARITAT?`ID_ZONA eq ${a.entity.ID_ZONA} and TITULARITAT eq '${a.entity.TITULARITAT}'`:a.entity.TITULARITAT?`TITULARITAT eq '${a.entity.TITULARITAT}'`:a.entity.ID_ZONA?`ID_ZONA eq ${a.entity.ID_ZONA}`:"ID eq 0"} and ID_NIVELL eq ${r})/aggregate($count as N,GRUPS with sum as GRUPS, OFERTA_ORDINARIA with sum as OFERTA_ORDINARIA, OFERTA_NEEA with sum as OFERTA_NEEA, OFERTA_NEEB with sum as OFERTA_NEEB, OFERTA_NEE with sum as OFERTA_NEE)`});1===e.value.length?(p.NCTES=e.value[0].N,p.GRUPS_INI=e.value[0].GRUPS||0,p.OFERTA_ORDINARIA_INI=e.value[0].OFERTA_ORDINARIA||0,p.OFERTA_NEEA_INI=e.value[0].OFERTA_NEEA||0,p.OFERTA_NEEB_INI=e.value[0].OFERTA_NEEB||0,p.OFERTA_NEE_INI=e.value[0].OFERTA_NEE||0):(p.NCTES=0,p.GRUPS_INI=0,p.OFERTA_ORDINARIA_INI=0,p.OFERTA_NEEA_INI=0,p.OFERTA_NEEB_INI=0,p.OFERTA_NEE_INI=0),y()}function N(){const e=(a.entity.MODIFICACIO_GRUPS||0)*(2===r?l.alumnesNeeaP3:l.alumnesNeea1Eso),n=(a.entity.MODIFICACIO_GRUPS||0)*(2===r?l.alumnesNeebP3:l.alumnesNeeb1Eso);t("change",(t=>{t.MODIFICACIO_ORDINARIA_CENTRE=(t.MODIFICACIO_GRUPS||0)*(2===r?l.alumnesOrdinarisP3:l.alumnesOrdinaris1Eso),t.MODIFICACIO_NEEA_CENTRE=e,t.MODIFICACIO_NEEB_CENTRE=n,t.MODIFICACIO_NEE_CENTRE=e+n})),y()}function y(){p.GRUPS_FIN=p.GRUPS_INI+(a.entity.MODIFICACIO_GRUPS||0)*p.NCTES,p.OFERTA_ORDINARIA_FIN=p.OFERTA_ORDINARIA_INI+(a.entity.MODIFICACIO_ORDINARIA_CENTRE||0)*p.NCTES+(a.entity.MODIFICACIO_ORDINARIA_GRUP||0)*p.GRUPS_INI,p.OFERTA_NEEA_FIN=p.OFERTA_NEEA_INI+(a.entity.MODIFICACIO_NEEA_CENTRE||0)*p.NCTES+(a.entity.MODIFICACIO_NEEA_GRUP||0)*p.GRUPS_INI,p.OFERTA_NEEB_FIN=p.OFERTA_NEEB_INI+(a.entity.MODIFICACIO_NEEB_CENTRE||0)*p.NCTES+(a.entity.MODIFICACIO_NEEB_GRUP||0)*p.GRUPS_INI,p.OFERTA_NEE_FIN=p.OFERTA_NEEA_FIN+p.OFERTA_NEEB_FIN,t("change",(e=>{e.MODIFICACIO_NEE_GRUP=(e.MODIFICACIO_NEEA_GRUP||0)+(e.MODIFICACIO_NEEB_GRUP||0),e.MODIFICACIO_NEE_CENTRE=(e.MODIFICACIO_NEEA_CENTRE||0)+(e.MODIFICACIO_NEEB_CENTRE||0)}))}Yt((async()=>{null!==a.entity.ID&&await I()}));const C=(0,n.computed)((function(){return r&&a.entity.ID_ZONA?a.entity.TITULARITAT?`TITULARITAT eq '${a.entity.TITULARITAT}' and GEN_CENTRE_ZONA/any(zona: zona/ID_ZONA eq ${a.entity.ID_ZONA})`:`GEN_CENTRE_ZONA/any(zona: zona/ID_ZONA eq ${a.entity.ID_ZONA})`:"ID eq 0"}));return(a,l)=>{const o=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ja,[(0,n.createVNode)(o,{style:{"grid-area":"INICIAL","margin-top":"31px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Oferta inicial GEDAC ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"ACTUALG","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" +/- a cada grup del centre ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"ACTUALC","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" +/- al centre ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"FINAL","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Oferta resultant del centre ")])),_:1}),(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(m),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(i),onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations","cache-name"]),((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(E,(e=>(0,n.createVNode)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name}),key:e.name,entity:p,field:e,disabled:""},null,8,["style","entity","field"]))),64))])}}},en=(0,R.Z)(Qa,[["__scopeId","data-v-11353cd2"]]);async function tn(e,t,a,n){const l=En(e),i=pn(l,a),o=a.map((function(e){const a=["string","choice"].includes(i.find((t=>t.name===e)).type)?"'":"";return e+" eq "+a+(t[e]||[]).toString().replace(/'/g,"''")+a})).join(" "+n+" "),{"@odata.count":r}=await xe(e,{$filter:"number"==typeof t.ID?`ID ne ${t.ID} and (${o})`:o,$count:!0,$top:0});if(r>0)return`Hi ha ${l.label} amb codis i/o noms duplicats`}const an={name:"AANEE_SIMULACIO",type:"listSplitted",label:"Simulacions",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI_SIMULACIO",label:"Codi",type:"string",required:!0,maxlength:16},{name:"NOM_SIMULACIO",label:"Nom simulació",type:"string",required:!0,maxlength:80},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL",loadAlwaysInView:!0},{name:"ESTAT_SOLICITUD",label:"Estat sol·licituds",type:"choice",dataType:"string",options:["(totes)","Validades"],required:!0,maxlength:24},{name:"DESCRIPCIO",label:"Descripció",type:"string",maxlength:8e3,multiline:!0},{name:"FORATERMINI_NEE",label:"Ignorar fora termini NEE",type:"boolean"},{name:"DUPLICADES_NEE",label:"Ignorar duplicades NEE",type:"boolean"},{name:"ASSIG_MANUALS_NEE",label:"Ignorar assig.manuals NEE",type:"boolean"},{name:"ASSIG_MANUALS_ORD",label:"Ignorar assig.manuals ord.",type:"boolean"},{name:"REASSIGNAR_NEE",label:"Reassignar NEE a places vacants ordinàries",type:"boolean"},{name:"REASSIGNAR_ORDINARIS",label:"Reassignar Ordinaris a places vacants NEE-A",type:"boolean",defaultValue:!0},{name:"IGNORAR_FORACIUTAT",label:"Ignorar peticions fora ciutat",type:"boolean"},{name:"EMPRAR_TIPUS_AANEE",label:"Emprar tipus d'alumne d'AANEE",type:"boolean"},{name:"EMPRAR_MARCATGES_AANEE",label:"Emprar assignacions d'AANEE",type:"boolean"},{name:"EMPRARNUMERO_DESEMPAT_ASSIG",label:"Emprar Nº desempat assignacions",type:"boolean"},{name:"PRIMERNUMERO_DESEMPAT",label:"Número de desempat",type:"number",required:!0,maxlength:16},{name:"DATA_CALCUL",label:"Data càlcul",type:"date",readonly:!0,disabled:!0},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64},{name:"AANEE_SIMULACIO_RESULTAT_CENTRE/odata.count",type:"childCount",navigationKey:"AANEE_SIMULACIO_RESULTAT_CENTRE",loadAlwaysInView:!0}],form:{entityName:"AANEE_SIMULACIO",component:(0,n.markRaw)(Ya),maxWidth:"1080px",rules:[async e=>await tn("AANEE_SIMULACIO",e,["CODI_SIMULACIO"],"or")],children:[{listName:"AANEE_SIMULACIO_OFERTA",foreingKey:"ID_SIMULACIO",detailFields:["ID_ZONA","ID_CENTRE"]}],tabs:[{name:"AANEE_SIMULACIO_OFERTA",title:"Oferta",type:"child",listName:"AANEE_SIMULACIO_OFERTA",fields:["ID_ZONA","ID_CENTRE","MODIFICACIO_ORDINARIA_CENTRE","MODIFICACIO_NEE_CENTRE","MODIFICACIO_ORDINARIA_GRUP","MODIFICACIO_NEE_GRUP"],form:{component:(0,n.markRaw)(en),maxWidth:"1050px"}},{name:"DESCRIPCIO",title:"Descripció",component:"auto",fields:e=>[{name:"DESCRIPCIO",label:" "}]}]},menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),l=t?[{text:"Calcular simulació",icon:"Calculator",action:()=>async function(e){const t=T(),l=he();l.loadStart("simulacio");const i=await fetch(`${m}/Stored/pr_AANEE_CALCUL_SIMULACIO`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:t.jwt},body:JSON.stringify({ID_SIMULACIO:e})});l.loadEnd("simulacio");const o=await i.json();l.alert({title:"Càlcul simulació",message:200===i.status?"Simulació calculada":o}),a.push({path:n.fullPath,reload:!0})}(t.ID)},{value:"reports",text:"Informes",icon:"Print",disabled:0===t["AANEE_SIMULACIO_RESULTAT_CENTRE@odata.count"],action:()=>a.push({path:"/print-simulacions",query:{id:t.ID,id_nivell:t.ID_NIVELL,return:n.fullPath}})},{text:"Alta per còpia",icon:"Copy",action:()=>async function(e){const t=T(),l=he();l.confirm({title:"Simulacions procés d'assignació de places",message:"Duplicar simulació ?",accept:async()=>{const i=await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:t.jwt},body:JSON.stringify({opcio:"duplicarsimulacio",id:e})}),o=await i.json();l.alert({title:"Duplicar simulació",message:o}),a.push({path:"/AANEE_SIMULACIO",query:{...n.query,reload:!0},reload:!0})}})}(t.ID)}]:[];return e.concat(l)}},nn=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_SIMULACIO",label:"Simulació",type:"lookupCache",entity:{name:"AANEE_SIMULACIO",primaryKey:"ID",targetKey:"NOM_SIMULACIO"},required:!0},{name:"ID_ZONA",label:"Zona",type:"lookup",required:!0,dataType:"number",entity:{name:"GEN_ZONA",primaryKey:"ID",targetKey:"CODI_ZONA"}},{name:"TITULARITAT",label:"Titularitat",type:"choice",dataType:"string",options:g.titularitats},{name:"ID_CENTRE",label:"Centre",type:"lookup",dataType:"number",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"MODIFICACIO_GRUPS",label:"+/- Grups",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_ORDINARIA_GRUP",label:"+/- Of. ord. X grup",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEA_GRUP",label:"+/- Of.NEE-A X grup",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEB_GRUP",label:"+/- Of.NEE-B X grup",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEE_GRUP",label:"+/- Of.NEE X grup",type:"number",align:"right",disabled:!0,decimals:0},{name:"MODIFICACIO_ORDINARIA_CENTRE",label:"+/- Of.ord. X centre",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEA_CENTRE",label:"+/- Of.NEE-A X centre",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEB_CENTRE",label:"+/- Of.NEE-B X centre",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEE_CENTRE",label:"+/- Of.NEE X centre",type:"number",align:"right",disabled:!0,decimals:0}],ln={class:"AANEE_SIMULACIO_OFERTA-edit-layout"},on={__name:"form-oferta-variacio",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=(0,r.useRoute)(),i="AANEE_SIMULACIO_OFERTA",o=l.query.selectedItemId,s=l.query.idnivell;pt().load(i),t("change",(e=>{e.ID_SIMULACIO=o}));const d=(0,n.reactive)({NCTES:0,NGRUPS:0,OFERTA_ORDINARIA_INI:0,OFERTA_NEEA_INI:0,OFERTA_NEEB_INI:0,OFERTA_NEE_INI:0,OFERTA_ORDINARIA_FIN:0,OFERTA_NEEA_FIN:0,OFERTA_NEEB_FIN:0,OFERTA_NEE_FIN:0}),u=(0,n.computed)((()=>!!a.entity.MODIFICACIO_ORDINARIA_CENTRE||!!a.entity.MODIFICACIO_NEEA_CENTRE||!!a.entity.MODIFICACIO_NEEB_CENTRE)),c=(0,n.computed)((()=>!!a.entity.MODIFICACIO_ORDINARIA_GRUP||!!a.entity.MODIFICACIO_NEEA_GRUP||!!a.entity.MODIFICACIO_NEEB_GRUP)),m=En("AANEE_SIMULACIO_OFERTA"),E=(0,n.computed)((()=>pn(m,[{name:"ID_ZONA",type:"lookup",required:!0,dataType:"number",entity:{name:"GEN_ZONA",primaryKey:"ID",targetKey:"CODI_ZONA"},filter:"ID_ETAPA eq "+("2"===l.query.idnivell?1:3),onChange:C},{name:"TITULARITAT",disabled:null===d.ID_ZONA,type:"choice",dataType:"string",options:["Públic","Privat concertat"],clearValueOnDisabled:!0,onChange:C},{name:"MODIFICACIO_ORDINARIA_GRUP",label:" ",disabled:u.value,onChange:f,type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEA_GRUP",label:" ",disabled:u.value,onChange:f},{name:"MODIFICACIO_NEEB_GRUP",label:" ",disabled:u.value,onChange:f,type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_ORDINARIA_CENTRE",label:" ",disabled:c.value,onChange:f,type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEA_CENTRE",label:" ",disabled:c.value,onChange:f,type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEEB_CENTRE",label:" ",disabled:c.value,onChange:f,type:"number",align:"right",clearValueOnDisabled:!0,decimals:0},{name:"MODIFICACIO_NEE_GRUP",label:" ",type:"number",align:"right",decimals:0},{name:"MODIFICACIO_NEE_CENTRE",label:" ",type:"number",align:"right",clearValueOnDisabled:!0,decimals:0}]))),p=[{name:"NCTES",label:" ",type:"number",align:"right",decimals:"0"},{name:"NGRUPS",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_ORDINARIA_INI",label:"Of. ordinària",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEA_INI",label:"Of. NEE-A",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEB_INI",label:"Of. NEE-B",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEE_INI",label:"Of. NEE",type:"number",align:"right",decimals:"0"},{name:"OFERTA_ORDINARIA_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEA_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEEB_FIN",label:" ",type:"number",align:"right",decimals:"0"},{name:"OFERTA_NEE_FIN",label:" ",type:"number",align:"right",decimals:"0"}],A=(0,n.computed)((()=>null!==d.ID_ZONA&&null!==d.TITULARITAT?"Valors inicials Zona/Titularitat":null===d.ID_ZONA||d.TITULARITAT?d.ID_ZONA||null===d.TITULARITAT?"Valors inicials":"Valors inicials titularitat":"Valors inicials de la zona")),I=(0,n.computed)((()=>null!==d.ID_ZONA&&null!==d.TITULARITAT?"+/- a cada grup de la zona i titularitat":null===d.ID_ZONA||d.TITULARITAT?d.ID_ZONA||null===d.TITULARITAT?"A cada centre":"+/- a cada grup d'aquesta titularitat":"+/- a cada grup de la zona")),N=(0,n.computed)((()=>null!==d.ID_ZONA&&null!==d.TITULARITAT?"+/- a cada centre de la zona i titularitat":null===d.ID_ZONA||d.TITULARITAT?d.ID_ZONA||null===d.TITULARITAT?"A cada centre":"+/- a cada centre centres d'aquesta titularitat":"+/- a cada centre de la zona")),y=(0,n.computed)((()=>null!==d.ID_ZONA&&null!==d.TITULARITAT?"Resultat Zona/Titularitat":null===d.ID_ZONA||d.TITULARITAT?d.ID_ZONA||null===d.TITULARITAT?"Resultat":"Resultat Titularitat":"Resultat Zona"));async function C(){const e=await xe("GEDAC_OFERTA_EDUCATIVA",{$apply:`filter(${a.entity.ID_ZONA&&a.entity.TITULARITAT?`ID_ZONA eq ${a.entity.ID_ZONA} and TITULARITAT eq '${a.entity.TITULARITAT}'`:a.entity.TITULARITAT?`TITULARITAT eq '${a.entity.TITULARITAT}'`:a.entity.ID_ZONA?`ID_ZONA eq ${a.entity.ID_ZONA}`:"ID_CENTRE eq 0"} and ID_NIVELL eq ${s})/aggregate($count as N,GRUPS with sum as GRUPS, OFERTA_ORDINARIA with sum as OFERTA_ORDINARIA, OFERTA_NEEA with sum as OFERTA_NEEA, OFERTA_NEEB with sum as OFERTA_NEEB, OFERTA_NEE with sum as OFERTA_NEE)`});1===e.value.length?(d.NCTES=e.value[0].N,d.NGRUPS=e.value[0].GRUPS||0,d.OFERTA_ORDINARIA_INI=e.value[0].OFERTA_ORDINARIA||0,d.OFERTA_NEEA_INI=e.value[0].OFERTA_NEEA||0,d.OFERTA_NEEB_INI=e.value[0].OFERTA_NEEB||0,d.OFERTA_NEE_INI=e.value[0].OFERTA_NEE||0):(d.NCTES=0,d.NGRUPS=0,d.OFERTA_ORDINARIA_INI=0,d.OFERTA_NEEA_INI=0,d.OFERTA_NEEB_INI=0,d.OFERTA_NEE_INI=0),f()}function f(){d.OFERTA_ORDINARIA_FIN=d.OFERTA_ORDINARIA_INI+(a.entity.MODIFICACIO_ORDINARIA_CENTRE||0)*d.NCTES+(a.entity.MODIFICACIO_ORDINARIA_GRUP||0)*d.NGRUPS,d.OFERTA_NEEA_FIN=d.OFERTA_NEEA_INI+(a.entity.MODIFICACIO_NEEA_CENTRE||0)*d.NCTES+(a.entity.MODIFICACIO_NEEA_GRUP||0)*d.NGRUPS,d.OFERTA_NEEB_FIN=d.OFERTA_NEEB_INI+(a.entity.MODIFICACIO_NEEB_CENTRE||0)*d.NCTES+(a.entity.MODIFICACIO_NEEB_GRUP||0)*d.NGRUPS,d.OFERTA_NEE_FIN=d.OFERTA_NEEA_FIN+d.OFERTA_NEEB_FIN,t("change",(e=>{e.MODIFICACIO_NEE_CENTRE=(a.entity.MODIFICACIO_NEEA_CENTRE||0)+(a.entity.MODIFICACIO_NEEB_CENTRE||0),e.MODIFICACIO_NEE_GRUP=(a.entity.MODIFICACIO_NEEA_GRUP||0)+(a.entity.MODIFICACIO_NEEB_GRUP||0)}))}return(a,l)=>{const o=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ln,[(0,n.createVNode)(o,{style:{"grid-area":"INICIAL","margin-top":"31px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(A)),1)])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"NUM","margin-top":"31px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Nº Ctes/Grups ")])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"ACTUALG","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(I)),1)])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"ACTUALC","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(N)),1)])),_:1}),(0,n.createVNode)(o,{style:{"grid-area":"FINAL","margin-top":"18px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(y)),1)])),_:1}),(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(E),entity:e.entity,validations:e.validations,"cache-name":i,onChange:l[0]||(l[0]=e=>t("change",e.action))},null,8,["fields","entity","validations"]),((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p,(e=>(0,n.createVNode)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[e.type].formField),{style:(0,n.normalizeStyle)({gridArea:e.name}),key:e.name,entity:d,field:e,disabled:""},null,8,["style","entity","field"]))),64))])}}},rn=(0,R.Z)(on,[["__scopeId","data-v-350daae2"]]);async function sn(e,t,a,n){const l=T(),i=he();i.confirm({title:"Modificació de permisos",message:n,accept:async()=>{const n=await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt},body:JSON.stringify({opcio:a})}),o=await n.json();200===n.status?i.alert({title:"Modificació de permisos",message:o}):i.alert({title:"Modificació de permisos",message:"Error inesperat."}),e.push({path:"/AANEE_USUARI",query:{...t.query,reload:!0},reload:!0})}})}function dn(e){return e=>{e.OFERTA_NEE=e.OFERTA_NEEA+e.OFERTA_NEEB}}const un={component:"auto",class:"GEDAC_OFERTA_EDUCATIVA-editItem-layout",maxWidth:"660px",withClass:function(e,t){if(["ALUMNES_ASSIGNATS_ORDINARIS","ALUMNES_ASSIGNATS_NEEA","ALUMNES_ASSIGNATS_NEEB","ALUMNES_ASSIGNATS_NEE"].includes(e.name))switch(e.name){case"ALUMNES_ASSIGNATS_ORDINARIS":return t.ALUMNES_ASSIGNATS_ORDINARIS<=t.OFERTA_ORDINARIA?"avaluacioValid":"avaluacioInvalid";case"ALUMNES_ASSIGNATS_NEEA":case"ALUMNES_ASSIGNATS_NEEB":case"ALUMNES_ASSIGNATS_NEE":return t.ALUMNES_ASSIGNATS_NEEA<=t.OFERTA_NEEA?"avaluacioValid":"avaluacioInvalid"}},fields:e=>["ID_ETAPA","ID_ZONA","CODI_CENTRE","NOM_CENTRE","GRUPS","OFERTA_ORDINARIA",{name:"NIVELL",label:"Nivell"},{name:"OFERTA_NEEA",onChange:dn},{name:"OFERTA_NEEB",onChange:dn},"OFERTA_NEE","DEMANDA_1OPCIO_ORDINARIA","DEMANDA_1OPCIO_NEEA","DEMANDA_1OPCIO_NEEB","DEMANDA_1OPCIO_NEE","DEMANDA_1OPCIO","DEMANDA_1OPCIO_ADSCRITS_ORDINARIA","DEMANDA_1OPCIO_ADSCRITS_NEEA","DEMANDA_1OPCIO_ADSCRITS_NEEB","DEMANDA_1OPCIO_ADSCRITS_NEE","DEMANDA_1OPCIO_ADSCRITS","ASSIGNATS_ORDINARIS","ASSIGNATS_NEEA","ASSIGNATS_NEEB","ASSIGNATS_NEE","ASSIGNATS","ASSIGNATS_MANUAL_ORDINARIS","ASSIGNATS_MANUAL_NEEA","ASSIGNATS_MANUAL_NEEB","ASSIGNATS_MANUAL_NEE","ASSIGNATS_MANUAL","ASSIGNATS_1OPCIO","ASSIGNATS_1OPCIO_ORDINARIS","ASSIGNATS_1OPCIO_NEEA","ASSIGNATS_1OPCIO_NEEB","ASSIGNATS_1OPCIO_NEE","ASSIGNATS_1OPCIO","ASSIGNATS_1OPCIO_ADSCRITS","ASSIGNATS_OFICI_NEEA","ASSIGNATS_OFICI_NEEB","ASSIGNATS_OFICI_NEE","ASSIGNATS_OFICI"],rules:[]},cn={name:"RAV_ESTAT",label:"Estats RAV",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ESTAT_RAV",label:"Estat RAV",type:"string",defaultField:!0,required:!0,maxlength:40}]},mn=[ga,Sa,ba,va,Ra,ha,{name:"AANEE_OFERTA_NEE",type:"listJoined",label:"Oferta NEE",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_CENTRE",label:"Centre",type:"dictionary",entityName:"GEN_CENTRE",required:!0},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL"},{name:"OFERTA_NEE_A_INI",label:"Oferta NEE-A inic.",type:"number"},{name:"OFERTA_NEE_B_INI",label:"Oferta NEE-B inic.",type:"number"},{name:"OFERTA_NEE_A",label:"Oferta NEE-A",type:"number"},{name:"OFERTA_NEE_B",label:"Oferta NEE-B",type:"number"},{name:"ASSIGNATS_MANUAL_NEEA",label:"Assig manual NEE-A",disabled:!0,type:"number"},{name:"ASSIGNATS_1OPCIO_NEEA",label:"Assig. 1a  opcio NEE-A",disabled:!0,type:"number"},{name:"ASSIGNATS_2OPCIO_NEEA",label:"Assig. 2a  opcio NEE-A",disabled:!0,type:"number"},{name:"ASSIGNATS_RESTA_NEEA",label:"Assig. resta NEE-A",disabled:!0,type:"number"},{name:"ASSIGNATS_OFICI_NEEA",label:"Assig. ofici NEE-A",disabled:!0,type:"number"},{name:"ASSIGNATS_NEEA",label:"Total assig. NEE-A",type:"number"},{name:"NOASSIGNATS_NEEA",label:"Demanda NEE-A sense assignar",disabled:!0,type:"number"},{name:"ASSIGNATS_MANUAL_NEEB",label:"Assig manual NEE-B",type:"number"},{name:"ASSIGNATS_1OPCIO_NEEB",label:"Assig. 1a  opcio NEE-B",disabled:!0,type:"number"},{name:"ASSIGNATS_2OPCIO_NEEB",label:"Assig. 2a  opcio NEE-B",type:"number"},{name:"ASSIGNATS_RESTA_NEEB",label:"Assig. resta NEE-B",disabled:!0,type:"number"},{name:"ASSIGNATS_OFICI_NEEB",label:"Assig. ofici NEE-B",type:"number"},{name:"ASSIGNATS_NEEB",label:"Total assig. NEE-B",disabled:!0,type:"number"},{name:"NOASSIGNATS_NEEB",label:"Demanda NEE-B sense assignar",disabled:!0,type:"number"},{name:"ASSIGNATS_NEE",label:"Total assig. NEE",disabled:!0,type:"number"},{name:"PLACES_MANQUEN_NEEA",label:"Places manquen NEE-A",disabled:!0,type:"number"},{name:"PLACES_MANQUEN_NEEB",label:"Places manquen NEE-B",disabled:!0,type:"number"},{name:"PLACES_MANQUEN_NEEB",label:"Places manquen NEE-B",disabled:!0,type:"number"},{name:"PLACES_MANQUEN_NEE",label:"Places manquen NEE",disabled:!0,type:"number"},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"ID_CENTRE",operation:"eq"},{name:"ID_NIVELL",operation:"eq"}],permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},{name:"AANEE_ORIGEN_INFORMACIO",label:"Orígens de dades",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ORIGEN_INFORMACIO",label:"Font de les dades",type:"string",defaultField:!0,required:!0,maxlength:40}]},Za,an,{name:"AANEE_SIMULACIO_OFERTA",type:"listSplitted",label:"Modificació Oferta simulacions",form:{entityName:"AANEE_SIMULACIO_OFERTA",component:(0,n.markRaw)(rn),maxWidth:"900px"},fields:nn},{name:"AANEE_USUARI",type:"listSplitted",label:"Usuaris",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"LOGIN_USUARI",label:"Login usuari",type:"string",required:!0,maxlength:16},{name:"COGNOMSINOM_USUARI",label:"Cognoms i nom",type:"string",required:!0,maxlength:80},{name:"EMAIL_USUARI",label:"Email usuari",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,required:!0,maxlength:80},{name:"ROL",label:"Rol",type:"choice",options:g.rols,required:!0},{name:"ID_EAP",label:"EAP",type:"dictionary",entityName:"GEN_EAP"},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"LOGIN_USUARI",label:"Login conté",operation:"contains"},{name:"COGNOMSINOM_USUARI",label:"Cognoms i nom contenen",operation:"contains"},{name:"EMAIL_USUARI",label:"eMail conté",operation:"contains"},{name:"ROL",label:"Rol igual a",operation:"in"}],form:{component:"auto",class:"AANEE_USUARI-editItem-layout",maxWidth:"900px",fields:e=>["LOGIN_USUARI","COGNOMSINOM_USUARI","ROL",{name:"ID_EAP",required:"EAP"===e.ROL,disabled:"EAP"!==e.ROL,clearValueOnDisabled:!0},"EMAIL_USUARI"],rules:[async e=>await tn("AANEE_USUARI",e,["LOGIN_USUARI","COGNOMSINOM_USUARI","EMAIL_USUARI"],"or")]},menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)(),l=t?[]:[{text:"Canviar permisos EAPs",icon:"SwitchUser",children:[{text:"Assignar permisos de lectura",icon:"ReadingMode",action:()=>sn(a,n,"eaplectura","Assignar permisos de lectura als usuaris amb rol EAP ?")},{text:"Assignar permisos d'escriptura",icon:"OpenEnrollment",action:()=>sn(a,n,"eapescriptura","Assignar permisos d'escriptura als usuaris amb rol EAP ?")}]},{text:"Canviar permisos S.Socials",icon:"SwitchUser",children:[{text:"Assignar permisos de lectura",icon:"OpenEnrollment",action:()=>sn(a,n,"sslectura","Assignar permisos de lectura als usuaris amb rol Serveis Socials ?")},{text:"Assignar permisos d'escriptura",icon:"Handwriting",action:()=>sn(a,n,"ssescriptura","Assignar permisos d'escriptura als usuaris amb rol Serveis Socials ?")}]}];return e.concat(l)}},{name:"GEDAC_ALUMNE",type:"listSplitted",label:"Dades personals preinscripcions",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"NUM_SOLICITUD",type:"string",label:"Codi sol·licitud"},{name:"ESTAT_SOLICITUD",type:"string",label:"Estat sol·licitud"},{name:"IDALU_GEDAC",type:"string",label:"IDALU GEDAC"},{name:"IDALU",type:"string",label:"IDALU GEDAC o cercat"},{name:"ESTAT_IDALU",label:"Estat IDALU",type:"choice",options:g.EstatIdaluGedac},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL"},{name:"ID_CENTRE_1AOPCIO",label:"Centre 1a opció (GEDAC)",type:"lookup",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"CODI_CENTRE_1AOPCIO",label:"Codi Centre 1a opció",type:"string"},{name:"TITULARITAT_CENTRE_1AOPCIO",label:"Titularitat centre 1a op.",type:"string"},{name:"ID_CENTRE_PROCEDENCIA",label:"Centre procedència  (GEDAC)",type:"lookup",entity:{name:"GEN_CENTRE",primaryKey:"ID",targetKey:"CODIINOM_CENTRE"}},{name:"CODI_CENTRE_PROCEDENCIA",label:"Codi Centre procedència  (GEDAC)",type:"string"},{name:"TITULARITAT_CENTRE_PROCEDENCIA",label:"Titularitat centre procedència",type:"string"},{name:"TIPUS_ALUMNE",label:"Tipus alumne",type:"choice",options:g.tipusAlumneGEDAC},{name:"NOM",type:"string",label:"Nom alumne"},{name:"COGNOM1",type:"string",label:"1r cognom"},{name:"COGNOM2",type:"string",label:"2n cognom"},{name:"IDENTIFICACIO_FISCAL",type:"string",label:"Id. fiscal"},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",required:!0,entityName:"GEN_NIVELL"},{name:"DATA_NAIXEMENT",type:"date",label:"D.Naixement"},{name:"ADRECA_RESIDENCIA",type:"string",label:"Adreça"},{name:"CP_RESIDENCIA",type:"string",label:"C.Postal"},{name:"MUNICIPI_RESIDENCIA",type:"string",label:"Municipi residència"},{name:"TELEFON",type:"string",label:"Telèfon"},{name:"EMAIL",type:"string",label:"e.mail"},{name:"NOM_TUTOR1",type:"string",label:"Nom 1r tutor"},{name:"COGNOM1_TUTOR1",type:"string",label:"1r cognom 1r tutor"},{name:"COGNOM2_TUTOR1",type:"string",label:"2n cognom 1r tutor"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",type:"string",label:"Id. fiscal 1r tutor"},{name:"NOM_TUTOR2",type:"string",label:"Nom 2n tutor"},{name:"COGNOM1_TUTOR2",type:"string",label:"1r cognom 2n tutor"},{name:"COGNOM2_TUTOR2",type:"string",label:"2n cognom 2n tutor"},{name:"IDENTIFICACIO_FISCAL_TUTOR2",type:"string",label:"Id. fiscal 2n tutor"},{name:"COGNOMSINOM",type:"string",label:"Cognoms i nom"}],filter:[{name:"IDALU_GEDAC",operation:"in"},{name:"IDALU",operation:"in"},{name:"TIPUS_ALUMNE",operation:"in"},{name:"ID_NIVELL",operation:"in"},{name:"ESTAT_IDALU",operation:"in"},{name:"NUM_SOLICITUD",operation:"eq"},{name:"NOM",label:"Nom conté",operation:"contains"},{name:"COGNOM1",label:"1r cognom conté",operation:"contains"}],menuUpdater:function(e,t){const a=(0,r.useRouter)(),n=(0,r.useRoute)();return t?[{value:"idalu",text:t.IDALU?"Verificar IDALU en el RALC":"Cercar IDALU en el RALC",icon:"FollowUser",action:()=>a.push({path:"/findidalus",query:{listname:"GEDAC_ALUMNE",title:t.IDALU?"Verificar IDALU en el RALC":"Cercar IDALU en el RALC",filter:`ID eq ${t.ID}`,return:n.fullPath}})}]:[{value:"idalu",text:"Cercar o verificar IDALU",icon:"FollowUser",children:[{value:"tots",text:"Cercar preinscripcions sense IDALU",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"GEDAC_ALUMNE",filter:"IDALU eq null",title:"Preinscripcions sense IDALU",return:n.fullPath}})},{value:"tots",text:"Cercar els alumnes seleccionats sense IDALU",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"GEDAC_ALUMNE",filter:"IDALU eq null"+(n.query.filter?" and "+n.query.filter:""),title:"Preinscripcions sense IDALU",return:n.fullPath}})},{value:"nocercats",text:"Cercar els alumnes seleccionats no cercats",icon:"Search",action:()=>a.push({path:"/findidalus",query:{listname:"GEDAC_ALUMNE",title:"Preinscripcions no cercades",filter:"IDALU eq null and IDALU_NOCERCAR ne true "+(n.query.filter?" and "+n.query.filter:""),return:n.fullPath}})}]},{value:"postGEDAC",text:"Post Càrrega D.personals",icon:"Calculator",action:async function(){const e=T(),t=he();t.loadStart("Actualitzant les dades personals de GEDAC");const a=await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:e.jwt},body:JSON.stringify({opcio:"postGedac"})});t.loadEnd("Actualitzant les dades personals de GEDAC"),200===a.status?t.alert({title:"Post procés càrrega Dades Personals",message:"Procés finalitzat"}):t.alert({title:"Post procés càrrega Dades Personals",message:"Error inesperat."})}},{value:"insertAANEE",text:"Altes a AANEE des de GEDAC",icon:"Add",children:[{value:"altaA",text:"Preinscripcions NEE-A sense IDALU",action:async function(){const e=T(),t=await fetch(`${m}/Stored/PR_AANEE_PostInsert_AANEE_A_fromGEDAC`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:e.jwt}}),a=he();200===t.status?a.alert({title:"Preinscripcions afegides a AANEE",message:"Procés finalitzat"}):a.alert({title:"Preinscripcions afegides a AANEE",message:"Error de comunicació"})}},{value:"altaB",text:"Preinscripcions NEE-B i Ordinàries sense IDALU",action:async function(){const e=T(),t=await fetch(`${m}/Stored/PR_AANEE_PostInsert_AANEE_B_fromGEDAC`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:e.jwt}}),a=he();200===t.status?a.alert({title:"Ppreinscripcions afegides a AANEE",message:"Procés finalitzat"}):a.alert({title:"Preinscripcions afegides a AANEE",message:"Error de comunicació"})}}]},{value:"lligamAANEE",text:"Cercar lligam amb AANEE",icon:"Search",children:[{value:"lligam",text:"Preinscripcions no lligades a AANEE",action:()=>a.push({path:"/lligamAanee",query:{title:"Preinscripcions no lligades a AANEE",filter:"and ESTAT_SOLICITUD ne 'tancada'",return:n.fullPath}})},{value:"lligam",text:"Preinscripcions seleccionades no lligades amb AANEE",action:()=>a.push({path:"/lligamAanee",query:{title:"Preinscripcions seleccionades no lligades amb AANEE",filter:n.query.filter?"and ESTAT_SOLICITUD ne 'tancada' and "+n.query.filter:"and ESTAT_SOLICITUD ne 'tancada'",return:n.fullPath}})}]},{value:"lligamRAV",text:"Cercar lligam amb RAV",icon:"Search",children:[{value:"lligam",text:"Preinscripcions no lligades a RAV",action:()=>a.push({path:"/lligamRav",query:{title:"Preinscripcions no lligades a RAV",listName:"GEDAC_ALUMNE",filter:n.query.filter,return:n.fullPath}})},{value:"lligam",text:"Cercar alumnes seleccionats no lligats amb el RAV",action:()=>a.push({path:"/lligamRav",query:{title:"Cercar alumnes seleccionats no lligats amb el RAV",listName:"GEDAC_ALUMNE",filter:n.query.filter,return:n.fullPath}})}]}]},permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},{name:"GEDAC_OFERTA_EDUCATIVA",type:"listSplitted",label:"Oferta educativa GEDAC",pageSize:parseInt(localStorage.getItem("ofertaEditPageRows")||60),fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_CENTRE",type:"dictionary",entityName:"GEN_CENTRE",disabled:!0},{name:"CODI_CENTRE",label:"Codi Centre",type:"string",disabled:!0,gridColumn:{width:"100px"}},{name:"NOM_CENTRE",type:"string",disabled:!0,label:"Nom centre",gridColumn:{width:"160px"}},{name:"CODIINOM_CENTRE",label:"Codi i nom centre",type:"string",defaultField:!0,readonly:!0,gridColumn:{width:"240px"}},{name:"NOMICODI_CENTRE",label:"Nom i codi del centre",type:"string",readonly:!0,gridColumn:{width:"240px"}},{name:"ID_NIVELL",label:"Nivell",disabled:!0,type:"dictionary",entityName:"GEN_NIVELL",gridColumn:{width:"90px"}},{name:"NIVELL",type:"string",disabled:!0,gridColumn:{width:"90px"}},{name:"ID_ETAPA",label:"Etapa",type:"dictionary",disabled:!0,entityName:"GEN_ETAPA",gridColumn:{width:"100px"}},{name:"ID_DISTRICTE",label:"Districte",type:"lookupCache",disabled:!0,entityName:"GEN_DISTRICTE",entity:{name:"GEN_DISTRICTE",primaryKey:"ID",targetKey:"DISTRICTE"},gridColumn:{width:"90px"}},{name:"ID_ZONA",label:"Zona",type:"lookupCache",disabled:!0,entityName:"GEN_ZONA",entity:{name:"GEN_ZONA",primaryKey:"ID",targetKey:"CODI_ZONA"},gridColumn:{width:"90px"}},{name:"GRUPS",type:"number",align:"right",label:"Grups",detailsColumn:{align:"right"},gridColumn:{width:"51px"}},{name:"PLACES_INICIALS_ORDINARIES",type:"number",align:"right",disabled:!0,label:"Places inic. ord.",detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"PLACES_INICIALS_NEE",type:"number",align:"right",disabled:!0,label:"Places inic. NEE",detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"PREVISSIO_PROMOCIO_ORDINARIA",type:"number",align:"right",label:"Prev. promoció ordinària",disabled:!0,detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"PREVISSIO_PROMOCIO_NEE",type:"number",disabled:!0,align:"right",label:"Prev. promoció NEE",detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"PREVISSIO_REPETIDORS_ORDINARIA",type:"number",disabled:!0,align:"right",label:"Prev. repet. ordinària",decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"PREVISSIO_REPETIDORS_NEE",type:"number",disabled:!0,align:"right",label:"Prev. repet. NEE",decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"100px"}},{name:"OFERTA_ORDINARIA",type:"number",align:"right",label:"Of. ord.",decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"right"},gridColumn:{width:"75px"}},{name:"OFERTA_NEEA",type:"number",align:"right",label:"Of. NEE-A",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"right"},gridColumn:{width:"84px"}},{name:"OFERTA_NEEB",type:"number",align:"right",label:"Of. NEE-B",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"right"},gridColumn:{width:"87px"}},{name:"OFERTA_NEE",type:"number",align:"right",disabled:!0,label:"Of. NEE",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"right"},gridColumn:{width:"87px"}},{name:"DEMANDA_1OPCIO_NEEA",type:"numberStyled",align:"right",disabled:!0,label:"Dem. NEE-A",min:0,decimals:0,detailsColumn:{align:"right"},setStyle:e=>(e.OFERTA_NEEA||0)>=(e.DEMANDA_1OPCIO_NEEA||0)?{color:"green"}:{color:"red",fontStyle:"bold"},gridColumn:{width:"90px"}},{name:"DEMANDA_1OPCIO_NEEB",type:"numberStyled",align:"right",disabled:!0,label:"Dem. NEE-B",min:0,decimals:0,detailsColumn:{align:"right"},setStyle:e=>(e.OFERTA_NEEB||0)>=(e.DEMANDA_1OPCIO_NEEB||0)?{color:"green"}:{color:"red",fontStyle:"bold"},gridColumn:{width:"90px"}},{name:"DEMANDA_1OPCIO_NEE",type:"numberStyled",align:"right",disabled:!0,label:"Dem. NEE",min:0,decimals:0,detailsColumn:{align:"right"},setStyle:e=>(e.OFERTA_NEE||0)>=(e.DEMANDA_1OPCIO_NEE||0)?{color:"green"}:{color:"red",fontStyle:"bold"},gridColumn:{width:"90px"}},{name:"DEMANDA_1OPCIO_ADSCRITS_NEEA",type:"number",align:"right",disabled:!0,label:"Dem. Ads. NEE-A",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"113px"}},{name:"DEMANDA_1OPCIO_ADSCRITS_NEEB",type:"number",align:"right",disabled:!0,label:"Dem. Ads. NEE-B",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"113px"}},{name:"DEMANDA_1OPCIO_ADSCRITS_NEE",type:"number",align:"right",disabled:!0,label:"Dem. Ads. NEE",min:0,decimals:0,detailsColumn:{align:"right"},setStyle:e=>(e.ASSIGNATS_ORDINARIS||0)<=(e.DEMANDA_1OPCIO_ADSCRITS||0)?{color:"green"}:{color:"red",fontStyle:"bold"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_NEEA",type:"numberStyled",align:"right",disabled:!0,label:"Ass. NEE-A",min:0,decimals:0,setStyle:e=>(e.OFERTA_NEEA||0)>=(e.ASSIGNATS_NEEA||0)?{color:"green"}:{color:"red",fontStyle:"bold"},detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_NEEB",type:"numberStyled",align:"right",disabled:!0,label:"Ass. NEE-B",min:0,decimals:0,setStyle:e=>(e.OFERTA_NEEB||0)>=(e.ASSIGNATS_NEEB||0)?{color:"green"}:{color:"red",fontStyle:"bold"},detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_NEE",type:"number",align:"right",disabled:!0,label:"Ass. NEE",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_MANUAL_NEEA",type:"number",align:"right",disabled:!0,label:"Ass. manuals NEE-A",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_MANUAL_NEEB",type:"number",align:"right",disabled:!0,label:"Ass. manuals NEE-B",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_MANUAL_NEE",type:"number",align:"right",disabled:!0,label:"Ass. manuals NEE",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_1OPCIO_NEEA",type:"number",align:"right",disabled:!0,label:"Ass. 1a opció NEE-A",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_1OPCIO_NEEB",type:"number",align:"right",disabled:!0,label:"Ass. 1a opció NEE-B",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_1OPCIO_NEE",type:"number",align:"right",disabled:!0,label:"Ass. 1a opció NEE",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"90px"}},{name:"ASSIGNATS_OFICI_NEEA",type:"number",align:"right",disabled:!0,label:"Ass. Of. NEE-A",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"102px"}},{name:"ASSIGNATS_OFICI_NEEB",type:"number",align:"right",disabled:!0,label:"Ass. Of. NEE-B",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"102px"}},{name:"ASSIGNATS_OFICI_NEE",type:"number",align:"right",disabled:!0,label:"Ass. Of. NEE",min:0,decimals:0,detailsColumn:{align:"right"},gridColumn:{width:"102px"}},{name:"EXCES_DEMANDA_NEEA",type:"boolean",label:"Demanda > ofe. NEE-A",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}},{name:"EXCES_DEMANDA_NEEB",type:"boolean",label:"Demanda > ofe. NEE-B",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}},{name:"EXCES_DEMANDA_NEE",type:"boolean",label:"Demanda NEE-A > Ofe. NEE-A o Demanda NEE-B > Ofe. NEE-B",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}},{name:"EXCES_ASSIGNATS_NEEA",type:"boolean",label:"Assignacions > ofe. NEE-A",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}},{name:"EXCES_ASSIGNATS_NEEB",type:"boolean",label:"Assignacions > ofe. NEE-B",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}},{name:"EXCES_ASSIGNATS_NEE",type:"boolean",label:"Assignacions NEE-A > ofe. NEE-A o Assig. NEE-B > ofe.NEE-B",min:0,decimals:0,loadAlwaysInView:!0,detailsColumn:{align:"center"},gridColumn:{align:"center",width:"96px"}}],filter:[{name:"ID_ETAPA",operation:"in"},{name:"ID_NIVELL",operation:"in"},{name:"ID_DISTRICTE",operation:"in"},{name:"ID_ZONA",operation:"in"},{name:"CODI_CENTRE",label:"Codi Centre conté",operation:"contains"},{name:"NOM_CENTRE",label:"Nom del centre conté",operation:"contains"},{name:"EXCES_DEMANDA_ORDINARIA",operation:"eq"},{name:"EXCES_DEMANDA_NEEA",operation:"eq"},{name:"EXCES_DEMANDA_NEEB",operation:"eq"},{name:"EXCES_DEMANDA_NEE",operation:"eq"},{name:"EXCES_DEMANDA",operation:"eq"},{name:"EXCES_ASSIGNATS_NEEA",operation:"eq"},{name:"EXCES_ASSIGNATS_NEEB",operation:"eq"},{name:"EXCES_ASSIGNATS_NEE",operation:"eq"}],form:un,permissionDenied:e=>({create:!0,edit:!1,delete:!0,export:!1})},{name:"RALC_HISTORIC_ALUMNE",type:"listSplitted",label:"Registres d'alumnes (RALC)",fields:[{name:"IDALU",type:"string",label:"IDALU",primary:!0},{name:"NOM",type:"string",label:"Nom alumne"},{name:"NOM_FINDIDALUS",type:"string",label:"Nom findIdalus alumne"},{name:"COGNOM1",type:"string",label:"1r cognom"},{name:"COGNOM1_FINDIDALUS",type:"string",label:"1r cognom findIdalus"},{name:"COGNOM2",type:"string",label:"2n cognom"},{name:"COGNOM2_FINDIDALUS",type:"string",label:"2n cognom findIdalus"},{name:"DATA_NAIXEMENT",type:"date",label:"D.Naixement"},{name:"ANY_NAIXEMENT",type:"number",label:"Any Naixement",decimals:0},{name:"TIPUS_DOCUMENT",type:"string",label:"Tipus document"},{name:"IDENTIFICACIO_FISCAL",type:"string",label:"Id. fiscal"},{name:"CP_RESIDENCIA",type:"string",label:"Codi Postal"},{name:"VIU_A_BCN",type:"boolean",label:"Viu a BCN"},{name:"ESTUDIA_BCN",type:"boolean",label:"Estudia a BCN"},{name:"HA_VISCUT_BCN",type:"boolean",label:"Ha viscut a BCN"},{name:"HA_ESTUDIAT_BCN",type:"boolean",label:"Ha estudiat a BCN"},{name:"NOM_TUTOR1",type:"string",label:"Nom 1r tutor"},{name:"COGNOM1_TUTOR1",type:"string",label:"Cognom 1r tutor"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",type:"string",label:"Id.fiscal 1r tutor"},{name:"NOM_TUTOR2",type:"string",label:"Nom 2n tutor"},{name:"COGNOM1_TUTOR2",type:"string",label:"Cognom 2n tutor"},{name:"IDENTIFICACIO_FISCAL_TUTOR2",type:"string",label:"Id.fiscal 2n tutor"}],filter:[{name:"ID_IDALU",operation:"eq"},{name:"NOM",label:"Nom conté",operation:"contains"},{name:"COGNOM1",label:"1r cognom conté",operation:"contains"},{name:"COGNOM2",label:"2n cognom conté",operation:"contains"},{name:"IDENTIFICACIO_FISCAL",operation:"eq"},{name:"ANY_NAIXEMENT",operation:"eq"}],permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},{name:"GEN_CENTRE",type:"dictionary",label:"Llista de centres",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI_CENTRE",label:"Codi",type:"string",maxlength:8,required:!0},{name:"NOM_CENTRE",label:"Nom centre",type:"string",required:!0,maxlength:80},{name:"CODIINOM_CENTRE",label:"Codi i nom centre",type:"string",defaultField:!0,readonly:!0},{name:"NOMICODI_CENTRE",label:"Nom i codi del centre",type:"string",readonly:!0}]},{name:"GEN_DISTRICTE",label:"Districtes de Barcelona",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"DISTRICTE",label:"Districte",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"GEN_EAP",label:"Eaps",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI",label:"Codi EAP",type:"string",required:!0,maxlength:8},{name:"NOM",label:"Etapa",type:"string",defaultField:!0,required:!0,maxlength:100},{name:"ID_DISTRICTE",label:"Districte",type:"dictionary",dataType:"number",entityName:"GEN_DISTRICTE"}]},{name:"GEN_ETAPA",label:"Etapes educatives",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ETAPA",label:"Etapa",type:"string",defaultField:!0,required:!0,maxlength:24}]},{name:"GEN_MOTIU_NESE",label:"Motius NESE",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"MOTIU_NESE",label:"Motiu NESE",type:"string",defaultField:!0,required:!0,maxlength:80}]},{name:"GEN_NIVELL",label:"Nivells",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"NIVELL",label:"Nivell",type:"string",defaultField:!0,required:!0,maxlength:30},{name:"CODI_ENSENYAMENT",label:"Codi ensenyament",type:"string",maxlength:30},{name:"NIVELL_RALC",label:"Curs",type:"number",decimals:0}]},{name:"RAV_ALUMNE",type:"listJoined",label:"Alumnes RAV",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"IDALU",label:"IDALU",type:"string"},{name:"DATA_LLIGAM_IDALU",label:"Lligam IDALU",type:"date"},{name:"LLIGAM_IDALU",label:"Llligam IDALU",type:"string"},{name:"ID_NIVELL",label:"Nivell",type:"dictionary",dataType:"number",entityName:"GEN_NIVELL"},{name:"NOM",label:"Nom alumne",type:"string"},{name:"COGNOM1",label:"1r cognom alumne",type:"string"},{name:"COGNOM2",label:"2n cognom alumne",type:"string"},{name:"IDENTIFICACIO_FISCAL",label:"Id. fiscal alumne",type:"string"},{name:"DATA_NAIXEMENT",label:"D. Naixement",type:"date"},{name:"CP_RESIDENCIA",label:"Codi Postal",type:"string"},{name:"NOM_TUTOR1",label:"Nom 1r tutor",type:"string"},{name:"COGNOM1_TUTOR1",label:"1r Cognom 1r tutor",type:"string"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",label:"Id. fiscal 1r tutor",type:"string"},{name:"NOM_TUTOR2",label:"Nom 2nr tutor",type:"string"},{name:"COGNOM1_TUTOR2",label:"1r Cognom 2n tutor",type:"string"},{name:"IDENTIFICACIO_FISCAL_TUTOR2",label:"Id. fiscal 2n tutor",type:"string"},{name:"TELEFON",label:"Telèfon",type:"string"},{name:"EMAIL",label:"eMail",type:"string"},{name:"ID_MOTIU_VULNERABIITAT",label:"Motiu Vulnerable",type:"dictionary",entityName:"RAV_MOTIU_VULNERABILITAT"},{name:"ID_ESTAT_VULNERABLE",label:"Estat vulnerable",type:"dictionary",entityName:"RAV_ESTAT_VULNERABLE",disabled:!0},{name:"ID_ESTAT_PLAXOC",label:"Estat pla de xoc",type:"dictionary",entityName:"RAV_ESTAT_PLAXOC",disabled:!0},{name:"ID_ESTAT_RAV",label:"Estat RAV",type:"dictionary",entityName:"RAV_ESTAT",disabled:!0},{name:"VULNERABLE",label:"És vulnerable",type:"boolean"},{name:"PLADEXOC",label:"Pla de xoc",type:"boolean"},{name:"ID_ESTAT",label:"Estat",type:"choice",options:[]},{name:"ID_ESTATVULNERABLE",label:"Estat Vulnerable",type:"choice",options:[]},{name:"ID_ESTATPDX",label:"Estat Pla de xoc",type:"choice",options:[]}],filter:[{name:"IDALU",operation:"contains"},{name:"ID_NIVELL",operation:"eq"},{name:"ID_ESTAT",operation:"eq"},{name:"NOM",label:"Nom conté",operation:"contains"},{name:"COGNOM1",label:"1r cognom conté",operation:"contains"}],permissionDenied:e=>({create:!0,edit:!0,delete:!0,export:!1})},cn,cn,{name:"RAV_ESTAT_PLAXOC",label:"Estats Pla de xoc",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ESTAT_PLAXOC",label:"Estat pla de xoc",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"RAV_ESTAT_VULNERABLE",label:"Estats vulnerabilitat",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ESTAT_VULNERABLE",label:"Estat vulnerable",type:"string",defaultField:!0,required:!0,maxlength:40}]},{name:"RAV_MOTIU_VULNERABILITAT",label:"Motius vulnerabilitat",type:"dictionary",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"MOTIU",label:"Estat RAV",type:"string",defaultField:!0,required:!0,maxlength:25}]}];function En(e){return void 0===e?Array.from(mn):mn.find((t=>t.name===e))}function pn(e,t){return t.map((t=>{if("string"==typeof t){const a=e.fields.find((e=>e.name===t));return Object.assign({},a)}{const a=e.fields.find((e=>e.name===t.name));return Object.assign({},a,t)}}))}function An(e,t=null){return"asc"===(e?.direction??t)?"SortUp":"desc"===(e?.direction??t)?"SortDown":null}function In(e){return"string"==typeof e&&e?e.split(",").map((e=>{const[t,a]=e.trim().replace(/\s+/," ").split(" ");return{sentence:t,direction:a||"asc"}})):[]}function Nn(e){return e.filter((e=>["asc","desc"].includes(e.direction))).map((e=>`${e.sentence} ${e.direction}`)).join(",")||void 0}const yn={__name:"details-view-select",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},selection:{type:String,default:""},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null},pageSize:{type:Number,default:null},firstItem:{type:Number,default:1},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update:selectedItemId","update:orderby","clickCell","update:firstItem","contextmenuRow","contextmenuCell"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.find((e=>e.primary))?.name)),i=(0,n.computed)((()=>{const e=a.data.findIndex((e=>e[l.value]===a.selectedItemId));return e>-1?[e]:[]})),o=(0,n.computed)((()=>Math.min(a.firstItem+(a.pageSize-1),a.dataCount))),r=(0,n.computed)((()=>`${a.firstItem} - ${o.value}`));function s(e){if(1===e.length){const n=a.data[e[0]];t("update:selectedItemId",n[l.value])}else t("update:selectedItemId",null)}function d(e){const n=a.data[e.row];t("update:selectedItemId",n[l.value])}const u=(0,n.computed)((()=>a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Pe(e),l=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:An(l),width:e.detailsColumn?.width,align:e.detailsColumn?.align}}})).filter((e=>e)))),c=(0,n.computed)((()=>{const{pageSize:e,dataCount:t}=a;return"number"==typeof e&&"number"==typeof t}));function m(e){c.value&&e>0&&e<a.dataCount&&t("update:firstItem",e)}function E(e){m((Math.ceil(a.dataCount/a.pageSize)-1)*a.pageSize)}function p(e){const t=Number(e);!isNaN(t)&&t>0&&t<a.dataCount&&m(t)}const A=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"detailsViewSelect-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"detailsViewSelect-navBottom";default:return}})),I=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"detailsViewSelect-left";case"topCenter":case"bottomCenter":return"detailsViewSelect-center";case"topRight":case"bottomRight":return"detailsViewSelect-right";default:return}}));function N(e){const{index:n}=u.value[e],l=Pe(a.fields[n]);if(l){const n=a.orderby.map((e=>({...e}))),i=n.findIndex((e=>e.sentence===l));if(i>-1){const e=n[i];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(i,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Pe(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:l,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),i=a[1]<e?a[0]+1:a[0];n.splice(i,0,{sentence:l,direction:"asc"})}}t("update:orderby",n)}}function y({row:e,event:n}){const i=a.data[e][l.value];t("contextmenuCell",{row:e,primary:i,event:n})}function C({row:e,column:n,event:i}){const o=a.data[e][l.value];t("contextmenuCell",{row:e,column:n,primary:o,event:i})}return(t,a)=>{const l=(0,n.resolveComponent)("fura-details-list"),f=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)((0,n.unref)(A))},[(0,n.createVNode)(l,{columns:(0,n.unref)(u),data:e.data,"selected-indices":(0,n.unref)(i),"auto-layout":e.autoLayout,compact:e.compact,selection:e.selection,"sticky-header":e.stickyHeader,"sticky-header-offset":e.stickyHeaderOffset,"onUpdate:selectedIndices":s,onClickHeader:N,onClickCell:d,onContextmenuRow:y,onContextmenuCell:C},{default:(0,n.withCtx)((a=>[(0,n.renderSlot)(t.$slots,"default",{rowIndex:a.rowIndex,row:e.data[a.rowIndex],fieldIndex:a.column.index,field:e.fields[a.column.index],content:a.content},(()=>[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[a.column.type].detailsCell),{field:e.fields[a.column.index],row:e.data[a.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"header",{column:e.column,index:e.index})])),group:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"group",{group:e.group,index:e.index,isCollapsed:e.isCollapsed})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyFooter",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),_:3},8,["columns","data","selected-indices","auto-layout","compact","selection","sticky-header","sticky-header-offset"]),(0,n.unref)(c)&&(0,n.unref)(A)&&(0,n.unref)(I)&&e.data.length>0?((0,n.openBlock)(),(0,n.createBlock)(f,{key:0,class:(0,n.normalizeClass)(["detailsViewSelect-navigation",(0,n.unref)(I)]),current:(0,n.unref)(r),"current-focus":e.firstItem,total:e.dataCount.toLocaleString("IT"),"end-button":"","start-button":"",editable:"","disable-prev":e.firstItem<=1,"disable-next":(0,n.unref)(o)>=e.dataCount,"disable-start":e.firstItem<=1,"disable-end":e.firstItem+e.pageSize>=e.dataCount,onPrev:a[0]||(a[0]=t=>m(e.firstItem-e.pageSize)),onNext:a[1]||(a[1]=t=>m(e.firstItem+e.pageSize)),onStart:a[2]||(a[2]=e=>m(1)),onEnd:E,onGoTo:p},null,8,["class","current","current-focus","total","disable-prev","disable-next","disable-start","disable-end"])):(0,n.createCommentVNode)("v-if",!0)],2)}}},Cn=(0,R.Z)(yn,[["__scopeId","data-v-68c44180"]]),fn={__name:"menu-contextual",props:{items:{type:Array,default:null},positionX:{type:Number,required:!0},positionY:{type:Number,required:!0}},emits:["close"],setup(e,{expose:t,emit:a}){const l=(0,n.ref)(),i=(0,n.ref)(!1);function o(e){l.value.$el.contains(e.target)||l.value.$el===e.target||(e.preventDefault(),a("close"))}return(0,n.onMounted)((()=>window.addEventListener("click",o,!0))),(0,n.onUnmounted)((()=>window.removeEventListener("click",o,!0))),t({checkOverload:function(){i.value=l.value.checkOverload()}}),(t,a)=>{const o=(0,n.resolveComponent)("fura-block-menu");return e.items?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,ref_key:"element",ref:l,class:(0,n.normalizeClass)(["menuContextual",{overloaded:i.value}]),style:(0,n.normalizeStyle)({top:`${e.positionY}px`,left:`${e.positionX}px`}),items:e.items,onOverload:a[0]||(a[0]=e=>i.value=!0)},null,8,["class","style","items"])):(0,n.createCommentVNode)("v-if",!0)}}},_n=(0,R.Z)(fn,[["__scopeId","data-v-138761e4"]]),Tn={__name:"layout-list-details",props:{menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},menuContextual:{type:Array,default:void 0},menuContextualOpen:{type:Boolean,default:!1},fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},selection:{type:String,default:""},pageSize:{type:Number,default:null},firstItem:{type:Number,default:1},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["menuContextualOpen","menuContextualClose","update:selectedItemId","update:orderby","clickCell","update:firstItem"],setup(e,{emit:t}){const a=e,l=(0,n.ref)(),i=(0,n.ref)({});function o({primary:e,event:a}){a.preventDefault(),i.value={x:a.clientX,y:a.clientY},t("menuContextualOpen",e),(0,n.nextTick)((()=>l.value?.checkOverload()))}function r(e){a.menuContextualOpen&&t("menuContextualClose")}return(0,n.onMounted)((()=>{document.getElementById("app").addEventListener("scroll",r)})),(0,n.onUnmounted)((()=>{document.getElementById("app").removeEventListener("scroll",r)})),(a,r)=>{const s=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(s,{class:"layoutDetails-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createVNode)((0,n.unref)(Cn),{fields:e.fields,data:e.data,orderby:e.orderby,"forced-order":e.forcedOrder,"selected-item-id":e.selectedItemId,compact:"",selection:e.selection,"sticky-header":"","sticky-header-offset":44,"page-size":e.pageSize,"first-item":e.firstItem,"data-count":e.dataCount,"pagination-position":e.paginationPosition,"onUpdate:selectedItemId":r[0]||(r[0]=e=>t("update:selectedItemId",e)),"onUpdate:orderby":r[1]||(r[1]=e=>t("update:orderby",e)),onClickCell:r[2]||(r[2]=e=>t("clickCell",e)),"onUpdate:firstItem":r[3]||(r[3]=e=>t("update:firstItem",e)),onContextmenuRow:o,onContextmenuCell:o},null,8,["fields","data","orderby","forced-order","selected-item-id","selection","page-size","first-item","data-count","pagination-position"]),((0,n.openBlock)(),(0,n.createBlock)(n.Teleport,{to:"body"},[e.menuContextual&&e.menuContextualOpen?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(_n),{key:0,ref_key:"menuContextualElement",ref:l,items:e.menuContextual,"position-x":i.value.x,"position-y":i.value.y,onClose:r[4]||(r[4]=e=>t("menuContextualClose"))},null,8,["items","position-x","position-y"])):(0,n.createCommentVNode)("v-if",!0)]))],64)}}},gn=(0,R.Z)(Tn,[["__scopeId","data-v-700a86e8"]]);function On(e,{parse:t,stringify:a,handleLeave:l}={}){const i=(0,r.useRoute)(),o=(0,r.useRouter)(),s=(0,n.ref)(i.params[e]);return(0,r.onBeforeRouteUpdate)((t=>{s.value=t.params[e]})),l&&(0,r.onBeforeRouteLeave)((t=>{s.value=t.params[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(s.value):s.value,set:t=>{s.value!==t&&o.push({params:{[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}})}}function Sn(e,{parse:t,stringify:a,handleLeave:l}={}){const i=(0,r.useRoute)(),o=(0,r.useRouter)(),s=(0,n.ref)(i.query[e]);function d(t,n={}){n.value!==t&&o.push({path:i.path,query:{...i.query,...n,[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}return(0,r.onBeforeRouteUpdate)((t=>{s.value=t.query[e]})),l&&(0,r.onBeforeRouteLeave)((t=>{s.value=t.query[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(s.value):s.value,set:e=>d(e)}),[`${e}Raw`]:(0,n.readonly)(s),[`update${bn(e)}`]:d}}function bn(e){return e[0].toUpperCase()+e.substring(1)}function Dn(){const e=(0,r.useRoute)(),t=(0,r.useRouter)();return{goBack(a,l,{reload:i=!1}={}){if(e.query.return)if(i){const a=e.query.return.includes("?")?"&":"?";t.push(`${e.query.return}${a}reload=true`)}else t.push(e.query.return);else t.push({path:(0,n.unref)(a),query:{...(0,n.unref)(l)||e.query||{},reload:!0}})}}}const vn={__name:"dictionary-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=we(),o=(0,n.computed)((()=>t.list.name)),{orderby:s,updateOrderby:d}=Sn("orderby",{parse:In,stringify:Nn,handleLeave:!0}),{selectedItemId:u}=Sn("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),{page:c,updatePage:m}=Sn("page",{parse:e=>e?Number(e)-1:null,stringify:e=>null!=e?String(e+1):void 0,handleLeave:!0});(0,n.watch)(o,(e=>i.loadDictionary(e)),{immediate:!0});const E=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),p=(0,n.computed)((()=>i.data[o.value]?.length||0)),A=(0,n.computed)((()=>i.data[o.value]||[])),{sortedData:I}=na(A,s),N=(0,n.computed)((()=>{const e=c.value*E.value;return t.list?.paginated?I.value.slice(e,e+E.value):I.value})),y=(0,n.computed)((()=>{const e=t.list?.fields.find((e=>e.primary))?.name;let a=null;return e&&A.value.length>0&&(a=A.value.find((t=>t[e]===u.value))??null),t.list.permissionDenied?.(a)??{}})),C=(0,n.computed)((()=>{const e=[];return y.value.create||e.push({text:"Nou",icon:"Add",action:()=>l.push({path:`/${o.value}/create`,query:{return:a.fullPath}})}),null!=u.value&&(y.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>l.push({path:`/${o.value}/edit/${u.value}`,query:{return:a.fullPath}})}),y.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>l.push({path:`/${o.value}/delete/${u.value}`,query:{return:a.fullPath}})})),e})),f=(0,n.computed)((()=>{const e=[];return null!=u.value&&null!=u.value&&(y.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>l.push({path:`/${o.value}/edit/${u.value}`,query:{return:a.fullPath}})}),y.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>l.push({path:`/${o.value}/delete/${u.value}`,query:{return:a.fullPath}})})),[]})),_=(0,n.ref)(!1);function T(e){u.value=e,_.value=!0}function g(){_.value=!1}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Ga),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(gn),{"menu-item":(0,n.unref)(C),"menu-contextual":(0,n.unref)(f),"menu-contextual-open":_.value,fields:e.list.fields,data:(0,n.unref)(N),orderby:(0,n.unref)(s),"forced-order":"",selection:"simple","selected-item-id":(0,n.unref)(u),"page-size":(0,n.unref)(E),"current-page":(0,n.unref)(c),"data-count":(0,n.unref)(p),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(d)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>u.value=e),"onUpdate:currentPage":a[2]||(a[2]=e=>(0,n.unref)(m)(e,{selectedItemId:void 0})),onMenuContextualOpen:T,onMenuContextualClose:g},null,8,["menu-item","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","current-page","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(l)],64)}}},Rn={__name:"form-auto",props:{list:{type:Object,required:!0},form:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=pt();(0,n.watch)((()=>a.list.name),(e=>l.load(e)),{immediate:!0});const i=(0,n.computed)((()=>pn(a.list,a.form.fields(a.entity)))),{errorMessage:o,clean:r}=a.form.rules?a.validations.createValidation("formRules",{rules:a.form.rules}):{};function s({field:e,action:a}){r?.(),t("change",a)}return Yt(((...e)=>a.form.onItemLoaded?.(...e))),(t,a)=>{const l=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.form.class)},[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(i),entity:e.entity,"with-class":e.form.withClass,validations:e.validations,"cache-name":e.list.entityName||e.list.name,onChange:s},null,8,["fields","entity","with-class","validations","cache-name"]),(0,n.unref)(o)?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,style:{"grid-area":"errorMessage"},type:"error",dismiss:"",singleline:"",onDismiss:a[0]||(a[0]=e=>(0,n.unref)(r)?.())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(o)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)],2)}}},hn=Rn;async function Ln(e,t){const a=he();try{const a=await e();return t&&t(),a}catch(e){t&&t(),a.alert({title:"Error",message:e.body||"Error inesperat."})}}const xn={__name:"dictionary-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=he(),s=we(),d=(0,o.useValidations)(),{goBack:u}=Dn(),c=(0,n.computed)((()=>t.list.name)),{itemId:m}=On("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),E=(0,n.computed)((()=>t.list.fields.find((e=>e.primary)))),p=(0,n.computed)((()=>t.list.fields.find((e=>e.defaultField)))),A=Ye({form:{entityName:c.value},...t.list}),I=(0,n.ref)(!1),N=(0,n.ref)("");function y(){const e=null!=m.value?s.data[c.value].find((e=>e[E.value.name]===m.value)):Object.fromEntries(t.list.fields.map((e=>[e.name,e.default])));(0,o.entitySyncData)(A,e),(0,o.entityConsolidate)(A)}function C({action:e}){e(A)}async function f(){await d.validate(A)&&(await Je(A),await s.loadDictionary(c,{force:!0}),u(`/${c.value}`))}async function _(){await d.validate(A)&&(await Je(A),await s.loadDictionary(c,{force:!0}),null===m.value?y():l.push({path:`/${c.value}/create`,query:a.query}))}function T(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",accept:async()=>{await Ln((async()=>{await Qe(A),await s.loadDictionary(c,{force:!0}),l.push({path:`/${c.value}`,query:{...a.query,selectedKey:void 0}})}))}})}return(0,n.watch)(m,y),(0,n.onMounted)((async()=>{I.value=!1,await s.loadDictionary(c),y(),N.value=null===m.value?"Entrada nou element":`Modificació: ${A[p.value.name]}`,I.value=!0})),(t,a)=>{const l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(i,{class:"dictionaryItemEdit-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"dictionaryItemEdit-dialog",header:N.value},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(qa),{"has-save":"","has-save-and-new":"","has-reset":"","has-remove":null!==(0,n.unref)(m),"has-go-back":"",onSave:f,onSaveAndNew:_,onReset:y,onRemove:T,onGoBack:a[0]||(a[0]=e=>(0,n.unref)(u)(`/${(0,n.unref)(c)}`))},{default:(0,n.withCtx)((()=>[e.list.form?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hn),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(A),validations:(0,n.unref)(d),onChange:C},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)($t),{key:1,fields:e.list.fields,entity:(0,n.unref)(A),validations:(0,n.unref)(d),"cache-name":e.list.name,onChange:C},null,8,["fields","entity","validations","cache-name"]))])),_:1},8,["has-remove"])])),_:1},8,["header"])])),_:1})}}},Un=(0,R.Z)(xn,[["__scopeId","data-v-1b60de7a"]]),Mn={class:"dialogFooter"},Pn={__name:"dictionary-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=he(),o=we(),{goBack:s}=Dn(),d=(0,n.computed)((()=>t.list.name)),{itemId:u}=On("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),c=t.list.fields.find((e=>e.primary)),m=t.list.fields.find((e=>e.defaultField)),E=(0,n.ref)("");return(0,n.onMounted)((async()=>{i.loadStart("dictionary-form/load"),await o.loadDictionary(d);const e=o.data[d.value].find((e=>e[c.$select]===u));E.value=`Esteu segurs que voleu esborrar l'element "${e?.[m.$select]}"?`,i.loadEnd("dictionary-form/load")})),(e,t)=>{const i=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:E.value,onClick:t[2]||(t[2]=e=>(0,n.unref)(s)(`/${(0,n.unref)(d)}`))},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Mn,[(0,n.createVNode)(i,{primary:"",text:"Eliminar",onClick:t[0]||(t[0]=e=>async function(){await Ln((async()=>{await Ue(`${d.value}(${u.value})`),await o.loadDictionary(d,{force:!0}),l.push({path:`/${d.value}`,query:{...a.query,selectedKey:void 0}})}))}())}),(0,n.createVNode)(i,{text:"Cancel·lar",onClick:t[1]||(t[1]=e=>(0,n.unref)(s)(`/${(0,n.unref)(d)}`))})])])),_:1},8,["text"])])),_:1})}}};function Vn(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.DictionaryDetails??vn,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.DictionaryItemEdit??Un,props:{list:e}},{path:"edit/:itemId",component:e.routes?.overrideControls?.DictionaryItemEdit??Un,props:{list:e}},{path:"delete/:itemId",component:e.routes?.overrideControls?.DictionaryItemDelete??Pn,props:{list:e}}]}]}const Fn=(0,l.defineStore)({id:"view",state:()=>({listName:null,definitions:[]}),actions:{async loadViews(e,t){if(e&&(this.listName!==e||t)){const t=he();t.loadStart(`list-view/${e}/load`);const a=await xe(E,{$filter:`${A} eq '${e}'`,$orderby:`${y} desc,${I} asc`});this.listName=e,this.definitions=a.value.map((e=>({...e,[N]:JSON.parse(e[N]||"null")}))),t.loadEnd(`list-view/${e}/load`)}}}}),wn={class:"listDetailsDefault-buttons"},Gn={__name:"list-details-default",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=Fn(),i=(0,n.computed)((()=>t.list.name)),o=(0,n.ref)(!1);function s(){a.push(`/${i.value}/view/create`)}return(0,n.watch)(i,(e=>{e&&l.loadViews(e).then((()=>{const t=l.definitions.find((e=>e[y]))||l.definitions[0],n=t?.[I];n&&a.push({path:`/${e}/view/query/${n}`,query:{orderby:t[N].orderby,filter:t[N].filter}}),o.value=!0}))}),{immediate:!0}),(t,a)=>{const l=(0,n.resolveComponent)("fura-button"),i=(0,n.resolveComponent)("fura-dialog"),r=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"listDetailsDefault-overlay"},{default:(0,n.withCtx)((()=>[o.value?((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,class:"listDetailsDefault-dialog",header:"Atencio",text:"No s'ha definit cap visualització. Creeu una visualització per començar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",wn,[(0,n.createVNode)(l,{primary:"",text:"Crea una nova visualització",onClick:s})])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1},8,["subtitle"])}}},Bn=(0,R.Z)(Gn,[["__scopeId","data-v-0871c081"]]),kn={__name:"list-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),i=Fn(),s=he(),d=(0,n.computed)((()=>t.list.name)),{viewName:u}=On("viewName"),{filter:c}=Sn("filter"),{orderby:E,orderbyRaw:p,updateOrderby:A}=Sn("orderby",{parse:In,stringify:Nn}),{selectedItemId:y}=Sn("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{firstItem:C,updateFirstItem:f}=Sn("firstItem",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{reload:_}=Sn("reload",{parse:e=>Boolean(e)});(0,n.watch)(d,(async e=>{await i.loadViews(e),u.value&&!i.definitions.some((e=>e[I]===u.value))&&a.push(`/${e}`)}),{immediate:!0});const g=(0,n.computed)((()=>t.list?.fields.find((e=>e.primary)))),O=(0,n.computed)((()=>t.list?.fields.filter((e=>e.loadAlwaysInView))??[])),S=(0,n.computed)((()=>i.definitions.find((e=>e[I]===u.value)))),b=(0,n.computed)((()=>{const e=Array.from(S.value?.[N].fields||[]);return e.includes(g.value?.name)||e.unshift(g.value?.name),e.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e))})),D=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),v=(0,n.computed)((()=>{if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:le(e);return c.value?`(${a}) and (${c.value})`:a}return c.value})),R=(0,n.computed)((()=>({...Me([g.value,...b.value,...O.value.filter((e=>!b.value?.some((t=>e.name===t.name))))]),$filter:v.value||void 0,$orderby:p.value||void 0,$skip:C.value>0?C.value-1:void 0,$top:D.value,$count:!0}))),h=(0,n.computed)((()=>t.list.entityName||t.list.name)),{data:L,isLoading:x,load:U}=function(e,t,a,n){const l=T();return(0,o.useFetchGet)([m,e].flat(),t,{Authorization:l.jwt},void 0)}(h,R);(0,n.watch)(_,(e=>{e&&U(),a.replace({path:l.path,query:{...l.query,reload:void 0}})}));const M=(0,n.computed)((()=>L.value?.value||[])),P=(0,n.computed)((()=>L.value?.["@odata.count"]));(0,n.watch)(x,(e=>e?s.loadStart(`list/${d.value}/load`):s.loadEnd(`list/${d.value}/load`)),{immediate:!0});const V=(0,n.computed)((()=>{if(g.value&&M.value.length>0){const e=g.value.name;return M.value.find((t=>t[e]===y.value))??null}return null})),F=(0,n.computed)((()=>t.list.permissionDenied?.(V.value)??{})),w=(0,n.computed)((()=>{const e=[];return F.value.create||e.push({text:"Nou",icon:"Add",action:()=>a.push({path:`/${d.value}/create`,query:{return:l.fullPath}})}),null!=y.value&&(F.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${d.value}/edit/${y.value}`,query:{return:l.fullPath}})}),F.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${d.value}/delete/${y.value}`,query:{...l.query,viewName:u.value}})})),F.value.edit||"auto"!==t.list.form?.component||e.push({text:"Editar valors",icon:"WindowEdit",action:()=>a.push({path:`/${d.value}/view/grid/${u.value}`,query:l.query})}),null==y.value&&u.value&&!F.value.export&&e.push({text:"Exportar",icon:"Export",children:[{text:"a PDF",icon:"PDF",action:()=>a.push({path:`/${d.value}/view/query/${u.value}/export`,query:{...l.query,format:"pdf"}})},{text:"a Excel",icon:"ExcelDocument",action:()=>a.push({path:`/${d.value}/view/query/${u.value}/export`,query:{...l.query,format:"excel"}})}]}),e})),G=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(w.value,V.value,{contextual:!1}):w.value)),B=(0,n.computed)((()=>{const e=[{text:u.value??"",children:[...i.definitions?.map((e=>({text:e[I],action:()=>a.push({path:`/${d.value}/view/query/${e[I]}`,query:{orderby:e[N].orderby,filter:e[N].filter}})})))??[],{type:"divider"},{text:"Crea una visualització",icon:"Add",action:()=>a.push({path:`/${d.value}/view/create`,query:{filter:l.query.filter,return:l.fullPath}})}]}];return u.value&&e[0].children.push({text:"Modifica",icon:"CSS",action:()=>a.push({path:`/${d.value}/view/edit/${u.value}`,query:{filter:l.query.filter,return:l.fullPath}})}),t.list.filter&&e.push({icon:"Filter",action:()=>a.push({path:`/${d.value}/view/query/${u.value}/filter`,query:{...l.query}})}),e})),k=(0,n.computed)((()=>{const e=[];return F.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${h.value}/edit/${y.value}`,query:{return:l.fullPath}})}),F.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${h.value}/delete/${y.value}`,query:{...l.query,viewName:u.value}})}),e})),$=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(k.value,V.value,{contextual:!0}):k.value)),q=(0,n.ref)(!1);function j(e){y.value=e,q.value=!0}function K(){q.value=!1}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Ga),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(gn),{"menu-item":(0,n.unref)(G),"menu-view":(0,n.unref)(B),"menu-contextual":(0,n.unref)($),"menu-contextual-open":q.value,fields:(0,n.unref)(b),data:(0,n.unref)(M),orderby:(0,n.unref)(E),selection:"simple","selected-item-id":(0,n.unref)(y),"page-size":(0,n.unref)(D),"first-item":(0,n.unref)(C)??void 0,"data-count":(0,n.unref)(P),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(A)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>y.value=e),"onUpdate:firstItem":a[2]||(a[2]=e=>(0,n.unref)(f)(e,{selectedItemId:void 0})),onMenuContextualOpen:j,onMenuContextualClose:K},null,8,["menu-item","menu-view","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","first-item","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(l)],64)}}},$n=kn,qn={class:"detailsGrid fura-stickyHeader"},jn={class:"detailsGrid-headerTitle"},Kn=["textContent"],zn=(e=>((0,n.pushScopeId)("data-v-3c346872"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("th",{width:"88px"},null,-1))),Zn={key:0},Xn=["colspan"],Wn={__name:"details-grid",props:{list:{type:Object,required:!0},columns:{type:Array,required:!0},elements:{type:Array,required:!0},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>"number"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:`${a.stickyHeaderOffset}px`}:"string"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:a.stickyHeaderOffset}:{})),i=a.elements.map((e=>(0,n.computed)((()=>{const t=pn(a.list,a.list.form.fields(e.entity));return pn({fields:t},a.columns.map((({field:e})=>e.name)))})))),o=a.elements.map(((e,t)=>i[t].value.map((t=>(0,n.computed)((()=>function(e,t){const{withClass:n}=a.list.form;return!0===n?`formField-${e.name}`:"function"==typeof n?n(e,t):void 0}(t,e.entity)))))));return(a,r)=>{const s=(0,n.resolveComponent)("fura-icon"),d=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("table",qn,[(0,n.createElementVNode)("thead",null,[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("th",{key:t,class:"detailsGrid-headerCell",style:(0,n.normalizeStyle)({width:e.field.gridColumn?.width,...(0,n.unref)(l)})},[(0,n.createElementVNode)("div",jn,[(0,n.createElementVNode)("span",{textContent:(0,n.toDisplayString)(e.title)},null,8,Kn),e.icon?((0,n.openBlock)(),(0,n.createBlock)(s,{key:0,class:"detailsGrid-headerIcon",name:e.icon},null,8,["name"])):(0,n.createCommentVNode)("v-if",!0)])],4)))),128)),zn])]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.elements,((a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("tbody",{key:l},[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((r,s)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:s},[(0,n.unref)(kt)[(0,n.unref)(i)[l].value[s].type]?.gridField?((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[(0,n.unref)(i)[l].value[s].type].gridField),{key:0,class:(0,n.normalizeClass)((0,n.unref)(o)[l][s].value),entity:a.entity,field:(0,n.unref)(i)[l].value[s],validations:a.validations,"cache-name":e.list.entityName||e.list.name,onChange:e=>t("update",{index:l,field:(0,n.unref)(i)[l].value[s],action:e}),onFocus:e=>t("focus",{index:l,field:(0,n.unref)(i)[l].value[s],event:e}),onBlur:e=>t("blur",{index:l,field:(0,n.unref)(i)[l].value[s],event:e})},null,40,["class","entity","field","validations","cache-name","onChange","onFocus","onBlur"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[r.field.type].detailsCell),{key:1,field:r.field,row:a.entity},null,8,["field","row"]))])))),128)),(0,n.createElementVNode)("td",null,[a.hasPendingChanges?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(d,{type:"icon",icon:"Save",onClick:e=>t("save",l)},null,8,["onClick"]),(0,n.createVNode)(d,{type:"icon",icon:"Reset",onClick:e=>t("reset",l)},null,8,["onClick"])],64)):(0,n.createCommentVNode)("v-if",!0)])]),a.errorMessage?((0,n.openBlock)(),(0,n.createElementBlock)("tr",Zn,[(0,n.createElementVNode)("td",{colspan:e.columns.length+1},[(0,n.createVNode)(u,{type:"error",dismiss:"",singleline:"",onDismiss:e=>a.clean?.()},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(a.errorMessage),1)])),_:2},1032,["onDismiss"])],8,Xn)])):(0,n.createCommentVNode)("v-if",!0)])))),128))])}}},Hn=(0,R.Z)(Wn,[["__scopeId","data-v-3c346872"]]),Yn={__name:"layout-list-grid",props:{list:{type:Object,required:!0},menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},fields:{type:Array,default:void 0},elements:{type:Array,default:void 0},orderby:{type:Array,default:()=>[]},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},elementsCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.map(((e,t)=>({index:t,type:e.type,title:e.label,icon:An(a.orderby.find((t=>t.sentence===Pe(e)))),field:e}))))),i=(0,n.computed)((()=>{const{pageSize:e,elementsCount:t}=a;return"number"==typeof e&&"number"==typeof t})),o=(0,n.computed)((()=>Math.ceil(a.elementsCount/a.pageSize))),r=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"layoutListGrid-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"layoutListGrid-navBottom";default:return}})),s=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"layoutListGrid-left";case"topCenter":case"bottomCenter":return"layoutListGrid-center";case"topRight":case"bottomRight":return"layoutListGrid-right";default:return}}));return(a,d)=>{const u=(0,n.resolveComponent)("fura-command-bar"),c=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(u,{class:"layoutListGrid-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)((0,n.unref)(r))},[(0,n.createVNode)((0,n.unref)(Hn),{class:"layoutListGrid-details",list:e.list,columns:(0,n.unref)(l),elements:e.elements,"sticky-header":"","sticky-header-offset":44,onUpdate:d[0]||(d[0]=e=>t("update",e)),onFocus:d[1]||(d[1]=e=>t("focus",e)),onBlur:d[2]||(d[2]=e=>t("blur",e)),onSave:d[3]||(d[3]=e=>t("save",e)),onReset:d[4]||(d[4]=e=>t("reset",e))},null,8,["list","columns","elements"]),(0,n.unref)(i)&&(0,n.unref)(r)&&(0,n.unref)(s)&&e.elements.length>0?((0,n.openBlock)(),(0,n.createBlock)(c,{key:0,class:(0,n.normalizeClass)(["layoutListGrid-navigation",(0,n.unref)(s)]),current:e.currentPage+1,total:(0,n.unref)(o),"end-button":"","start-button":"","disable-prev":"","disable-next":"","disable-start":"","disable-end":""},null,8,["class","current","total"])):(0,n.createCommentVNode)("v-if",!0)],2)],64)}}},Jn=(0,R.Z)(Yn,[["__scopeId","data-v-7472afbe"]]),Qn={__name:"list-details-grid",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),i=Fn(),s=pt(),d=he();s.setContextName(t.list.name),s.load(t.list.name);const u=(0,n.ref)(!0),c=l.params.viewName,E=l.query.page?Number(l.query.page)-1:null,p=t.list?.pageSize?t.list.pageSize:10,A=(0,n.shallowRef)([]),y=(0,n.shallowRef)(null),C=(0,o.useEntityCollection)(et(t.list,t.list.form)),f=(0,n.ref)(0),_=(0,n.reactive)([]),g=(0,n.getCurrentScope)();i.loadViews(t.list.name).then((async()=>{d.loadStart(`list/${t.list.name}/load`),c&&!i.definitions.some((e=>e[I]===c))&&a.push(`/${t.list.name}`);const e=i.definitions.find((e=>e[I]===c));A.value=e[N].fields.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e));let r=l.query.filter;if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:le(e);r=l.query.filter?`(${a}) and (${l.query.filter})`:a}const s={$filter:r||void 0,$orderby:l.query.orderby||void 0,$skip:E>0?E*p:void 0,$top:p,$count:!0};y.value=await function(e,t){const a=T();return(0,o.entityLoadCollection)(e,m,{Authorization:a.jwt},t)}(C,s),f.value=y.value?.["@odata.count"];const O=t.list.fields.find((e=>e.primary)).name;for(const e of C.values()){const a=pn(t.list,t.list.form.fields(e)).filter((e=>!A.value.some((t=>t.name===e.name))&&"function"==typeof kt[e.type]?.getEntityValue)),l=(0,o.useValidations)(),{errorMessage:i,clean:r}=t.list.form.rules?l.createValidation("formRules",{rules:t.list.form.rules}):{};g.run((()=>{l.createField(O,(0,n.computed)((()=>e[O])));for(const t of a)l.createField(t.name,(0,n.computed)((()=>kt[t.type].getEntityValue(t,e))))})),_.push({entity:e,hasPendingChanges:!1,validations:l,errorMessage:i,clean:r})}u.value=!1,d.loadEnd(`list/${t.list.name}/load`)}));const O=(0,n.computed)((()=>(0,o.entityHasPendingChanges)(C)?[{text:"Guardar tots els canvis",icon:"Save",disabled:"AANEE_ALUMNE_GRID"===t.list.name,action:D},{text:"Reiniciar",icon:"Refresh",action:()=>{(0,o.entitySyncData)(C,y.value.value);for(const e of _)e.clean(),e.hasPendingChanges=(0,o.entityHasPendingChanges)(e.entity)}},{text:"Tornar",icon:"Back",action:()=>{d.confirm({title:"Alerta!",message:"Hi han canvis sense guardar. Aquests canvis es perdràn. Voleu continuar?.",accept(){a.push({path:`/${t.list.name}/view/query/${c}`,query:l.query})}})}}]:[{text:"Tornar",icon:"Back",action:()=>{a.push({path:`/${t.list.name}/view/query/${c}`,query:l.query})}}])),S=(0,n.computed)((()=>{const e=[{text:c??"",disabled:!0}];return t.list.filter&&e.push({icon:"Filter",disabled:!0}),e}));async function b({index:e,field:t,action:a}){const n=_[e];if(a(n.entity),"function"==typeof t.onChange){const e=await t.onChange(n.entity);"function"==typeof e&&e(n.entity)}n.hasPendingChanges=(0,o.entityHasPendingChanges)(n.entity),n.clean()}function D(){return Ln((async()=>await Promise.all(_.map((async(e,t)=>{e.hasPendingChanges&&await e.validations.validate(e.entity)&&(await Je(e.entity),(0,o.entityConsolidate)(e.entity),e.hasPendingChanges=!1,y.value.value[t]=(0,o.entityData)(e.entity))})))))}async function v(e){const t=_[e];await t.validations.validate(t.entity)&&await Ln((async()=>{await Je(t.entity),(0,o.entityConsolidate)(t.entity),t.hasPendingChanges=!1,y.value.value[e]=(0,o.entityData)(t.entity)}))}function R(e){const t=_[e];t.clean(),(0,o.entitySyncData)(t.entity,y.value.value[e]),t.hasPendingChanges=(0,o.entityHasPendingChanges)(t.entity)}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Ga),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[u.value?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Jn),{key:0,list:e.list,"menu-item":(0,n.unref)(O),"menu-view":(0,n.unref)(S),fields:(0,n.unref)(A),elements:_,orderby:(0,n.unref)(In)((0,n.unref)(l).query.orderby),"page-size":(0,n.unref)(p),"current-page":(0,n.unref)(E),"elements-count":f.value,onUpdate:b,onSave:v,onReset:R},null,8,["list","menu-item","menu-view","fields","elements","orderby","page-size","current-page","elements-count"]))])),_:1},8,["subtitle"]),(0,n.createVNode)(i)],64)}}},el={__name:"filter-form-combo",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:void 0,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=pt(),i=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{i.value=(l.data[a.cacheName]?.[a.field.name]||[]).map((e=>({value:e[a.field.valueKey||"value"],text:e[a.field.textKey||"text"]})))})),(a,l)=>{const o=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.field.label,options:(0,n.unref)(i),multiple:e.field.multiple,"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=e=>t("update:modelValue",e))},null,8,["label","options","multiple","model-value"])}}},tl={__name:"filter-form-combo-custom",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:void 0,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=T(),i=pt(),o=a.field.setDisabled&&"function"==typeof a.field.setDisabled?a.field.setDisabled(l):null;if(o){const e=a.field.setValue&&"function"==typeof a.field.setValue?a.field.setValue(l):null;e&&t("update:modelValue",parseInt(e))}const r=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{r.value=(i.data[a.cacheName]?.[a.field.name]||[]).map((e=>({value:e[a.field.valueKey||"value"],text:e[a.field.textKey||"text"]})))})),(a,l)=>{const i=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.field.label,disabled:(0,n.unref)(o),options:(0,n.unref)(r),multiple:e.field.multiple,"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=e=>t("update:modelValue",e))},null,8,["label","disabled","options","multiple","model-value"])}}},al={__name:"filter-form-csv",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=(0,n.computed)({get:()=>Array.isArray(a.modelValue)&&a.modelValue.length>0?a.modelValue.join():"",set(e){const a=e.replace(/(\r\n|\n|\r)/gm,",").split(",").filter(Boolean);e.length>0?t("update:modelValue",a):t("update:modelValue",void 0)}});return(t,a)=>{const i=(0,n.resolveComponent)("fura-text-field");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.field.label,multiline:"",modelValue:(0,n.unref)(l),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.isRef)(l)?l.value=e:null)},null,8,["label","modelValue"])}}},nl={key:3},ll={key:7,class:"filterForm-multiple"},il={__name:"filter-form",props:{fields:{type:Array,required:!0},modelValue:{type:Array,required:!0},cacheName:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e;function l(e){return a.modelValue.find((t=>t[0]===e.name))?.[1]}function i(e,n){if(null==n||""===n||Array.isArray(n)&&0===n.length)t("update:modelValue",a.modelValue.filter((t=>t[0]!==e.name)));else{const l=a.modelValue.findIndex((t=>t[0]===e.name));t("update:modelValue",-1===l?[...a.modelValue,[e.name,n]]:[...a.modelValue.slice(0,l),[e.name,n],...a.modelValue.slice(l+1)])}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-text-field"),s=(0,n.resolveComponent)("fura-number-field"),d=(0,n.resolveComponent)("fura-date-picker"),u=(0,n.resolveComponent)("fura-checkbox"),c=(0,n.resolveComponent)("FilterForm",!0);return(0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(a=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:a.name},["text"===a.type?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"number"===a.type?((0,n.openBlock)(),(0,n.createBlock)(s,{key:1,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"date"===a.type?((0,n.openBlock)(),(0,n.createBlock)(d,{key:2,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"checkbox"===a.type?((0,n.openBlock)(),(0,n.createElementBlock)("div",nl,[(0,n.createVNode)(u,{class:"filterForm-checkbox",label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,!!e&&null),indeterminate:"boolean"!=typeof l(a),"onUpdate:indeterminate":e=>i(a,!0)},null,8,["label","model-value","onUpdate:modelValue","indeterminate","onUpdate:indeterminate"])])):"combo"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(el),{key:4,field:a,"cache-name":e.cacheName,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["field","cache-name","model-value","onUpdate:modelValue"])):"comboCustom"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(tl),{key:5,field:a,"cache-name":e.cacheName,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["field","cache-name","model-value","onUpdate:modelValue"])):"csv"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(al),{key:6,field:a,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["field","model-value","onUpdate:modelValue"])):Array.isArray(a)?((0,n.openBlock)(),(0,n.createElementBlock)("div",ll,[(0,n.createVNode)(c,{fields:a,"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t("update:modelValue",e))},null,8,["fields","model-value"])])):(0,n.createCommentVNode)("v-if",!0)],64)))),128)}}},ol=(0,R.Z)(il,[["__scopeId","data-v-275189ca"]]),rl=["onSubmit"],sl={key:0,class:"filterGroups"},dl=["onClick"],ul={class:"content fura-slideDownIn20"},cl={class:"actions"},ml={__name:"list-details-filter-panel",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=pt(),{expanded:o,updateExpanded:s}=Sn("expanded");i.setContextName(t.list.name),i.load(t.list.name);const d=pn(t.list,t.list.filter),u=[],c=[],m=[];for(const e of d)if(e.type in kt){const t=kt[e.type],a=t.getFilterCondition?.(e,d);a&&u.push(a);const n=t.getFilterInterface?.(e,d);if(n)if(e.filterGroup){const t=m.find((t=>t.name===e.filterGroup));t?t.fields.push(n):m.push({name:e.filterGroup,fields:[n]})}else c.push(n)}const E=new se(u,"and"),p=(0,n.ref)(a.query.filter?E.readFilter(a.query.filter):[]);function A(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:E.writeFilter(p.value)||void 0,selectedItemId:void 0,page:void 0}})}function I(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:void 0}})}function N(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:a.query})}function y(e){return Array.isArray(o.value)?o.value.includes(e.name):o.value===e.name}const C=(0,n.ref)();return(0,n.onMounted)((()=>{C.value.querySelector('input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()})),(t,a)=>{const l=(0,n.resolveComponent)("fura-icon"),i=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-panel"),d=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(d,{fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(A,["prevent"])},[(0,n.createVNode)(r,{type:"medium","header-text":`Filtrar ${e.list.label}`,onClick:N},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",cl,[(0,n.createVNode)(i,{primary:"",text:"Cerca",icon:"Filter","form-role":"submit"}),(0,n.createVNode)(i,{class:"clearFilter",primary:"",text:"Esborra el filtre",icon:"ClearFilter",onClick:I}),(0,n.createVNode)(i,{text:"Cancela",icon:"Cancel",onClick:N})])])),default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",{ref_key:"fieldsContainer",ref:C},[m.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",sl,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(m,(t=>(0,n.createElementVNode)("div",{key:t.name,class:(0,n.normalizeClass)(["item",{expanded:y(t)}])},[t.name?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,class:"title",type:"button",onClick:(0,n.withModifiers)((e=>function(e){y(e)?Array.isArray(o.value)?s(o.value.filter((t=>t!==e.name))):s(null):Array.isArray(o.value)?s([...o.value,e.name]):o.value?s([o.value,e.name]):s(e.name)}(t)),["stop"])},[(0,n.createVNode)(l,{class:"expanderIcon",name:"ChevronDown"}),(0,n.createTextVNode)(" "+(0,n.toDisplayString)(t.name),1)],8,dl)):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",ul,[(0,n.createVNode)((0,n.unref)(ol),{fields:t.fields,"cache-name":e.list.name,modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e)},null,8,["fields","cache-name","modelValue"])])],2))),64))])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)((0,n.unref)(ol),{fields:c,"cache-name":e.list.name,modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e)},null,8,["cache-name","modelValue"])],512)])),_:1},8,["header-text"])],40,rl)])),_:1})}}},El=(0,R.Z)(ml,[["__scopeId","data-v-72612ae2"]]);function pl(e){const t=String(e??"");return t.includes('"')||t.includes(";")||t.includes("\n")?`"${t.replaceAll('"','""')}"`:t}async function Al(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof kt[a.type]?.getCsvValueFromEntity){const e=pl(await kt[a.type].getCsvValueFromEntity(a,n));t.push(e)}else t.push("");a.push(t)}return a}var Il=d(525),Nl=d(732);function yl(){const e=(e,t=2)=>e.toString().padStart(t,"0"),t=new Date(Date.now());return`${e(t.getDate())}/${e(t.getMonth()+1)}/${e(t.getFullYear(),4)}`}const Cl={class:"dialogAlert-close"},fl={__name:"list-details-export",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=Fn(),o=(0,n.ref)(null),s=(0,n.ref)(),d=(0,n.computed)((()=>"pdf"===a.query.format?`${t.list.label}.pdf`:"excel"===a.query.format?`${t.list.label}.csv`:`${t.list.label}.txt`));function u(){l.back()}async function c(e,n){return"pdf"===a.query.format?await async function(e,t,{title:a}){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const n=await async function(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof kt[a.type]?.getTextValueFromEntity){const e=await kt[a.type].getTextValueFromEntity(a,n);t.push(e)}else t.push("");a.push(t)}return a}(e,t),l={pageSize:"A4",pageMargins:[30,60,30,30],pageOrientation:"landscape",header:(e,t)=>({margin:[30,30,20,0],columns:[{text:"Assignació places NEE",width:165,alignment:"left"},{text:a,width:"*",style:"tableHeaderCenter"},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:yl(),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}),content:[{table:{headerRows:1,dontBreakRows:!0,border:"none",body:[e.map((e=>({text:e.label,bold:!0,alignment:e.align||"left"}))),...n.map((t=>t.map(((t,a)=>({text:t,align:e[a].align||"left"})))))]},layout:"noBorders",margin:[0,5,0,5]}],styles:{tableHeader:{bold:!0},tableHeaderCenter:{bold:!0,alignment:"center"},tableHeaderRight:{bold:!0,alignment:"right"},boldFirst:{bold:!0,margin:[0,6,0,0]},bold:{bold:!0},normal:{bold:!1}},defaultStyle:{fontSize:9}};return await new Promise((e=>{Il.createPdf(l).getDataUrl(e)}))}(e,n,{title:t.list.label}):"excel"===a.query.format?await async function(e,t){const a=[e.map((e=>pl(e.label))),...await Al(e,t)].map((e=>e.join(";"))).join("\n");return"data:text/csv;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent("\ufeff"+a+"\n")))}(e,n):void 0}return(0,n.onMounted)((async()=>{await i.loadViews(t.list.name);const e=i.definitions.find((e=>e[I]===a.params.viewName)),l=Array.from(e[N].fields).map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e)),r={...Me(l),$filter:a.query.filter||void 0,$orderby:a.query.orderby||void 0},d=await xe(t.list.name,r);o.value=await c(l,d.value),await(0,n.nextTick)(),s.value.$el.click(),u()})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(i,{class:"listExport-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"listExport-dialog",header:"Exportació de dades",text:"Fitxer llest per descarregar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Cl,[o.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,ref_key:"download",ref:s,primary:"",text:"Descarrega",download:(0,n.unref)(d),href:o.value,target:"_blank"},null,8,["download","href"])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)(a,{text:"Tancar",onClick:u})])])),_:1})])),_:1})}}},_l=(0,R.Z)(fl,[["__scopeId","data-v-392e43be"]]),Tl=e=>((0,n.pushScopeId)("data-v-5f58ff4a"),e=e(),(0,n.popScopeId)(),e),gl={class:"list-view-fields"},Ol=Tl((()=>(0,n.createElementVNode)("div",null,null,-1))),Sl={class:"list-view-fields"},bl=Tl((()=>(0,n.createElementVNode)("div",{class:"list-view-orderBy"},null,-1))),Dl={__name:"list-view-simple-config",props:{fields:{type:Array,required:!0},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>{const{modelValue:e,fields:t}=a;return[{value:null,text:"",disabeld:!1},...t.map((t=>({value:t.name,text:t.label,disabled:e.some((e=>e.name===t.name))})))]}));function i(e){e&&t("update:modelValue",[...a.modelValue,{name:e,direction:null}])}function o(e){const t=a.fields.find((t=>t.name===e));return t&&t.orderby?t.orderby:[{value:"asc",text:"A -> Z"},{value:"desc",text:"Z -> A"}]}return(r,s)=>{const d=(0,n.resolveComponent)("fura-dropdown"),u=(0,n.resolveComponent)("llesca-stack-draggable");return(0,n.openBlock)(),(0,n.createBlock)(u,{"primary-key":"name","model-value":e.modelValue,"onUpdate:modelValue":s[0]||(s[0]=e=>t("update:modelValue",e))},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",gl,[(0,n.createVNode)(d,{class:"list-view-field",options:(0,n.unref)(l),"model-value":e.item.name,"onUpdate:modelValue":n=>function(e,n){const l=[...a.modelValue];n?l[e]={name:n,direction:l[e].direction}:l.splice(e,1),t("update:modelValue",l)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),(0,n.createVNode)(d,{class:"list-view-orderBy",options:o(e.item.name),"model-value":e.item.direction,"onUpdate:modelValue":n=>function(e,n){const l=[...a.modelValue];l[e]={name:l[e].name,direction:n},t("update:modelValue",l)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),Ol])])),footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Sl,[(0,n.createVNode)(d,{class:"list-view-field",options:(0,n.unref)(l),"onUpdate:modelValue":i},null,8,["options"]),bl])])),_:1},8,["model-value"])}}},vl=(0,R.Z)(Dl,[["__scopeId","data-v-5f58ff4a"]]),Rl={class:"layout"},hl={class:"viewOptions"},Ll={class:"actions"},xl={__name:"list-view-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=he(),s=Fn(),d=T(),u=(0,n.computed)((()=>a.params.viewName??null)),c=(0,n.computed)((()=>s.definitions.find((e=>e[I]===u.value))?.[p])),C=(0,n.computed)((()=>t.list.name));s.loadViews(C.value).then((()=>{if(u.value){const e=s.definitions.find((e=>e[I]===u.value));e||alert("error"),S(e)}}));const f=t.list.fields.filter((e=>e.label)),_=(0,n.reactive)({name:"",defaultView:!1,selectedFields:[],saveFilter:!1,nameErrorMessage:null,showErrorMessage:!1}),g=(0,n.computed)((()=>Nn(_.selectedFields.filter((e=>e.name)).map((e=>({sentence:Pe(t.list.fields.find((t=>t.name===e.name))),direction:e.direction})))))),O=(0,n.computed)((()=>!s.definitions.some((e=>1===e[y]))||s.definitions[0][I]===_.name));function S(e={}){const a=e?.[N]?.fields??[],n=In(e?.[N]?.orderby??"")??[],l=a.map((e=>{const a=t.list.fields.find((t=>t.name===e));return{name:e,direction:n.find((e=>e.sentence===Pe(a)))?.direction}}));_.name=e?.[I]??"",_.defaultView=!!e?.[y],_.selectedFields=l,_.saveFilter=!1}async function b(){if(function(){let e=!0;return _.nameErrorMessage=null,_.showErrorMessage=!1,_.name?s.definitions.some((e=>e[p]!==c.value&&e[I]===_.name))&&(e=!1,_.nameErrorMessage="Ja existeix una visualització amb aquest nom."):(e=!1,_.nameErrorMessage="Cal posar un nom a la visualització,"),0===_.selectedFields.length&&(e=!1,_.showErrorMessage=!0),e}()){const e=_.defaultView?s.definitions.filter((e=>e[y])).map((e=>({atomicityGroup:"saveView",id:`saveView-patch${e[p]}`,method:"PATCH",url:`/${E}(${e[p]})`,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:d.jwt},body:{[y]:0}}))):[];e.push(function(){const e=s.definitions.find((e=>e[I]===u.value));if(null!==u.value&&!e)throw new Error("La vista a actualitzar no s'ha trobat.");const[t,n,l]=void 0===e?["saveView-post","POST",`/${E}`]:[`saveView-put-${e[p]}`,"PUT",`/${E}(${e[p]})`];return{atomicityGroup:"saveView",id:t,method:n,url:l,headers:{"Content-Type":"application/json",Authorization:d.jwt},body:{[p]:e?.[p],[A]:C.value,[I]:_.name,VIEWTYPE:"list",[N]:JSON.stringify({fields:_.selectedFields.filter((e=>e.name)).map((e=>e.name)),orderby:g.value,filter:_.saveFilter?a.query.filter||void 0:e?.[N].filter}),[y]:O.value||_.defaultView?1:0}}}()),await async function(e){let t=!0;i.loadStart(`list/${C.value}/list-edit/save`);const{responses:a}=await function(e,t,a,n={},{withoutDialog:l=!1}={}){return Le(Symbol("requestPost"),(()=>o.odata.requestPost([m,e].flat(),t,a,{Authorization:T().jwt,...n})),l)}("$batch",{requests:e});return a.some((e=>201!==e.status&&204!==e.status))&&(i.alert({title:"Error",message:"Error inesperat"}),t=!1),i.loadEnd(`list/${C.value}/list-edit/save`),t}(e)&&(await s.loadViews(C.value,!0),l.push({path:`/${C.value}/view/query/${_.name}`,query:{orderby:g.value,filter:s.definitions.find((e=>e[I]===_.name))?.[N].filter}}))}}function D(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquesta visualització?. Aquesta acció no es pot desfer.",accept:async()=>{await Ue(`${E}(${c.value})`),await s.loadViews(C.value,!0),l.push(`/${C.value}`)}})}function v(){S(s.definitions.find((e=>e[I]===u.value)))}function R(){a.query.return?l.push(a.query.return):l.push(`/${C.value}/view/query/${_.name}`)}return(t,a)=>{const l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-separator"),o=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-checkbox"),s=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"baseLayout",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Rl,[(0,n.createVNode)(i,{class:"separatorLlista","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Llista")])),_:1})])),_:1}),(0,n.createVNode)(o,{required:"",name:"name",class:"name",label:"Nom de la visualització","error-message":_.nameErrorMessage,modelValue:_.name,"onUpdate:modelValue":[a[0]||(a[0]=e=>_.name=e),a[1]||(a[1]=e=>_.nameErrorMessage=null)]},null,8,["error-message","modelValue"]),(0,n.createElementVNode)("div",hl,[(0,n.createVNode)(r,{name:"defaultView",label:"Visualització per defecte",disabled:(0,n.unref)(O),"model-value":(0,n.unref)(O)||_.defaultView,"onUpdate:modelValue":a[2]||(a[2]=e=>_.defaultView=e)},null,8,["disabled","model-value"]),(0,n.createVNode)(r,{name:"saveFilter",label:"Guardar el filtre actual",modelValue:_.saveFilter,"onUpdate:modelValue":a[3]||(a[3]=e=>_.saveFilter=e)},null,8,["modelValue"])]),(0,n.createVNode)(i,{class:"separatorColumnes","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Columnes")])),_:1})])),_:1}),(0,n.createVNode)((0,n.unref)(vl),{class:"fields",fields:(0,n.unref)(f),modelValue:_.selectedFields,"onUpdate:modelValue":[a[4]||(a[4]=e=>_.selectedFields=e),a[5]||(a[5]=e=>_.showErrorMessage=!1)]},null,8,["fields","modelValue"]),(0,n.createElementVNode)("div",Ll,[(0,n.createVNode)(s,{primary:"",text:"Guardar",icon:"Save",onClick:b}),(0,n.createVNode)(s,{text:"Tornar",icon:"Back",onClick:R}),(0,n.createVNode)(s,{text:"Reiniciar",icon:"Refresh",onClick:v}),null!==(0,n.unref)(u)?((0,n.openBlock)(),(0,n.createBlock)(s,{key:0,primary:"",class:"remove",text:"Eliminar",icon:"Delete",onClick:D})):(0,n.createCommentVNode)("v-if",!0)]),_.showErrorMessage?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"errorMessage",type:"error",dismiss:"",onDismiss:a[6]||(a[6]=e=>_.showErrorMessage=!1)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Cal seleccionar alguna columna. ")])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])),_:1},8,["subtitle"])}}},Ul=(0,R.Z)(xl,[["__scopeId","data-v-6591ad77"]]);function Ml(e,t){const a=(0,n.ref)(!1),l=Ye((0,n.unref)(e)),i=(0,n.ref)();return(0,n.watch)((()=>(0,n.unref)(t)),(async t=>{a.value=!1,null!=t?await function(e,t){const a=T();return(0,o.entityLoad)(e,m,{Authorization:a.jwt},t)}(l,t):Ve((0,n.unref)(e),l),i.value=(0,o.entityData)(l,{depth:0}),a.value=!0}),{immediate:!0}),{entityLoaded:a,entity:l,initialData:i,resetEntity(){for(const e in i.value)l[e]=i.value[e]},entitySave(){Je(l)},entityDelete(){Qe(l)}}}const Pl={__name:"list-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=he(),s=(0,o.useValidations)(),d=pt(),{goBack:u}=Dn(),{sendMessage:c,close:m}=Xa(),{itemId:E}=On("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{tabName:p}=On("tabName"),{popup:A}=Sn("popup");d.setContextName(t.list.name),d.load(t.list.name);const{entityLoaded:I,entity:N,resetEntity:y}=Ml(t.list,E);let C=!1;const f=(0,n.ref)({});(0,n.watch)(I,(e=>{e&&(f.value=t.list.permissionDenied?.(N)??{},C&&(0,n.nextTick)((()=>{C=!1,ea(N)})))}),{immediate:!0});const _=(0,n.computed)((()=>null==E.value?!f.value.create:!f.value.edit));Jt(),(0,n.onMounted)((()=>{I.value?ea(N):C=!0})),(0,n.onUnmounted)(Qt);const T=t.list.fields.find((e=>e.primary)).name,g=(0,n.computed)((()=>N[T]));s.createField(T,g);const O=(0,n.computed)((()=>t.list.form.tabs?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function S(e){e(N)}function b(e){l.push({path:null==E.value?`/${t.list.name}/create/tab/${e}`:`/${t.list.name}/edit/${E.value}/tab/${e}`,query:{return:a.query.return,popup:A.value}})}async function D(){await s.validate(N)&&await Ln((async()=>{await Je(N),u(`/${t.list.name}`,null,{reload:!0})}))}async function v(){await s.validate(N)&&await Ln((async()=>{await Je(N),c({action:"save"}),m()}))}function R(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){y(),(0,n.nextTick)((()=>ea(N)))}})}function h(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){await Ln((async()=>{await Qe(N),u(`/${t.list.name}`,null,{reload:!0})}))}})}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(I)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(qa),{key:0,tabs:(0,n.unref)(O),"current-tab":(0,n.unref)(p),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":(0,n.unref)(_)&&void 0===(0,n.unref)(A),"has-save-and-close":(0,n.unref)(_)&&void 0!==(0,n.unref)(A),"has-reset":"","has-remove":null!==(0,n.unref)(E)&&!f.value.delete,"has-go-back":void 0===(0,n.unref)(A),"has-close":void 0!==(0,n.unref)(A),"onUpdate:currentTab":b,onSave:D,onSaveAndClose:v,onReset:R,onRemove:h,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(u)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hn),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(N),validations:(0,n.unref)(s),onChange:S},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(N),validations:(0,n.unref)(s),onChange:S},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{entity:(0,n.unref)(N),validations:(0,n.unref)(s),onChange:S},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-remove","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},Vl=(0,R.Z)(Pl,[["__scopeId","data-v-5bb720f8"]]),Fl={__name:"list-item-tab-subform",props:{list:{type:Object,required:!0},subform:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,n.computed)((()=>t.list.entityName||t.list.name)),l=(0,n.computed)((()=>pn(t.list,t.subform.fields(t.entity))));return(t,i)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.subform.class)},[(0,n.createVNode)((0,n.unref)($t),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(a),onChange:i[0]||(i[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations","cache-name"])],2))}},wl=Fl,Gl={key:0},Bl={class:"cellactions"},kl={key:0},$l={key:1},ql={__name:"details-view-edit",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["edit","create","update:orderby","clickCell"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>[...a.readonly?[]:[{key:"actions",width:"25px"}],...a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Pe(e),l=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:An(l),width:e.detailsColumn?.width,align:e.detailsColumn?.align}}}))]));function i(e){const{index:n}=l.value[e];if(null!=n){const l=Pe(a.fields[n]);if(l){const n=a.orderby.map((e=>({...e}))),i=n.findIndex((e=>e.sentence===l));if(i>-1){const e=n[i];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(i,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Pe(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:l,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),i=a[1]<e?a[0]+1:a[0];n.splice(i,0,{sentence:l,direction:"asc"})}}t("update:orderby",n)}}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-button"),s=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)(s,{columns:(0,n.unref)(l),data:e.data,"auto-layout":e.autoLayout,compact:e.compact,onClickHeader:i,onClickCell:o[1]||(o[1]=e=>t("clickCell",e))},{default:(0,n.withCtx)((l=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda.\n        @binding {number} rowIndex Índice de la fila.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {string} content Contenido de la celda.\n        @binding {object} column Referencia a la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"default",{rowIndex:l.rowIndex,row:e.data[l.rowIndex],columnIndex:l.columnIndex,column:l.column,content:l.content},(()=>["actions"===l.column.key?((0,n.openBlock)(),(0,n.createElementBlock)("div",Gl,[(0,n.createElementVNode)("div",Bl,[(0,n.createVNode)(r,{type:"icon",icon:"Edit",onClick:e=>t("edit",l.rowIndex)},null,8,["onClick"])])])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(kt)[l.column.type].detailsCell),{key:1,field:e.fields[l.column.index],row:e.data[l.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una cabecera.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {number} index Índice de la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"header",{column:e.column,index:e.index})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un encabezado de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((l=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un pie de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyFooter",{groupIndex:l?.groupIndex,group:l?.group,columnIndex:l?.columnIndex,column:l?.column,data:l?.data},(()=>["actions"!==l?.column?.key||e.readonly?((0,n.openBlock)(),(0,n.createElementBlock)("div",$l)):((0,n.openBlock)(),(0,n.createElementBlock)("div",kl,[(0,n.createVNode)(r,{type:"icon",icon:"Add",onClick:o[0]||(o[0]=e=>t("create"))})]))]))])),_:3},8,["columns","data","auto-layout","compact"])}}},jl={__name:"list-item-tab-details",props:{list:{type:Object,required:!0},child:{type:Object,required:!0},entity:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),{orderby:i,updateOrderby:o}=Sn("orderby",{parse:In,stringify:Nn}),s=(0,n.computed)((()=>En(t.child.listName))),d=(0,n.computed)((()=>t.child.fields.map((e=>s.value.fields.find((t=>t.name===e)))).filter((e=>e)))),u=(0,n.computed)((()=>t.entity[t.child.navigationKey||t.child.listName])),{sortedData:c}=na(u,i);function m(){const e=a.params.itemId,n=a.params.tabName;l.push({path:null==e?`/${t.list.name}/create/tab/${n}/create`:`/${t.list.name}/edit/${e}/tab/${n}/create`,query:a.query})}function E(e){const n=a.params.itemId,i=a.params.tabName;l.push({path:null==n?`/${t.list.name}/create/tab/${i}/edit/${e}`:`/${t.list.name}/edit/${n}/tab/${i}/edit/${e}`,query:a.query})}return(a,l)=>{const r=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(ql),{fields:(0,n.unref)(d),data:(0,n.unref)(c),orderby:(0,n.unref)(i),"auto-layout":e.child.autoLayout,readonly:e.child.readonly||!e.child.form,compact:"",onCreate:m,onEdit:E,"onUpdate:orderby":l[0]||(l[0]=e=>(0,n.unref)(o)(e))},null,8,["fields","data","orderby","auto-layout","readonly"]),(0,n.createVNode)(r,{list:e.list,entity:t.entity,onChange:l[1]||(l[1]=e=>a.$emit("change",e))},null,8,["list","entity"])],64)}}},Kl=jl,zl={__name:"list-item-tab",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,{tabName:l}=On("tabName"),i=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===l.value))));return(a,l)=>"child"===(0,n.unref)(i).type?((0,n.openBlock)(),(0,n.createBlock)(Kl,{key:0,list:e.list,child:(0,n.unref)(i),entity:e.entity,onChange:l[0]||(l[0]=e=>t("change",e))},null,8,["list","child","entity"])):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},["auto"===(0,n.unref)(i).component?((0,n.openBlock)(),(0,n.createBlock)(wl,{key:0,list:e.list,subform:(0,n.unref)(i),entity:e.entity,validations:e.validations,onChange:l[1]||(l[1]=e=>t("change",e))},null,8,["list","subform","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(i).component),{key:1,list:e.list,child:(0,n.unref)(i),entity:e.entity,validations:e.validations,onChange:l[2]||(l[2]=e=>t("change",e))},null,40,["list","child","entity","validations"]))],64))}},Zl={__name:"list-item-tab-child",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){const a=e;(0,n.useCssVars)((e=>({"4c00a527":(0,n.unref)(b)})));const l=(0,r.useRoute)(),i=(0,r.useRouter)(),s=he(),d=(0,o.useValidations)(),{sendMessage:u}=Xa(),c=(0,n.ref)(!1),{itemId:m}=On("itemId",{parse:e=>null!=e?Number(e):null}),{childId:E}=On("childId",{parse:e=>e?Number(e):null,handleLeave:!0}),{tabName:p}=On("tabName"),{popup:A}=Sn("popup"),I=(0,n.computed)((()=>a.list.permissionDenied?.(a.entity)??{})),N=(0,n.computed)((()=>null==m.value?!I.value.create:!I.value.edit)),y=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===p.value)))),C=(0,n.computed)((()=>En(y.value.listName))),f=(0,n.ref)({}),_=(0,n.getCurrentScope)();function T(e){const t=y.value.navigationKey||y.value.listName;null==e?(f.value=a.entity[t].create(),Ve(C.value,f.value,{notOverwrite:!0})):f.value=(0,o.entityClone)(a.entity[t][e],{scope:_}),c.value&&(0,n.nextTick)((()=>ea(f.value)))}Jt(),(0,n.onMounted)((()=>{c.value=!0,T(E.value)})),(0,n.onUnmounted)(Qt);const g=a.list.fields.find((e=>e.primary)).name,O=(0,n.computed)((()=>f.value[g]));d.createField(g,O);const S=(0,n.computed)((()=>null===E.value?"Entrada nou element":"Modificació")),b=(0,n.computed)((()=>y.value.form.maxWidth));function D(e){e(f.value)}async function v(){if(await d.validate(f.value)){const e=y.value.navigationKey||y.value.listName;return a.splitted?await Ln((async()=>{if(await Je(f.value),null==E.value){const e=y.value.navigationKey||y.value.listName;a.entity[e].add(f.value)}void 0!==A.value&&u({action:"save"})})):null==E.value?t("change",(t=>{t[e].add(f.value)})):t("change",(t=>{(0,o.entitySyncState)(t[e][E.value],f.value)})),!0}return!1}function R(){c.value=!1,(0,n.nextTick)((()=>i.push({path:null===m.value?`/${a.list.name}/create/tab/${p.value}`:`/${a.list.name}/edit/${m.value}/tab/${p.value}`,query:l.query})))}async function h(){await v()&&R()}async function L(){await v()&&(i.push({path:null===m.value?`/${a.list.name}/create/tab/${p.value}/create`:`/${a.list.name}/edit/${m.value}/tab/${p.value}/create`,query:l.query}),T())}function x(){s.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){T(E.value)}})}function U(){s.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){const e=y.value.navigationKey||y.value.listName;a.splitted?await Ln((async()=>{await Qe(f.value)})):t("change",(t=>{t[e].delete(E.value)})),R()}})}return(e,t)=>{const a=(0,n.resolveComponent)("fura-dialog"),l=(0,n.resolveComponent)("fura-overlay"),i=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(i,{open:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"listItemEditTabChild-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[c.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,class:"listItemEditTabChild-dialog",header:(0,n.unref)(S)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(qa),{"max-width":(0,n.unref)(b),"self-aling":(0,n.unref)(y).form.selfAlign,"has-save":(0,n.unref)(N),"has-save-and-new":(0,n.unref)(N),"has-reset":"","has-remove":null!==(0,n.unref)(E)&&((0,n.unref)(N)||!(0,n.unref)(I).delete),"has-go-back":"",onSave:h,onSaveAndNew:L,onReset:x,onRemove:U,onGoBack:R},{default:(0,n.withCtx)((()=>["auto"===(0,n.unref)(y).form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hn),{key:0,list:(0,n.unref)(C),form:(0,n.unref)(y).form,entity:f.value,validations:(0,n.unref)(d),onChange:D},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(y).form.component),{key:1,entity:f.value,validations:(0,n.unref)(d),onChange:D},null,40,["entity","validations"]))])),_:1},8,["max-width","self-aling","has-save","has-save-and-new","has-remove"])])),_:1},8,["header"])):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1})}}},Xl=(0,R.Z)(Zl,[["__scopeId","data-v-5697d378"]]),Wl={class:"dialogFooter"},Hl={__name:"list-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),{itemId:i}=On("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0});function o(){a.push({path:`/${t.list.name}/view/query/${l.query.viewName}`,query:{...l.query,viewName:void 0}})}return(r,s)=>{const d=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"itemListEdit-container","hide-menu":"",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:"Esteu segurs que voleu esborrar l'element?",onClick:o},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Wl,[(0,n.createVNode)(d,{primary:"",text:"Eliminar",onClick:s[0]||(s[0]=e=>async function(){await Ln((async()=>{await Ue(`${t.list.name}(${i.value})`),a.push({path:`/${t.list.name}/view/query/${l.query.viewName}`,query:{...l.query,selectedItemId:void 0,viewName:void 0}})}))}())}),(0,n.createVNode)(d,{text:"Cancel·lar",onClick:o})])])),_:1})])),_:1})])),_:1},8,["subtitle"])}}};function Yl(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.ListDetailsDefault??Bn,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:e.routes?.overrideControls?.ListDetails??$n,props:{list:e},children:[{path:"filter",component:e.routes?.overrideControls?.ListDetailsFilterPanel??El,props:{list:e}},{path:"export",component:e.routes?.overrideControls?.ListDetailsExport??_l,props:{list:e}},...e.routes?.detailsListChildRoutes??[]]},{path:`/${e.name}/view/grid/:viewName`,component:e.routes?.overrideControls?.ListDetailsGrid??Qn,props:{list:e}},{path:`/${e.name}/view/create`,component:e.routes?.overrideControls?.ListViewEdit??Ul,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:e.routes?.overrideControls?.ListViewEdit??Ul,props:{list:e}},{path:`/${e.name}/create`,component:e.routes?.overrideControls?.ListItemEdit??Vl,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??zl,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e}}]}]},{path:`/${e.name}/edit/:itemId`,component:e.routes?.overrideControls?.ListItemEdit??Vl,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??zl,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e}}]}]},{path:`/${e.name}/delete/:itemId`,component:e.routes?.overrideControls?.ListItemDelete??Hl,props:{list:e}},...e.routes?.cusomRoutes??[]]}const Jl={__name:"list-item-create",props:{list:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=he(),s=(0,o.useValidations)(),d=pt(),{goBack:u}=Dn(),{sendMessage:c,close:m}=Xa(),{tabName:E}=On("tabName"),{popup:p}=Sn("popup");d.setContextName(t.list.name),d.load(t.list.name);const{entityLoaded:A,entity:I,resetEntity:N}=Ml(t.list);Jt(),(0,n.onMounted)((()=>ea(I))),(0,n.onUnmounted)(Qt);const y=t.list.fields.find((e=>e.primary)).name,C=(0,n.computed)((()=>I[y]));s.createField(y,C);const f=(0,n.computed)((()=>t.list.permissionDenied?.()??{})),_=(0,n.computed)((()=>t.list.form.tabs?.filter((e=>"child"!==e.type))?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function T(e){e(I)}function g(e){l.push({path:`/${t.list.name}/create/tab/${e}`,query:{return:a.query.return,popup:p.value}})}async function O(){await s.validate(I)&&await Ln((async()=>{await Je(I),u(`/${t.list.name}`,null,{reload:!0})}))}async function S(){await s.validate(I)&&await Ln((async()=>{await Je(I),c({action:"save"}),m()}))}function b(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){N(),(0,n.nextTick)((()=>ea(I)))}})}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(A)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(qa),{key:0,tabs:(0,n.unref)(_),"current-tab":(0,n.unref)(E),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":!(0,n.unref)(f).create&&void 0===(0,n.unref)(p),"has-save-and-close":!(0,n.unref)(f).create&&void 0!==(0,n.unref)(p),"has-reset":"","has-go-back":void 0===(0,n.unref)(p),"has-close":void 0!==(0,n.unref)(p),"onUpdate:currentTab":g,onSave:O,onSaveAndClose:S,onReset:b,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(u)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(hn),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(I),validations:(0,n.unref)(s),onChange:T},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(I),validations:(0,n.unref)(s),onChange:T},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{entity:(0,n.unref)(I),validations:(0,n.unref)(s),onChange:T},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},Ql=(0,R.Z)(Jl,[["__scopeId","data-v-a1813330"]]);function ei(e){return[{path:`/${e.name}`,component:e.routes?.overrideControls?.ListDetailsDefault??Bn,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:e.routes?.overrideControls?.ListDetails??$n,props:{list:e},children:[{path:"filter",component:e.routes?.overrideControls?.ListDetailsFilterPanel??El,props:{list:e}},{path:"export",component:e.routes?.overrideControls?.ListDetailsExport??_l,props:{list:e}},...e.routes?.detailsListChildRoutes??[]]},{path:`/${e.name}/view/grid/:viewName`,component:e.routes?.overrideControls?.ListDetailsGrid??Qn,props:{list:e}},{path:`/${e.name}/view/create`,component:e.routes?.overrideControls?.ListViewEdit??Ul,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:e.routes?.overrideControls?.ListViewEdit??Ul,props:{list:e}},{path:`/${e.name}/create`,component:e.routes?.overrideControls?.ListItemCreate??Ql,props:{list:e},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??zl,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e,splitted:!0}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/edit/:itemId`,component:e.routes?.overrideControls?.ListItemEdit??Vl,props:{list:e,splitted:!0},children:[{path:"tab/:tabName",component:e.routes?.overrideControls?.ListItemTab??zl,props:{list:e},children:[{path:"create",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e,splitted:!0}},{path:"edit/:childId",component:e.routes?.overrideControls?.ListItemTabChild??Xl,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/delete/:itemId`,component:e.routes?.overrideControls?.ListItemDelete??Hl,props:{list:e}},...e.routes?.cusomRoutes??[]]}const ti={dictionary:e,listJoined:t,listSplitted:a},ai={class:"layout"},ni={class:"form"},li={class:"logo"},ii=["src"],oi=["onSubmit"],ri={class:"label"},si={style:{"font-weight":"600"}},di=(e=>((0,n.pushScopeId)("data-v-6fd09a82"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),ui={class:"buttons"},ci={class:"recovery"},mi={__name:"user-login",setup(e){const t=(0,r.useRouter)(),a=T(),l=he(),i=(0,n.reactive)({username:"",password:""});async function o(e){l.loadStart("user-login");const n=await fetch(`${m}/authenticator/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(200===n.status){const e=await n.text();a.setJwt(e),t.push(C)}else if(401===n.status){const e=await n.text();l.alert({title:"Error:",message:e})}else l.alert({title:"Error:",message:"Error inesperat."});l.loadEnd("user-login")}return(0,n.onMounted)((()=>{a.jwt&&t.push(C)})),(e,a)=>{const l=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-link");return(0,n.openBlock)(),(0,n.createElementBlock)("div",ai,[(0,n.createElementVNode)("div",ni,[(0,n.createElementVNode)("div",li,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(s)}/images/logo.png`,width:"160"},null,8,ii)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(o,["prevent"])},[(0,n.createElementVNode)("div",ri,[(0,n.createElementVNode)("span",si,(0,n.toDisplayString)((0,n.unref)(c)),1),di,(0,n.createTextVNode)(" Entrada al sistema ")]),(0,n.createVNode)(l,{label:"Nom d'usuari",icon:"Contact",modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e)},null,8,["modelValue"]),(0,n.createVNode)(l,{label:"Clau d'acces",password:"",icon:"Permissions",modelValue:i.password,"onUpdate:modelValue":a[1]||(a[1]=e=>i.password=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",ui,[(0,n.createVNode)(r,{primary:"",text:"Entra","form-role":"submit"}),(0,n.createElementVNode)("div",ci,[(0,n.createVNode)(d,{onClick:a[2]||(a[2]=e=>(0,n.unref)(t).push("/password-reset-request"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Recupera la clau d'acces ")])),_:1})])])],40,oi)])])}}},Ei=(0,R.Z)(mi,[["__scopeId","data-v-6fd09a82"]]),pi=e=>((0,n.pushScopeId)("data-v-b0180da2"),e=e(),(0,n.popScopeId)(),e),Ai={class:"layout"},Ii={class:"form"},Ni={class:"logo"},yi=["src"],Ci=["onSubmit"],fi={class:"label"},_i={style:{"font-weight":"600"}},Ti=pi((()=>(0,n.createElementVNode)("br",null,null,-1))),gi=pi((()=>(0,n.createElementVNode)("br",null,null,-1))),Oi={class:"buttons"},Si={__name:"user-password-reset-request",setup(e){const t=(0,r.useRouter)(),a=he(),l=(0,n.ref)("");async function i(e){a.loadStart("password-reset"),200===(await fetch(`${m}/authenticator/requestResetPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Username:l.value})})).status?a.alert({title:"Acceptat!",message:"Sol·licitud acceptada, en breu rebrà un correu electronic amb les instruccions.",close:()=>t.push(C)}):a.alert({title:"Error",message:"No s'ha trobat l'usuari."}),a.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ai,[(0,n.createElementVNode)("div",Ii,[(0,n.createElementVNode)("div",Ni,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(s)}/images/logo.png`,width:"160"},null,8,yi)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(i,["prevent"])},[(0,n.createElementVNode)("div",fi,[(0,n.createElementVNode)("span",_i,(0,n.toDisplayString)((0,n.unref)(c)),1),Ti,(0,n.createTextVNode)(" Sol·licitar una nova clau d'accés "),gi]),(0,n.createVNode)(a,{label:"Nom d'usuari o adreça de correu electronic",icon:"Contact",modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",Oi,[(0,n.createVNode)(o,{primary:"",text:"Sol·licitar canvi de clau d'acces","form-role":"submit"})])],40,Ci)])])}}},bi=(0,R.Z)(Si,[["__scopeId","data-v-b0180da2"]]),Di=e=>((0,n.pushScopeId)("data-v-833874ce"),e=e(),(0,n.popScopeId)(),e),vi={class:"layout"},Ri={class:"form"},hi={class:"logo"},Li=["src"],xi=["onSubmit"],Ui={class:"label"},Mi={style:{"font-weight":"600"}},Pi=Di((()=>(0,n.createElementVNode)("br",null,null,-1))),Vi=Di((()=>(0,n.createElementVNode)("br",null,null,-1))),Fi={class:"showChars"},wi={class:"buttons"},Gi={__name:"user-password-reset",setup(e){const t=(0,r.useRoute)(),a=(0,r.useRouter)(),l=he(),i=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(!1);async function u(e){l.loadStart("password-reset");const n=await fetch(`${m}/authenticator/resetPassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.query.token},body:JSON.stringify({password:i.value})});if(200===n.status)l.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>a.push(C)});else if(401===n.status){const e=await n.text();l.alert({title:"Error",message:e})}else l.alert({title:"Error",message:"Error inesperat"});l.loadEnd("password-reset")}return(0,n.onMounted)((()=>{t.query.token||a.push(C)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),l=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",vi,[(0,n.createElementVNode)("div",Ri,[(0,n.createElementVNode)("div",hi,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(s)}/images/logo.png`,width:"160"},null,8,Li)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(u,["prevent"])},[(0,n.createElementVNode)("div",Ui,[(0,n.createElementVNode)("span",Mi,(0,n.toDisplayString)((0,n.unref)(c)),1),Pi,(0,n.createTextVNode)(" Establir la clau d'accés "),Vi]),(0,n.createVNode)(a,{label:"Clau d'acces",password:!d.value,icon:"Permissions",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir clau d'acces",password:!d.value,icon:"RepeatAll",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",Fi,[(0,n.createVNode)(l,{inline:"",label:"Mostrar caracters ",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",wi,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!i.value||i.value!==o.value,"form-role":"submit"},null,8,["disabled"])])],40,xi)])])}}},Bi=(0,R.Z)(Gi,[["__scopeId","data-v-833874ce"]]),ki={class:"layout"},$i={class:"form"},qi={class:"logo"},ji=["src"],Ki=["onSubmit"],zi={class:"label"},Zi=["textContent"],Xi=(e=>((0,n.pushScopeId)("data-v-b4240742"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),Wi={class:"showChars"},Hi={class:"buttons"},Yi={__name:"user-password-change",setup(e){const t=(0,r.useRouter)(),a=T(),l=he(),i=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(""),u=(0,n.ref)(!1);async function E(e){l.loadStart("password-reset");const n=await fetch(`${m}/authenticator/changePassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:a.jwt},body:JSON.stringify({oldPassword:i.value,newPassword:o.value})});if(406===n.status)l.alert({title:"Error",message:"Antiga clau d'acces incorrecte."});else if(200===n.status)l.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>{a.setJwt(),t.push(C)}});else if(401===n.status){const e=await n.text();l.alert({title:"Error",message:e})}else l.alert({title:"Error",message:"Error inesperat"});l.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),l=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{class:"baseLayout",subtitle:"Canvi de clau d'acces"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ki,[(0,n.createElementVNode)("div",$i,[(0,n.createElementVNode)("div",qi,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(s)}/images/logo.png`,width:"160"},null,8,ji)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(E,["prevent"])},[(0,n.createElementVNode)("div",zi,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(c))},null,8,Zi),Xi,(0,n.createTextVNode)(" Canviar la paraula clau ")]),(0,n.createVNode)(a,{class:"oldPassword",label:"Antiga clau d'acces",password:!u.value,icon:"Permissions",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Nova clau d'acces",password:!u.value,icon:"PasswordField",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir nova clau d'acces",password:!u.value,icon:"RepeatAll",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",Wi,[(0,n.createVNode)(l,{inline:"",label:"Mostrar caracters ",modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=e=>u.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",Hi,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!o.value||o.value!==d.value,"form-role":"submit"},null,8,["disabled"])])],40,Ki)])])])),_:1})}}},Ji=(0,R.Z)(Yi,[["__scopeId","data-v-b4240742"]]),Qi={__name:"home-view",setup:e=>(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Inici"}))},eo={class:"notFound-buttons"},to={__name:"not-found",setup:e=>(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"notFound-overlay"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"notFound-dialog",header:"Error!",text:"Aquesta pàgina no esta definida."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",eo,[(0,n.createVNode)(a,{icon:"Home",text:"Ves al inci",onClick:t[0]||(t[0]=t=>e.$router.push((0,n.unref)(C)))}),(0,n.createVNode)(a,{icon:"Back",text:"Torna enrere.",onClick:t[1]||(t[1]=t=>e.$router.go(-1))})])])),_:1})])),_:1})])),_:1})}},ao=(0,R.Z)(to,[["__scopeId","data-v-5023a390"]]);function no(e,t=0){const a=e.indexOf('"',t);return-1===a?-1:'"'!==e.charAt(a+1)?a+1:no(e,a+2)}function lo(e,t=0){if('"'===e.charAt(t)){const a=no(e,t+1);return[e.substring(t+1,a-1).replaceAll('""','"'),a]}{const a=/;|\n/g;a.lastIndex=t;const n=a.test(e)?a.lastIndex-1:e.length;return[e.substring(t,n),n]}}function io(e,t){let a=null,n=t-1;const l=[];do{[a,n]=lo(e,n+1),l.push(a)}while("\n"!==e.charAt(n)&&n<e.length);return[l,n+1]}const oo=Symbol("rowNum"),ro={integer:e=>""===e||/^-?\d+$/.test(e),decimal:e=>/^-?[0-9.]+(,\d+)?$/.test(e),dateDMY(e){if(""===e)return!0;const t=new Date(e.split("/").reverse().join("/"));return t instanceof Date&&!isNaN(t)},date(e){if(""===e)return!0;const t=/^([0-3]?\d)\/([0-1]?\d)\/(\d{4})$/.exec(e);if(t&&t.length>3){const e=Number(t[1]),a=Number(t[2])-1,n=Number(t[3]),l=new Date(n,a,e);return e===l.getDate()&&a===l.getMonth()&&n===l.getFullYear()}return!1},boolean:e=>""===e||/^(0|no|false|1|sí|si|true)$/i.test(e),nivell:e=>""===e||g.nivells.filter((t=>t.text===e)).length>0,districte:e=>""===e||g.importDistricte.filter((t=>t.value===e)).length>0,centre(e){const t=we();return""===e||t.data.GEN_CENTRE.filter((t=>t.CODI_CENTRE===e)).length>0},eap(e){const t=we();return""===e||t.data.GEN_EAP.filter((t=>t.NOM===e)).length>0},estatNEE:e=>""===e||g.estatsNEE.filter((t=>t.value===e)).length>0,acordsNEEA:e=>""===e||g.acordsNEEA.filter((t=>t.value===e)).length>0,motiusNese(e){const t=we();return""===e||t.data.GEN_MOTIU_NESE.filter((t=>t.MOTIU_NESE===e)).length>0},tipusEscolaritzacio:e=>""===e||g.tipusEscolaritzacio.filter((t=>t.value===e)).length>0,tipusGedac:e=>""!==e&&g.tipusAlumneGEDAC.filter((t=>t.text===e)).length>0,simultaneitat:e=>!0,email:e=>""===e||/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/.test(e),phone:e=>""===e||/^\d{9}$/.test(e)},so=(0,l.defineStore)({id:"csvData",state:()=>({motiusNese:[],centres:[],tipus:null,idEtapa:null,idOrigen:null,referencia:null,title:null,buttonTitle:null,schema:[],columns:[],data:[],invalidCells:new Map}),actions:{saveCsvData(e,t,a,n,l,i){this.tipus=e,this.title=t,this.buttonTitle=a,this.schema=n,this.columns=l,this.data=i},setOrigen({tipus:e,idEtapa:t,idOrigen:a,referencia:n}){this.tipus=e,this.idEtapa=t,this.idOrigen=a,this.referencia=n},setSchemaColumn({index:e,column:t}){this.schema[e].column=t},validateRow(e){const t=this.data[e],a=this.schema.filter((e=>e.column)).filter((e=>e.required&&""===t[e.column]||e.type&&!ro[e.type](t[e.column])));a.length>0?this.invalidCells.set(e,a):this.invalidCells.delete(e)},updateRow(e,t){this.updateRowData(e,t),this.validateRow(e)},updateRowData(e,t){for(let a=1;a<t.length;a+=1)this.data[e][a]=t[a]},validateAll(){this.invalidCells.clear();for(let e=0;e<this.data.length;e+=1)this.validateRow(e)}}}),uo={neea:[{name:"IDALU",title:"IDALU"},{name:"NOM",title:"NOM ALUMNE",required:!0},{name:"COGNOM1",title:"1ER COGNOM",required:!0},{name:"COGNOM2",title:"2ON COGNOM"},{name:"DATA_NAIXEMENT",title:"DATA NAIXEMENT",type:"dateDMY"},{name:"IDENTIFICACIO_FISCAL",title:"ID.FISCAL"},{name:"ID_NIVELL",title:"NIVELL PREVIST",type:"nivell",options:g.nivells},{name:"ADRECA_RESIDENCIA",title:"ADREÇA"},{name:"CP_RESIDENCIA",title:"CODI POSTAL",type:"integer"},{name:"ID_DISTRICTE_RESIDENCIA",title:"DISTRICTE",type:"districte",options:g.importDistricte},{name:"GERMANS_ESTUDIEN_BCN",title:"Germans escolaritzats a Barcelona",type:"boolean",options:g.importYesNo},{name:"GERMA_BESSO_ORDINARI",title:"Germà bessó no NEEA",type:"boolean",options:g.importYesNo},{name:"NOM_TUTOR1",title:"NOM TUTOR1"},{name:"COGNOMS_TUTOR1",title:"COGNOMS TUTOR1"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",title:"ID.FISCAL TUTOR1"},{name:"TELEFON_TUTOR1",title:"TELEFON TUTOR1",type:"phone"},{name:"EMAIL_TUTOR1",title:"EMAIL TUTOR1",type:"email"},{name:"NOM_TUTOR2",title:"NOM TUTOR2"},{name:"COGNOMS_TUTOR2",title:"COGNOMS TUTOR2"},{name:"IDENTIFICACIO_FISCAL_TUTOR2",title:"ID.FISCAL TUTOR2"},{name:"TELEFON_TUTOR2",title:"TELEFON TUTOR2",type:"phone"},{name:"EMAIL_TUTOR2",title:"EMAIL TUTOR2",type:"email"},{name:"ID_EAP",title:"EAP",type:"eap",options:g.eaps},{name:"ID_CENTRE_GERMANS",title:"Codi Centre del germà",type:"centre"},{name:"PROFESSIONAL_ASSIGNAT_NEEA",title:"email professional assignat"},{name:"ES_NEEA",title:"És NEE-A ?",type:"estatNEE",options:g.estatsNEE},{name:"TIPUS_ESCOLARITZACIO",title:"Tipus escolarització proposada",type:"tipusEscolaritzacio",options:g.tipusEscolaritzacio},{name:"ID_MOTIU_NESE1",title:"MOTIU NESE1",type:"motiusNese",options:g.motiusNese},{name:"ID_MOTIU_NESE2",title:"MOTIU NESE2",type:"motiusNese",options:g.motiusNese},{name:"ID_MOTIU_NESE3",title:"MOTIU NESE3",type:"motiusNese",options:g.motiusNese},{name:"ACORD_NEEA",title:"Acord / Desacord",type:"acordsNEEA",options:g.acordsNEEA},{name:"SIEI",title:"SIEI",options:g.importYesNo},{name:"SIAL",title:"SIAL",options:g.importYesNo},{name:"SENSE_BARRERES",title:"CENTRE SENSE BARRERES",options:g.importYesNo},{name:"ID_CENTRE_PROPOSAT1",title:"1r Centre proposat",type:"centre"},{name:"ID_CENTRE_PROPOSAT2",title:"2n Centre proposat",type:"centre"},{name:"ID_CENTRE_PROPOSAT3",title:"3er Centre proposat",type:"centre"},{name:"ID_CENTRE_COMPARTIDA",title:"Centre compartida",type:"centre"},{name:"RETENCIO",title:"Retenció",type:"boolean",options:g.importYesNo},{name:"CEEPSIR",title:"CEEPSIR",type:"boolean",options:g.importYesNo},{name:"CENTRE_CRAE",title:"CENTRE CRAE",type:"boolean",options:g.importYesNo},{name:"ACOLLIMENT_DGAIA",title:"ACOLLIDA DGAIA",type:"boolean",options:g.importYesNo},{name:"INSCRIPCIOFINAL_NEEA",title:"Preinscripció final",options:g.preinscripcioFinalImport},{name:"NUM_SOLICITUD_EE",title:"Preinscripció educació especial"}],pers:[{name:"NUM_SOLICITUD",title:"Codi sol·licitud",required:!0},{name:"ESTAT_SOLICITUD",title:"Estat sol·licitud"},{name:"IDALU_GEDAC",title:"Identificació RALC"},{name:"CODI_ENSENYAMENT",title:"Codi ensenyament P1"},{name:"CURS",title:"Curs P1"},{name:"CODI_CENTRE_1AOPCIO",title:"Codi centre P1",required:!0},{name:"CODI_CENTRE_PROCEDENCIA",title:"Codi centre proc."},{name:"TIPUS_ALUMNE",title:"Tipus Alumne",type:"tipusGedac",required:!0},{name:"NOM",title:"Nom",required:!0},{name:"COGNOM1",title:"Primer cognom",required:!0},{name:"COGNOM2",title:"Segon cognom"},{name:"DATA_NAIXEMENT",title:"Data naixement",type:"dateDMY",required:!0},{name:"NOM_VIA",title:"Nom via"},{name:"NUMERO_VIA",title:"Número via"},{name:"CP_RESIDENCIA",title:"CP"},{name:"MUNICIPI_RESIDENCIA",title:"Municipi residència",required:!0},{name:"TELEFON",title:"Telèfon"},{name:"EMAIL",title:"Correu electrònic"},{name:"DNI",title:"DNI"},{name:"NIE",title:"NIE"},{name:"PASS",title:"PASS"},{name:"TIS",title:"TIS"},{name:"NOM_TUTOR1",title:"Nom tutor 1"},{name:"COGNOM1_TUTOR1",title:"Primer cognom tutor 1"},{name:"COGNOM2_TUTOR1",title:"Segon cognom tutor 1"},{name:"IDENTIFICACIO_FISCAL_TUTOR1",title:"Núm. doc. tutor 1"},{name:"NOM_TUTOR2",title:"Nom tutor 2"},{name:"COGNOM1_TUTOR2",title:"Primer cognom tutor 2"},{name:"COGNOM2_TUTOR2",title:"Segon cognom tutor 2"},{name:"IDENTIFICACIO_FISCAL_TUTOR2",title:"Núm. doc. tutor 2"}],ofe:[{name:"CODI_CENTRE",title:"Codi centre",required:!0},{name:"CODI_ENSENYAMENT",title:"Codi ensenyament",required:!0},{name:"CURS",title:"Curs",required:!0},{name:"GRUPS",title:"Grup",required:!0},{name:"PLACES_INICIALS_ORDINARIES",title:"Plaça inicial ord.",required:!0},{name:"PLACES_INICIALS_NEEA",title:"Plaça inicial NEE-A"},{name:"PLACES_INICIALS_NEEB",title:"Plaça inicial NEE-B"},{name:"PREVISSIO_PROMOCIO_ORDINARIA",title:"Previsió promoció ord.",required:!0},{name:"PREVISSIO_PROMOCIO_NEEA",title:"Previsió promoció NEE-A"},{name:"PREVISSIO_PROMOCIO_NEEB",title:"Previsió promoció NEE-B"},{name:"PREVISSIO_REPETIDORS_ORDINARIA",title:"Previsió repetició ord."},{name:"PREVISSIO_REPETIDORS_NEEA",title:"Previsió repetició NEE-A"},{name:"PREVISSIO_REPETIDORS_NEEB",title:"Previsió repetició NEE-B"},{name:"OFERTA_ORDINARIA",title:"Oferta ord.",required:!0},{name:"OFERTA_NEEA",title:"Oferta NEE-A"},{name:"OFERTA_NEEB",title:"Oferta NEE-B"}],pets:[{name:"NUM_SOLICITUD",title:"Núm. sol·licitud",required:!0},{name:"IDALU",title:"Ident. RALC"},{name:"TIPUS_ALUMNE",title:"Tipus alumne",required:!0,type:"tipusGedac"},{name:"CODI_ENSENYAMENT",title:"Codi ensenyament P1"},{name:"CURS",title:"Curs",required:!0},{name:"TIPUS_ASSIGNACIO",title:"Tipus assignació"},{name:"CODI_CENTRE_P1",title:"Codi centre P1",required:!0},{name:"CODI_CENTRE_P2",title:"Codi centre P2"},{name:"CODI_CENTRE_P3",title:"Codi centre P3"},{name:"CODI_CENTRE_P4",title:"Codi centre P4"},{name:"CODI_CENTRE_P5",title:"Codi centre P5"},{name:"CODI_CENTRE_P6",title:"Codi centre P6"},{name:"CODI_CENTRE_P7",title:"Codi centre P7"},{name:"CODI_CENTRE_P8",title:"Codi centre P8"},{name:"CODI_CENTRE_P9",title:"Codi centre P9"},{name:"CODI_CENTRE_P10",title:"Codi centre P10"},{name:"CODI_CENTRE_P11",title:"Codi centre P11"},{name:"CODI_CENTRE_P12",title:"Codi centre P12"},{name:"CODI_CENTRE_P13",title:"Codi centre P13"},{name:"CODI_CENTRE_P14",title:"Codi centre P14"},{name:"CODI_CENTRE_P15",title:"Codi centre P15"},{name:"CODI_CENTRE_P16",title:"Codi centre P16"}],ass:[{name:"NUM_SOLICITUD",title:"Núm. sol·licitud",required:!0},{name:"ID_ALUMNE",title:"Ident. RALC"},{name:"CODI_ENSENYAMENT",title:"Codi ensenyament"},{name:"CURS",title:"Curs"},{name:"TIPUS_ASSIGNACIO",title:"Tipus assignació(desa)"},{name:"CODI_CENTRE_PROCEDENCIA",title:"Codi centre procedència"},{name:"CODI_CENTRE_ASSIGNAT",title:"Centre assignat"},{name:"SITUACIO_ACOLLIMENT",title:"Situació acolliment",required:!0,type:"boolean"},{name:"TRASLLAT_FORCOS",title:"Trasllat forçós",type:"boolean"},{name:"DEMANA_ASSIGNACIO_OFICI",title:"Demana assignació d'ofici",type:"boolean"}],barems:[{name:"NUM_SOLICITUD",title:"Núm. sol·licitud",required:!0},{name:"IDALU_GEDAC",title:"Ident. RALC"},{name:"TIPUS_ALUMNE",title:"Tipus alumne",type:"tipusGedac",required:!0},{name:"CODI_ENSENYAMENT",title:"Codi ensenyament"},{name:"CURS",title:"Curs"},{name:"FORA_TERMINI",title:"Fora termini",type:"boolean"},{name:"PENALITZA_DUPLICADA",title:"Penalitza duplicada",type:"boolean"},{name:"SIMULTANEITAT",title:"Simultaneïtat(Validat)",type:"simultaneitat"},{name:"ADSCRIPCIO",title:"Adscripció(Validat)",type:"boolean"},{name:"EXISTEIX_GERMA",title:"Existeix germà",type:"boolean"},{name:"GERMANS_ALCENTRE",title:"Germans(Validat)"},{name:"PARES_TREBALL_CENTRE",title:"Pares treball centre(Validat)"},{name:"PROXIMITAT_AL_CENTRE",title:"Proximitat al centre(Validat)"},{name:"RENDA_MINIMA_ALUMNE",title:"Renda Mínima(Alumne)"},{name:"RENDA_MINIMA",title:"Renda Mínima(Validat)"},{name:"DISCAPACITAT",title:"Discapacitat(Validat)"},{name:"FAMILIA_NOMBROSA",title:"Família nombrosa(Validat)"},{name:"FAMILIA_MONOPARENTAL",title:"Família monoparental(Validat)"},{name:"PART_MULTIPLE",title:"Part múltiple(Validat)"},{name:"ACOLLIMENT_FAMILIAR_ALUMNE",title:"Acolliment familiar(Alumne)"},{name:"ACOLLIMENT_FAMILIAR",title:"Acolliment familiar(Validat)"},{name:"VIOLENCIA_GENERE",title:"Violència gènere/terror.(Validat)"},{name:"SITUACIO_ACOLLIMENT",title:"Situació acolliment",type:"boolean"},{name:"TRASLLAT_FORCOS",title:"Trasllat forçós",type:"boolean"},{name:"NUMERO_DESEMPAT",title:"Número desempat"}]},co={__name:"load-csv",setup(e){const t=0,a=(0,n.ref)(null),l=(0,r.useRouter)(),i=(0,r.useRoute)(),o=he(),s=so(),d=we(),u=(0,n.reactive)({tipus:i.query.type});function c(e){e.dataTransfer.types.includes("Files")&&e.preventDefault()}function m(e){e.preventDefault(),this.dragCount=0,1!==e.dataTransfer.items.length||"file"!==e.dataTransfer.items[0].kind?this.onError("Cal carregar un arxiu CSV."):p(e.dataTransfer.items[0].getAsFile())}function E(e){1!==e.target.files.length?A("Cal carregar un arxiu CSV."):p(e.target.files[0])}function p(e){const t=new FileReader;t.addEventListener("load",(e=>{const t=(a=e.target.result,/\n/.test(a)?a:a.replaceAll("\r","\n"));var a;const[n,...i]=function(e){let t=0,a=null;const n=[],l=e.replaceAll("\r","");for(;t<l.length;)[a,t]=io(l,t),n.push(a);return n}(t),r=[oo,...n],d=i.map(((e,t)=>[t+2,...e]));r.length<10||r.length>240?o.alert({title:"Codificació o separador de camps i registres errònia"}):(s.saveCsvData(u.tipus,I,N,uo[u.tipus],r,d),l.push("/configuration"))})),t.addEventListener("error",(()=>{A("Error al interpretar l'arxiu CSV")})),t.readAsText(e)}function A(e){throw new Error(e)}d.loadDictionary("GEN_CENTRE"),d.loadDictionary("AANEE_ORIGEN_INFORMACIO"),d.loadDictionary("GEN_MOTIU_NESE"),d.loadDictionary("GEN_EAP"),(0,n.watch)((()=>i.params),(()=>{u.tipus=i.query.type,["neea","pers","ofe","pets","ass","barems"].includes(i.query.type)||l.push("/")}));const I=(0,n.computed)((()=>{switch(u.tipus){case"neea":return"Càrrega arxiu CSV alumnes NEE-A";case"pers":return"Càrrega dades personals GEDAC";case"ofe":return"Càrrega oferta educativa GEDAC";case"pets":return"Càrrega sol·licituds GEDAC";case"ass":return"Càrrega assignacions GEDAC";default:return"Càrrega barems GEDAC"}})),N=(0,n.computed)((()=>{switch(u.tipus){case"neea":return"Selecciona l'arxiu CSV alumnes NEE-A";case"pers":return"Selecciona l'arxiu de dades personals";case"ofe":return"Selecciona l'arxiu de dades oferta educativa";case"pets":return"Selecciona l'arxiu de sol·licituds";case"ass":return"Selecciona l'arxiu de assignacions";default:return"Selecciona l'arxiu de barems"}}));return(0,n.onMounted)((()=>{u.tipus=(0,n.ref)(i.query.type),["neea","pers","ofe","pets","ass","barems"].includes(i.query.type)||l.push("/")})),(e,l)=>{const i=(0,n.resolveComponent)("fura-label"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(I),class:"base"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["loadData",{dragging:t>0}]),onDragover:c,onDragenter:l[3]||(l[3]=e=>t+=1),onDragleave:l[4]||(l[4]=e=>t-=1),onDrop:m},[(0,n.createVNode)(i,{class:(0,n.normalizeClass)({dragging:t>0})},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Arrossega l'arxiu CSV ")])),_:1},8,["class"]),(0,n.createVNode)(i,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("o")])),_:1}),(0,n.createElementVNode)("input",{ref_key:"inputFile",ref:a,class:"formFile",type:"file",accept:".csv",onChange:E},null,544),(0,n.createVNode)(o,{text:(0,n.unref)(N),onClick:l[0]||(l[0]=t=>e.$refs.inputFile.click()),onDragenter:l[1]||(l[1]=e=>t+=1),onDragleave:l[2]||(l[2]=e=>t-=1)},null,8,["text"])],34)])),_:1},8,["subtitle"])}}},mo=(0,R.Z)(co,[["__scopeId","data-v-7d87a061"]]),Eo={class:"layout"},po={class:"action"},Ao={key:0,class:"header-list"},Io={key:1,class:"header-list"},No={class:"field-list"},yo={__name:"load-csv-config",setup(e){const t=(0,r.useRouter)(),a=so(),l=we().data.AANEE_ORIGEN_INFORMACIO.map((e=>({value:e.ID,text:e.ORIGEN_INFORMACIO}))),i=(0,n.reactive)({tipus:a.tipus,idEtapa:null,idOrigen:2,referencia:null}),o=a.schema;(0,n.onMounted)((()=>{const e=s.value.map((e=>e.text));for(let t=0;t<o.length;t++){const n=e.indexOf(o[t].title);-1!==n&&a.setSchemaColumn({index:t,column:n})}}));const s=(0,n.computed)((()=>[{text:"",value:null},...a.columns.map(((e,t)=>({text:e,value:t,disabled:o.some((e=>e.column===t))}))).filter((e=>e.text!==oo))])),d=(0,n.computed)((()=>(!i.idOrigen||!i.referencia)&&"neea"===i.tipus||"neea"!==i.tipus&&!i.idEtapa||o.filter((e=>e.required)).some((e=>!e.column))));function u(){t.push(`/load-csv?type=${i.tipus}`)}function c(){a.setOrigen(i),t.push("/validation")}return(e,t)=>{const r=(0,n.resolveComponent)("fura-button"),m=(0,n.resolveComponent)("fura-dropdown"),E=(0,n.resolveComponent)("fura-text-field");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(a).title},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Eo,[(0,n.createElementVNode)("div",po,[(0,n.createVNode)(r,{class:"prev-button",text:"Enrere",onClick:u}),(0,n.createVNode)(r,{class:"next-button",primary:"",text:"Següent",disabled:(0,n.unref)(d),onClick:c},null,8,["disabled"])]),"neea"===i.tipus?((0,n.openBlock)(),(0,n.createElementBlock)("div",Ao,[(0,n.createVNode)(m,{label:"Origen dades CSV",name:"idOrigen",options:(0,n.unref)(l),modelValue:i.idOrigen,"onUpdate:modelValue":t[0]||(t[0]=e=>i.idOrigen=e),required:""},null,8,["options","modelValue"]),(0,n.createVNode)(E,{label:"Referència de la càrrega",name:"referencia",modelValue:i.referencia,"onUpdate:modelValue":t[1]||(t[1]=e=>i.referencia=e),"max-length":40,required:""},null,8,["modelValue"])])):(0,n.createCommentVNode)("v-if",!0),"neea"!==i.tipus?((0,n.openBlock)(),(0,n.createElementBlock)("div",Io,[(0,n.createVNode)(m,{label:"Etapa educativa",name:"idEtapa",options:(0,n.unref)(g).etapesGedac,modelValue:i.idEtapa,"onUpdate:modelValue":t[2]||(t[2]=e=>i.idEtapa=e),required:""},null,8,["options","modelValue"])])):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",No,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(o),((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(m,{key:t,label:e.title,name:e.column,options:(0,n.unref)(s),required:e.required,"model-value":e.column,"onUpdate:modelValue":e=>(0,n.unref)(a).setSchemaColumn({index:t,column:e})},null,8,["label","name","options","required","model-value","onUpdate:modelValue"])))),128))])])])),_:1},8,["subtitle"])}}},Co=(0,R.Z)(yo,[["__scopeId","data-v-107f63ef"]]),fo={class:"form"},_o={key:0},To={key:1},go={class:"fura-footer",style:{"text-align":"center"}},Oo={__name:"edit-row",props:{rowIndex:{type:Number,required:!0}},emits:["save","cancel"],setup(e,{emit:t}){const a=e,l=so(),i=we(),o=(0,n.reactive)({row:l.data[a.rowIndex].slice()}),r=(0,n.computed)((()=>l.schema.filter((e=>e.column))));function s(e){return e.options?e.options:e.optionsDict?i.data[e.optionsDict].map((t=>({value:t[e.optionsText],text:t[e.optionsText]}))):[]}return(e,a)=>{const l=(0,n.resolveComponent)("fura-combo-box"),i=(0,n.resolveComponent)("fura-text-field"),d=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-panel"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(c,{dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{type:"small",class:"edicio","without-close-button":""},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",go,[(0,n.createVNode)(d,{primary:"",text:"Guardar",onClick:a[0]||(a[0]=e=>t("save",o.row))}),(0,n.createVNode)(d,{style:{"margin-left":"4px"},text:"Cancel·lar",onClick:a[1]||(a[1]=e=>t("cancel"))})])])),default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",fo,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(r),(e=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:e.name},[e.options||e.optionsDict?((0,n.openBlock)(),(0,n.createElementBlock)("div",_o,[((0,n.openBlock)(),(0,n.createBlock)(l,{key:e.name,label:e.title,options:s(e),modelValue:o.row[e.column],"onUpdate:modelValue":t=>o.row[e.column]=t},null,8,["label","options","modelValue","onUpdate:modelValue"]))])):((0,n.openBlock)(),(0,n.createElementBlock)("div",To,[((0,n.openBlock)(),(0,n.createBlock)(i,{key:e.name,label:e.title,modelValue:o.row[e.column],"onUpdate:modelValue":t=>o.row[e.column]=t},null,8,["label","modelValue","onUpdate:modelValue"]))]))],64)))),128))])])),_:1})])),_:1})}}},So=(0,R.Z)(Oo,[["__scopeId","data-v-49ecc0ec"]]),bo={class:"layout"},Do={class:"action"},vo=["textContent"],Ro={__name:"load-csv-validation",setup(e){const t=(0,r.useRouter)(),a=so(),l=(0,n.reactive)({schema:a.schema,tipus:a.tipus,showAll:!1,editIndex:null}),i=(0,n.computed)((()=>[{title:"",key:"edit",width:"30px"},{title:"Nº fila",key:0},...l.schema.filter((e=>e.column)).map((e=>({title:e.title,key:e.column})))])),o=(0,n.computed)((()=>l.showAll?a.data:a.data.filter(((e,t)=>a.invalidCells.has(t))))),s=(0,n.computed)((()=>0!==a.invalidCells.size));function d({rowIndex:e,column:t}){const n=o.value[e][0]-2,l=a.invalidCells.get(n);return l&&l.some((e=>e.column===t.key))}function u(e){a.updateRow(l.editIndex,e),l.editIndex=null}function c(){t.push("/configuration")}function m(){t.push("/execute-csv")}return(0,n.onMounted)((()=>{a.validateAll()})),(e,t)=>{const r=(0,n.resolveComponent)("fura-checkbox"),E=(0,n.resolveComponent)("fura-button"),p=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(a).title},{default:(0,n.withCtx)((()=>[null!=l.editIndex?((0,n.openBlock)(),(0,n.createBlock)(So,{key:0,"row-index":l.editIndex,onSave:u,onCancel:t[0]||(t[0]=e=>l.editIndex=null)},null,8,["row-index"])):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",bo,[(0,n.createElementVNode)("div",Do,[(0,n.createVNode)(r,{class:"show-all",label:"Mostrar tots",modelValue:l.showAll,"onUpdate:modelValue":t[1]||(t[1]=e=>l.showAll=e),disabled:"neea"!==l.tipus},null,8,["modelValue","disabled"]),(0,n.createVNode)(E,{class:"prev-button",text:"Tornar a la configuració",onClick:c}),(0,n.createVNode)(E,{class:"next-button",primary:"",text:"Carregar les dades",disabled:(0,n.unref)(s),onClick:m},null,8,["disabled"])]),(0,n.createVNode)(p,{columns:(0,n.unref)(i),data:(0,n.unref)(o),"auto-layout":"fullAuto",compact:""},{default:(0,n.withCtx)((e=>["edit"===e.column.key?((0,n.openBlock)(),(0,n.createBlock)(E,{key:0,type:"icon",icon:"Edit",onClick:t=>{return a=e.rowIndex,void(l.editIndex=o.value[a][0]-2);var a}},null,8,["onClick"])):d(e)?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,class:"invalid-cell",textContent:(0,n.toDisplayString)(e.content)},null,8,vo)):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["columns","data"])])])),_:1},8,["subtitle"])}}},ho=(0,R.Z)(Ro,[["__scopeId","data-v-9daf44ae"]]),Lo={decimal:e=>e.replaceAll(".","").replace(",","."),integer:e=>e,dateDMY(e){const t=(e,t=2)=>e.toString().padStart(t,"0"),a=new Date(e.split("/").reverse().join("/"));return a instanceof Date?a.getFullYear()+"/"+t(a.getMonth()+1)+"/"+t(a.getDate()):null},boolean:e=>/^(0|No|no|false)$/i.test(e)?"0":/^(1|SÍ|Si|SI|sí|si|true)$/i.test(e)?"1":null,nivell(e){const t=g.nivells.filter((t=>t.text===e));return t.length>0?t[0].value:null},districte(e){const t=g.districtes.filter((t=>t.text===e));return t.length>0?t[0].value:null},centre(e){const t=we().data.GEN_CENTRE.filter((t=>t.CODI_CENTRE===e));return t.length>0?t[0].ID:null},tipusGedac(e){const t=g.tipusAlumneGEDAC.filter((t=>t.text===e));return t.length>0?t[0].value:null},centreGedac(e){const t=we(),a=e.replace(/"/g,"").replace(/=/g,""),n=t.data.GEN_CENTRE.filter((e=>e.CODI_CENTRE===a));return n.length>0?n[0].ID:null},motiusNese(e){const t=we().data.GEN_MOTIU_NESE.filter((t=>t.MOTIU_NESE===e));return t.length>0?t[0].ID:null},eap(e){const t=we().data.GEN_EAP.filter((t=>t.NOM===e));return t.length>0?t[0].ID:null},simultaneitat:e=>["Sí amb valor d'1 punt","Sí","Si"].includes(e)?1:0},xo={class:"layout"},Uo={__name:"load-csv-execute",setup(e){const t=he(),a=(0,r.useRouter)(),l=so(),i=T(),o=(0,n.reactive)({tipus:l.tipus,pendentExecutar:!0,miss:""});function s(){const e=l.schema.filter((e=>e.column)),t=document.implementation.createDocument(null,"xml"),a=t.createElement("header");a.setAttribute("TIPUS_ALUMNE",l.tipus),a.setAttribute("ID_ORIGEN",l.idOrigen||""),a.setAttribute("REFERENCIA",l.referencia||""),a.setAttribute("ETAPA",l.idEtapa||""),a.setAttribute("USUARI",i.data.name),t.documentElement.appendChild(a);for(const a of l.data){const n=t.createElement("row");for(const t of e)a[t.column]&&(t.type in Lo?n.setAttribute(t.name,Lo[t.type](a[t.column])):n.setAttribute(t.name,a[t.column]));t.documentElement.appendChild(n)}return(new XMLSerializer).serializeToString(t)}async function d(){const e=T();o.pendentExecutar=!0,t.loadStart("Càrrega arxius/load");const n=await fetch(`${m}/Stored/${function(){switch(o.tipus){case"neea":return"pr_AANEE_CARREGA_CSV";case"pers":return"pr_GEDAC_CARREGA_ALUMNE";case"pets":return"pr_GEDAC_CARREGA_SOLICITUDS";case"ofe":return"pr_GEDAC_CARREGA_OFERTA";case"ass":return"pr_GEDAC_CARREGA_ASSIGNACIONS";case"barems":return"pr_GEDAC_CARREGA_BAREMS";default:return""}}()}`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:e.jwt},body:s()});t.loadEnd("Càrrega arxius/load");const i=await n.json();o.pendentExecutar=!1,200===n.status?(t.alert({title:l.title,message:i}),a.push("neea"===o.tipus?"/AANEE_ALUMNE_NOIMPORTAT":"/AANEE_ALUMNE")):(t.alert({title:l.title,message:"Error: "+i}),a.push("/"))}return(e,t)=>{const a=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(l).title},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",xo,[(0,n.withDirectives)((0,n.createVNode)(a,{text:"Executar el procés d'importació de les dades",onClick:d},null,512),[[n.vShow,o.pendentExecutar]])])])),_:1},8,["subtitle"])}}},Mo=(0,R.Z)(Uo,[["__scopeId","data-v-06c8f6f6"]]),Po={class:"botons"},Vo={__name:"find-idalus",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=a.query.listname,d=he(),u=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"IDALU",title:"IDALU"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],c=a.query.title,E=(0,n.reactive)({alumnesACercar:[],lastDirection:!0,currentPos:0});let p={};const A=(0,n.ref)([]);async function I(e,t){E.currentPos=e,E.lastDirection=t,p=E.alumnesACercar[E.currentPos],o.value.length=0,d.loadStart("findIDALUS");const a=await fetch(`${m}/Stored/pr_findIdalus`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({idalu:p.IDALU,nom:p.NOM,nom_findidalus:p.NOM_FINDIDALUS,cognom1:p.COGNOM1,cognom1_findidalus:p.COGNOM1_FINDIDALUS,cognom2:p.COGNOM2,cognom2_findidalus:p.COGNOM2_FINDIDALUS,identificacio_fiscal:p.IDENTIFICACIO_FISCAL,data_naixement:p.DATA_NAIXEMENT_AMD,id_nivell:p.ID_NIVELL,cp_residencia:p.CP_RESIDENCIA,identificacio_fiscal_tutor1:p.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:p.IDENTIFICACIO_FISCAL_TUTOR2,unics:!p.IDALU&&["AANEE_ALUMNE","AANEE_ALUMNE_IMPORTAT"].includes(s)?1:0,llista_cercada:s})});if(d.loadEnd("findIDALUS"),200===a.status){const n=await a.json();if(n){const e=JSON.parse(n);e.length=Math.min(e.length,i.filesFindIdalus),e.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),A.value=e}else A.value=[],t?e<E.alumnesACercar.length-1&&await I(e+1,E.lastDirection):e>0&&await I(e-1,E.lastDirection)}else alert("Error de comuncació amb el servidor")}async function N(e){let t=[];switch(e){case"save":t={ID:p.ID,IDALU:A.value[o.value[0]].IDALU,IDALU_RALC:!0,LLIGAM_IDALU:"Manual",DATA_LLIGAM_IDALU:new Date};break;case"correcte":t={ID:p.ID,IDALU_RALC:!0,LLIGAM_IDALU:"Manual",DATA_LLIGAM_IDALU:new Date};break;case"nocercar":t={ID:p.ID,IDALU_NOCERCAR:!0};break;default:t={ID:p.ID,IDALU:null,IDALU_RALC:!1,LLIGAM_IDALU:null,DATA_LLIGAM_IDALU:null}}(await fetch(`${m}/${s}(${p.ID})`,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify(t)})).status<=400?"save"===e?(E.alumnesACercar[E.currentPos].IDALU=A.value[o.value[0]].IDALU,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):"correcte"===e?(E.alumnesACercar[E.currentPos].IDALU_RALC=!0,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):"nocercar"===e?(E.alumnesACercar[E.currentPos].IDALU_NOCERCAR=!0,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):"cercar"===e?(E.alumnesACercar[E.currentPos].IDALU_NOCERCAR=!1,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):E.alumnesACercar[E.currentPos].IDALU=null:alert("Error de comuncació amb el servidor")}function y(e){return e&&e.column&&e.column.key?p[e.column.key]||"":null}function C(e){if(e.content)if(["NOM_TUTOR1","NOM_TUTOR2"].includes(e.column.key)){if(0===e.content.localeCompare(p.NOM_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.NOM_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}else{if(!["IDENTIFICACIO_FISCAL_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR2"].includes(e.column.key))return 0===e.content.localeCompare(p[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"";if(0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}}function f(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{const e=await xe(`${s}`,{$select:"ID, IDALU,IDALU_NOCERCAR,IDALU_RALC,NOM,NOM_FINDIDALUS, COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, ID_NIVELL, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR2",$expand:"GEN_NIVELL($select=NIVELL)",$filter:a.query.filter,$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:3e3});E.alumnesACercar=e.value,E.alumnesACercar.forEach((function(e){e.NIVELL=e.GEN_NIVELL?.NIVELL,e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),E.alumnesACercar.length>0&&I(0,!0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(c)},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Po,[(0,n.createVNode)(a,{class:"boto",style:{width:"198px"},text:"Marcar com correcte",disabled:!(0,n.unref)(p).IDALU||!!(0,n.unref)(p).IDALU_RALC,icon:"AcceptMedium",onClick:t[0]||(t[0]=e=>N("correcte"))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",style:{width:"177px"},icon:(0,n.unref)(p)?.IDALU?"SearchIssue":"SetAction",text:(0,n.unref)(p)?.IDALU?"Esborrar IDALU":"Escollir IDALU",disabled:0===o.value.length&&!(0,n.unref)(p)?.IDALU,onClick:t[1]||(t[1]=e=>N((0,n.unref)(p)?.IDALU?"delete":"save"))},null,8,["icon","text","disabled"]),(0,n.createVNode)(a,{class:"boto",style:{"margin-right":"48px",width:"198px"},text:"Marcar com cercat",disabled:(0,n.unref)(p).IDALU_NOCERCAR,icon:"ProfileSearch",onClick:t[2]||(t[2]=e=>N("nocercar"))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===E.currentPos,onClick:t[3]||(t[3]=e=>I(E.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(l,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${(E.currentPos+1).toLocaleString("IT")} / ${E.alumnesACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(a,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:E.currentPos>=E.alumnesACercar.length-1,onClick:t[4]||(t[4]=e=>I(E.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",style:{"margin-left":"48px"},text:"Tornar",icon:"ReturnToSession",onClick:f})]),(0,n.createVNode)(i,{compact:"",selection:"simple",columns:u,data:A.value,"selected-indices":o.value,"onUpdate:selected-indices":t[5]||(t[5]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(y(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(C(e))},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1},8,["subtitle"])}}},Fo=Vo,wo={class:"botons"},Go={__name:"find-duplicats",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=a.query.id,d=he(),u=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"IDALU",title:"IDALU"},{key:"NUM_SOLICITUD_GEDAC",title:"N.Sol·licitud"},{key:"TIPUS_ALUMNE",title:"Tipus alumne"},{key:"NIVELL",title:"Nivell"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],c=(0,n.reactive)({alumnesACercar:[],lastDirection:!0,currentPos:0});let E={};const p=(0,n.ref)([]);async function A(e,t){c.currentPos=e,c.lastDirection=t,E=c.alumnesACercar[c.currentPos],o.value.length=0,d.loadStart("findDuplicats");const a=await fetch(`${m}/Stored/pr_findDuplicats`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({id_actual:E.ID,nom:E.NOM,nom_findidalus:E.NOM_FINDIDALUS,cognom1:E.COGNOM1,cognom1_findidalus:E.COGNOM1_FINDIDALUS,cognom2:E.COGNOM2,cognom2_findidalus:E.COGNOM2_FINDIDALUS,identificacio_fiscal:E.IDENTIFICACIO_FISCAL,data_naixement:E.DATA_NAIXEMENT_AMD,id_nivell:E.ID_NIVELL,cp_residencia:E.CP_RESIDENCIA,identificacio_fiscal_tutor1:E.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:E.IDENTIFICACIO_FISCAL_TUTOR2})});if(d.loadEnd("findDuplicats"),200===a.status){const n=await a.json();if(n){const e=JSON.parse(n);e.length=Math.min(e.length,i.filesFindIdalus),e.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),p.value=e}else p.value=[],t?e<c.alumnesACercar.length-1&&await A(e+1,c.lastDirection):e>0&&await A(e-1,c.lastDirection)}else alert("Error de comuncació amb el servidor")}function I(e){return e&&e.column&&e.column.key?E[e.column.key]||"":null}function N(e){if(e.content)if(["NOM_TUTOR1","NOM_TUTOR2"].includes(e.column.key)){if(0===e.content.localeCompare(E.NOM_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(E.NOM_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}else{if(!["IDENTIFICACIO_FISCAL_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR2"].includes(e.column.key))return 0===e.content.localeCompare(E[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"";if(0===e.content.localeCompare(E.IDENTIFICACIO_FISCAL_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(E.IDENTIFICACIO_FISCAL_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}}function y(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{d.loadStart("duplicats"),await fetch(`${m}/Stored/pr_AANEE_UPDATE_DUPLICATS`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt}});const e=await xe("AANEE_ALUMNE",{$select:"ID, IDALU,TIPUS_ALUMNE, NUM_SOLICITUD_GEDAC, NOM,NOM_FINDIDALUS, COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, ID_NIVELL, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR2",$expand:"GEN_NIVELL($select=NIVELL)",$filter:s?`ID eq ${s}`:"POSSIBLE_DUPLICAT eq true "+(a.query.filter?" and "+a.query.filter:""),$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:12e3});d.loadEnd("duplicats"),c.alumnesACercar=e.value,c.alumnesACercar.forEach((function(e){e.NIVELL=e.GEN_NIVELL?.NIVELL,e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),c.alumnesACercar.length>0&&A(0,!0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),i=(0,n.resolveComponent)("fura-label"),r=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Cerca possibles duplicats"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",wo,[(0,n.createVNode)(a,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===c.currentPos,onClick:t[0]||(t[0]=e=>A(c.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",icon:"Delete",text:"Esborrar duplicat",disabled:0===o.value.length,onClick:t[1]||(t[1]=e=>async function(e){(await fetch(`${m}/AANEE_ALUMNE(${p.value[o.value[0]].ID})`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt}})).status<=400?c.currentPos<c.alumnesACercar.length-1&&await A(c.lastDirection?c.currentPos+1:Math.max(c.currentPos-1,0),c.lastDirection):alert("Error de comuncació amb el servidor")}())},null,8,["disabled"]),(0,n.createVNode)(i,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${c.currentPos+1} / ${c.alumnesACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(a,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:c.currentPos>=c.alumnesACercar.length-1,onClick:t[2]||(t[2]=e=>A(c.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",icon:"ContactLink",text:"Fussionar",disabled:0===o.value.length,onClick:t[3]||(t[3]=t=>e.fusionar())},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",style:{"margin-left":"48px"},text:"Tornar",icon:"ReturnToSession",onClick:y})]),(0,n.createVNode)(r,{compact:"",selection:"simple",columns:u,data:p.value,"selected-indices":o.value,"onUpdate:selected-indices":t[4]||(t[4]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(I(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(N(e))},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1})}}},Bo=Go,ko={class:"botons"},$o={__name:"lligam-gedac-aanee",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=he(),d=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"IDALU",title:"IDALU"},{key:"NUM_SOLICITUD",title:"N.Sol·licitud"},{key:"TIPUS_ALUMNE",title:"Tipus"},{key:"NIVELL",title:"Nivell"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],u=(0,n.reactive)({inscripcionsACercar:[],lastDirection:!0,currentPos:0});let c={};const E=(0,n.ref)([]);async function p(e,t){u.currentPos=e,u.lastDirection=t,c=u.inscripcionsACercar[u.currentPos],o.value.length=0,s.loadStart("LligamGEDAC");const a=await fetch(`${m}/Stored/pr_findLligamGedacAanee`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({idalu:c.IDALU,nom:c.NOM,nom_findidalus:c.NOM_FINDIDALUS,cognom1:c.COGNOM1,cognom1_findidalus:c.COGNOM1_FINDIDALUS,cognom2:c.COGNOM2,cognom2_findidalus:c.COGNOM2_FINDIDALUS,identificacio_fiscal:c.IDENTIFICACIO_FISCAL,data_naixement:c.DATA_NAIXEMENT_AMD,id_nivell:c.ID_NIVELL,cp_residencia:c.CP_RESIDENCIA,identificacio_fiscal_tutor1:c.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:c.IDENTIFICACIO_FISCAL_TUTOR2})});if(s.loadEnd("LligamGEDAC"),200===a.status){const e=await a.json();if(e){const t=JSON.parse(e);t.length=Math.min(t.length,i.filesLligamAanee),t.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),E.value=t}else E.value=[]}else alert("Error de comuncació amb el servidor")}async function A(e){const t={opcio:e,id:o.value.length>0?E.value[o.value[0]].ID:null,id_gedac_ini:c.ID,id_gedac:c.ID,num_solicitud_gedac:c.NUM_SOLICITUD,tipus_alumne_gedac:c.TIPUS_ALUMNE,idalu_gedac:c.IDALU,idalu_aanee:o.value.length>0?E.value[o.value[0]].IDALU:null,id_rav:c.ID_RAV,usuari:l.data.name};(await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt},body:JSON.stringify(t)})).status<=400?(c["AANEE_ALUMNE@odata.count"]=1,u.currentPos<u.inscripcionsACercar.length-1&&await p(u.lastDirection?u.currentPos+1:Math.max(u.currentPos-1,0),u.lastDirection)):alert("Error de comuncació amb el servidor")}function I(e){return e&&e.column&&e.column.key?c[e.column.key]||"":null}function N(e){if(e.content)if(["NOM_TUTOR1","NOM_TUTOR2"].includes(e.column.key)){if(0===e.content.localeCompare(c.NOM_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(c.NOM_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}else{if(!["IDENTIFICACIO_FISCAL_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR2"].includes(e.column.key))return 0===e.content.localeCompare(c[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"";if(0===e.content.localeCompare(c.IDENTIFICACIO_FISCAL_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(c.IDENTIFICACIO_FISCAL_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}}function y(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{s.loadStart("lligamgedac");const e=await xe("GEDAC_ALUMNE",{$select:"ID, ID_RAV,IDALU,NUM_SOLICITUD,NOM,NOM_FINDIDALUS,COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, ID_NIVELL, TIPUS_ALUMNE, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1, IDENTIFICACIO_FISCAL_TUTOR2",$expand:"GEN_NIVELL($select=NIVELL),AANEE_ALUMNE($count=true;$top=0)",$filter:"(not AANEE_ALUMNE/any(a: true) ) and (TIPUS_ALUMNE ne 'Ordinari' or ( ID_RAV ne null and (RAV_ALUMNE/ID_ESTATVULNERABLE eq 2 or  RAV_ALUMNE/ID_ESTAT eq 12)))"+(a.query.filter||""),$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:8e3});u.inscripcionsACercar=e.value,u.inscripcionsACercar.forEach((function(e){e.NIVELL=e.GEN_NIVELL?.NIVELL,e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),s.loadEnd("lligamgedac"),u.currentPos<u.inscripcionsACercar.length&&p(0,!0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Preinscripcions no lligades a AANEE"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ko,[(0,n.createVNode)(a,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===u.currentPos,onClick:t[0]||(t[0]=e=>p(u.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",style:{"margin-right":"48px",width:"198px"},text:"Afegir a AANEE",disabled:o.value.length>0||0!==(0,n.unref)(c)["AANEE_ALUMNE@odata.count"],icon:"Add",onClick:t[1]||(t[1]=e=>A("altaGedacAanee"))},null,8,["disabled"]),(0,n.createVNode)(l,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${u.currentPos+1} / ${u.inscripcionsACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(a,{class:"boto",style:{"margin-left":"48px",width:"198px"},icon:"SetAction",text:"Lligar amb GEDAC",disabled:0===o.value.length||!!E.value[o.value[0]].NUM_SOLICITUD,onClick:t[2]||(t[2]=e=>A("lligarGedacAanee"))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:u.currentPos>=u.inscripcionsACercar.length-1,onClick:t[3]||(t[3]=e=>p(u.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",style:{"margin-left":"48px"},text:"Tornar",icon:"ReturnToSession",onClick:y})]),(0,n.createVNode)(i,{compact:"",selection:"simple",columns:d,data:E.value,"selected-indices":o.value,"onUpdate:selected-indices":t[4]||(t[4]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(I(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(N(e))},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1})}}},qo=$o,jo={class:"botons"},Ko={__name:"lligam-gedac",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=a.query.listname,d=he(),u=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"NUM_SOLICITUD_GEDAC",title:"N. Sol·licitud"},{key:"IDALU",title:"IDALU"},{key:"NIVELL",title:"Nivell"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],c="AANEE_ALUMNE"===s?"Cerca lligams GEDAC":"Cerca lligams alumnes RAV",E=(0,n.reactive)({alumnesACercar:[],lastDirection:!0,currentPos:0});let p={};const A=(0,n.ref)([]);async function I(e,t){E.currentPos=e,E.lastDirection=t,p=E.alumnesACercar[E.currentPos],o.value.length=0,d.loadStart("LligamGEDAC");const a=await fetch(`${m}/Stored/pr_findLligamAaneeGedac`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({num_solicitud:p.NUM_SOLICITUD_GEDAC,idalu:p.IDALU,nom:p.NOM,nom_findidalus:p.NOM_FINDIDALUS,cognom1:p.COGNOM1,cognom1_findidalus:p.COGNOM1_FINDIDALUS,cognom2:p.COGNOM2,cognom2_findidalus:p.COGNOM2_FINDIDALUS,identificacio_fiscal:p.IDENTIFICACIO_FISCAL,data_naixement:p.DATA_NAIXEMENT_AMD,id_nivell:p.ID_NIVELL,cp_residencia:p.CP_RESIDENCIA,identificacio_fiscal_tutor1:p.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:p.IDENTIFICACIO_FISCAL_TUTOR2})});if(d.loadEnd("LligamGEDAC"),200===a.status){const n=await a.json();if(n){const e=JSON.parse(n);e.length=Math.min(e.length,i.filesLligamAanee),e.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),A.value=e}else A.value=[],t?e<E.alumnesACercar.length-1&&await I(e+1,E.lastDirection):e>0&&await I(e-1,E.lastDirection)}else alert("Error de comuncació amb el servidor")}async function N(e){let t=[];switch(e){case"save":t={opcio:"lligarGedacAanee",id:p.ID,id_gedac_ini:p.ID_GEDAC?p.id_gedac:A.value[o.value[0]].ID,id_gedac:A.value[o.value[0]].ID,num_solicitud_gedac:A.value[o.value[0]].NUM_SOLICITUD_GEDAC,tipus_alumne_gedac:A.value[o.value[0]].TIPUS_ALUMNE,idalu_gedac:A.value[o.value[0]].IDALU,idalu_aanee:p.IDALU};break;case"deleteLligamGedac":t={opcio:"deleteLligamGedac",id:p.ID};break;case"noCercargedac":t={opcio:"noCercarGedac",id:p.ID}}(await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt},body:JSON.stringify(t)})).status<=400?"save"===e?(E.alumnesACercar[E.currentPos].NUM_SOLICITUD_GEDAC=A.value[o.value[0]].NUM_SOLICITUD_GEDAC,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):E.alumnesACercar[E.currentPos].NUM_SOLICITUD_GEDAC=null:alert("Error de comuncació amb el servidor")}function y(e){return e&&e.column&&e.column.key?p[e.column.key]||"":null}function C(e){if(e.content)if(["NOM_TUTOR1","NOM_TUTOR2"].includes(e.column.key)){if(0===e.content.localeCompare(p.NOM_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.NOM_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}else{if(!["IDENTIFICACIO_FISCAL_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR2"].includes(e.column.key))return 0===e.content.localeCompare(p[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"";if(0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}}function f(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{d.loadStart("lligamgedac"),await fetch(`${m}/Stored/PR_AutoLligam_GEDAC_AANEE`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt}});const e=await xe(`${s}`,{$select:"ID, IDALU,NOM,NOM_FINDIDALUS,GEDAC_NOCERCAR,ID_GEDAC,NUM_SOLICITUD_GEDAC, COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, ID_NIVELL, TIPUS_ALUMNE, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1, IDENTIFICACIO_FISCAL_TUTOR2",$expand:"GEN_NIVELL($select=NIVELL)",$filter:a.query.filter,$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:4e3});E.alumnesACercar=e.value,E.alumnesACercar.forEach((function(e){e.NIVELL=e.GEN_NIVELL?.NIVELL,e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),d.loadEnd("lligamgedac"),E.currentPos<E.alumnesACercar.length&&I(0,!0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(c)},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",jo,[(0,n.createVNode)(a,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===E.currentPos,onClick:t[0]||(t[0]=e=>I(E.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",style:{"margin-right":"48px",width:"198px"},text:"Marcar com cercat",disabled:(0,n.unref)(p).GEDAC_NOCERCAR,icon:"ProfileSearch",onClick:t[1]||(t[1]=e=>N("noCercargedac"))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",style:{width:"180px"},icon:(0,n.unref)(p)?.IDALU?"SearchIssue":"SetAction",text:(0,n.unref)(p)?.NUM_SOLICITUD_GEDAC?"Esborrar lligam":"Establlir lligam",disabled:0===o.value.length&&null===(0,n.unref)(p)?.NUM_SOLICITUD_GEDAC,onClick:t[2]||(t[2]=e=>N((0,n.unref)(p)?.NUM_SOLICITUD_GEDAC?"delete":"save"))},null,8,["icon","text","disabled"]),(0,n.createVNode)(l,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${E.currentPos+1} / ${E.alumnesACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(a,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:E.currentPos>=E.alumnesACercar.length-1,onClick:t[3]||(t[3]=e=>I(E.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",style:{"margin-left":"48px"},text:"Tornar",icon:"ReturnToSession",onClick:f})]),(0,n.createVNode)(i,{compact:"",selection:"simple",columns:u,data:A.value,"selected-indices":o.value,"onUpdate:selected-indices":t[4]||(t[4]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(y(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(C(e))},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1},8,["subtitle"])}}},zo=Ko,Zo={class:"botons"},Xo={__name:"lligam-rav",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=a.query.listName,d="GEDAC_ALUMNE"===s?"pr_findLligamGedacRav":"pr_findLligamAaneeRav",u=he(),c=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"IDALU",title:"IDALU"},{key:"TIPUS_ALUMNE",title:"T.Alumne"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],E=(0,n.reactive)({alumnesACercar:[],lastDirection:!0,currentPos:0});let p={};const A=(0,n.ref)([]);async function I(e,t){E.currentPos=e,E.lastDirection=t,p=E.alumnesACercar[E.currentPos],o.value.length=0,u.loadStart("LligamRAV");const a=await fetch(`${m}/Stored/${d}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({num_solicitud:p.NUM_SOLICITUD_GEDAC,idalu:p.IDALU,nom:p.NOM,nom_findidalus:p.NOM_FINDIDALUS,cognom1:p.COGNOM1,cognom1_findidalus:p.COGNOM1_FINDIDALUS,cognom2:p.COGNOM2,cognom2_findidalus:p.COGNOM2_FINDIDALUS,identificacio_fiscal:p.IDENTIFICACIO_FISCAL,data_naixement:p.DATA_NAIXEMENT_AMD,id_nivell:p.ID_NIVELL,cp_residencia:p.CP_RESIDENCIA,identificacio_fiscal_tutor1:p.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:p.IDENTIFICACIO_FISCAL_TUTOR2})});if(u.loadEnd("LligamRAV"),200===a.status){const n=await a.json();if(n){const e=JSON.parse(n);e.length=Math.min(e.length,i.filesLligamAanee),e.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),A.value=e}else A.value=[],t?e<E.alumnesACercar.length-1&&await I(e+1,E.lastDirection):e>0&&await I(e-1,E.lastDirection)}else alert("Error de comuncació amb el servidor")}function N(e){return e&&e.column&&e.column.key?p[e.column.key]||"":null}function y(e){if(e.content)if(["NOM_TUTOR1","NOM_TUTOR2"].includes(e.column.key)){if(0===e.content.localeCompare(p.NOM_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.NOM_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}else{if(!["IDENTIFICACIO_FISCAL_TUTOR1","IDENTIFICACIO_FISCAL_TUTOR2"].includes(e.column.key))return 0===e.content.localeCompare(p[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"";if(0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR1||"","ES",{sensitivity:"base"})||0===e.content.localeCompare(p.IDENTIFICACIO_FISCAL_TUTOR2||"","ES",{sensitivity:"base"}))return"color:red; font-weight: 600;"}}function C(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{const e=await xe(s,{$select:"ID, IDALU,TIPUS_ALUMNE,NOM,NOM_FINDIDALUS,COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL, CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1, IDENTIFICACIO_FISCAL_TUTOR2",$filter:"ID_RAV eq null"+(a.query.filter?" and "+a.query.filter:""),$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:24e3});E.alumnesACercar=e.value,E.alumnesACercar.forEach((function(e){e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),E.currentPos<E.alumnesACercar.length&&I(0,!0)})),(e,t)=>{const i=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-label"),d=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:(0,n.unref)(a).query.title},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Zo,[(0,n.createVNode)(i,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===E.currentPos,onClick:t[0]||(t[0]=e=>I(E.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(i,{class:"boto",style:{width:"180px"},icon:(0,n.unref)(p)?.IDALU?"SearchIssue":"SetAction",text:(0,n.unref)(p)?.NUM_SOLICITUD_GEDAC?"Esborrar lligam":"Establlir lligam",disabled:0===o.value.length,onClick:t[1]||(t[1]=e=>async function(){const e="GEDAC_ALUMNE"===s?{opcio:"lligarRavGedac",id_gedac:p.ID,idalu_gedac:p.IDALLU,idalu_rav:A.value[o.value[0]].IDALU,id_rav:A.value[o.value[0]].ID,usuari:l.data.name}:{opcio:"lligarRavAanee",id_aanee:p.ID,idalu_aanee:p.IDALLU,id_rav:A.value[o.value[0]].ID,usuari:l.data.name};(await fetch(`${m}/Stored/pr_AANEE_UPDATES`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:l.jwt},body:JSON.stringify(e)})).status<=400?(E.alumnesACercar[E.currentPos].IDALU=A.value[o.value[0]].IDALU,E.currentPos<E.alumnesACercar.length-1&&await I(E.lastDirection?E.currentPos+1:Math.max(E.currentPos-1,0),E.lastDirection)):alert("Error de comuncació amb el servidor")}((0,n.unref)(p)?.NUM_SOLICITUD_GEDAC))},null,8,["icon","text","disabled"]),(0,n.createVNode)(r,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${(E.currentPos+1).toLocaleString("IT")} / ${E.alumnesACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(i,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:E.currentPos>=E.alumnesACercar.length-1,onClick:t[2]||(t[2]=e=>I(E.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(i,{class:"botoMoviment",style:{"margin-left":"48px"},text:"Tornar",icon:"ReturnToSession",onClick:C})]),(0,n.createVNode)(d,{compact:"",selection:"simple",columns:c,data:A.value,"selected-indices":o.value,"onUpdate:selected-indices":t[3]||(t[3]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(N(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(y(e))},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1},8,["subtitle"])}}},Wo=Xo,Ho={class:"botons"},Yo={__name:"lligam-importacio-csv",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=T(),i=La(),o=(0,n.ref)([]),s=he(),d=[{key:"COGNOM1",title:"Primer cognom"},{key:"COGNOM2",title:"Segon cognom"},{key:"NOM",title:"Nom"},{key:"IDALU",title:"IDALU"},{key:"TIPUS_ALUMNE",title:"Tipus"},{key:"NIVELL",title:"Nivell"},{key:"DATA_NAIXEMENT",align:"center",title:"D.naixement"},{key:"CP_RESIDENCIA",title:"C.Postal"},{key:"IDENTIFICACIO_FISCAL",title:"Id.fiscal"},{key:"NOM_TUTOR1",title:"Nom 1r tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR1",title:"NIF 1r tutor"},{key:"NOM_TUTOR2",title:"Nom 2n tutor"},{key:"IDENTIFICACIO_FISCAL_TUTOR2",title:"NIF 2n tutor"}],u=(0,n.reactive)({alumnesACercar:[],lastDirection:!0,currentPos:0});let c={};const E=(0,n.ref)([]);async function p(e,t){u.currentPos=e,u.lastDirection=t,c=u.alumnesACercar[u.currentPos],o.value.length=0,s.loadStart("findIMPORTACIO");const a=await fetch(`${m}/Stored/pr_findLligamImportacioAanee`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({idalu:c.IDALU,nom:c.NOM,nom_findidalus:c.NOM_FINDIDALUS,cognom1:c.COGNOM1,cognom1_findidalus:c.COGNOM1_FINDIDALUS,cognom2:c.COGNOM2,cognom2_findidalus:c.COGNOM2_FINDIDALUS,identificacio_fiscal:c.IDENTIFICACIO_FISCAL,data_naixement:c.DATA_NAIXEMENT_AMD,id_nivell:c.ID_NIVELL,cp_residencia:c.CP_RESIDENCIA,identificacio_fiscal_tutor1:c.IDENTIFICACIO_FISCAL_TUTOR1,identificacio_fiscal_tutor2:c.IDENTIFICACIO_FISCAL_TUTOR2,unics:c.IDALU?0:1})});if(s.loadEnd("findIMPORTACIO"),200===a.status){const e=await a.json();if(e){const t=JSON.parse(e);t.length=Math.min(t.length,i.filesFindIdalus),t.forEach((function(e){e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),E.value=t}else E.value=[]}else alert("Error de comuncació amb el servidor")}async function A(){(await fetch(`${m}/AANEE_ALUMNE_IMPORTAT(${c.ID})`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt}})).status<=400?u.currentPos<u.alumnesACercar.length-1&&await p(u.lastDirection?u.currentPos+1:Math.max(u.currentPos-1,0),u.lastDirection):alert("Error de comuncació amb el servidor")}async function I(e){c=u.alumnesACercar[u.currentPos],s.loadStart("AANEE_CARREGA_IMPORTAT");const t=await fetch(`${m}/Stored/pr_AANEE_CARREGA_IMPORTAT`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:l.jwt},body:JSON.stringify({opcio:e,user:l.data.name,idIMPORTAT:c.ID,idAANEE:"fussio"===e&&o.value.length>0?E.value[o.value[0]].ID:null})});s.loadEnd("AANEE_CARREGA_IMPORTAT"),200===t.status?("fussio"===e&&(u.alumnesACercar[u.currentPos].TIPUS_ALUMNE="NEE-A+B"),u.currentPos<u.alumnesACercar.length-1&&await p(u.lastDirection?u.currentPos+1:Math.max(u.currentPos-1,0),u.lastDirection)):alert("Error de comuncació amb el servidor")}function N(e){return e&&e.column&&e.column.key?c[e.column.key]||"":null}function y(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{const e=await xe("AANEE_ALUMNE_IMPORTAT",{$select:"ID, IDALU,NOM,NOM_FINDIDALUS, COGNOM1,COGNOM1_FINDIDALUS, COGNOM2, COGNOM2_FINDIDALUS, ID_NIVELL, DATA_NAIXEMENT,IDENTIFICACIO_FISCAL,CP_RESIDENCIA,NOM_TUTOR1, NOM_TUTOR2, IDENTIFICACIO_FISCAL_TUTOR1,IDENTIFICACIO_FISCAL_TUTOR2",$expand:"GEN_NIVELL($select=NIVELL)",$filter:a.query.filter,$orderby:"COGNOM1,COGNOM2,NOM,DATA_NAIXEMENT",$top:1200});u.alumnesACercar=e.value,u.alumnesACercar.forEach((function(e){e.TIPUS_ALUMNE="NEE-A",e.NIVELL=e.GEN_NIVELL?.NIVELL,e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),u.alumnesACercar.length>0&&p(0,!0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Importació CSV NEE-A a AANEE"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Ho,[(0,n.createVNode)(a,{class:"botoMoviment",text:"Anterior",icon:"ChevronLeft",disabled:0===u.currentPos,onClick:t[0]||(t[0]=e=>p(u.currentPos-1,!1))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",icon:"SetAction",text:"És nou",disabled:0!==o.value.length,onClick:t[1]||(t[1]=e=>I("alta"))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"boto",icon:"SetAction",text:"Fussionar",disabled:0===o.value.length||"NEE-B"!==E.value[o.value[0]].TIPUS_ALUMNE,onClick:t[2]||(t[2]=e=>I("fussio"))},null,8,["disabled"]),(0,n.createVNode)(l,{style:{"margin-left":"8px","margin-top":"14px","margin-right":"8px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${u.currentPos+1} / ${u.alumnesACercar.length.toLocaleString("IT")}`),1)])),_:1}),(0,n.createVNode)(a,{class:"boto",icon:"Delete",text:"Esborrar",onClick:A}),(0,n.createVNode)(a,{class:"botoMoviment",text:"Següent",icon:"ChevronRight",disabled:u.currentPos>=u.alumnesACercar.length-1,onClick:t[3]||(t[3]=e=>p(u.currentPos+1,!0))},null,8,["disabled"]),(0,n.createVNode)(a,{class:"botoMoviment",text:"Tornar",icon:"ReturnToSession",onClick:y})]),(0,n.createVNode)(i,{compact:"",selection:"simple",columns:d,data:E.value,"selected-indices":o.value,"onUpdate:selected-indices":t[4]||(t[4]=e=>o.value=e),"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["DATA_NAIXEMENT","CP_RESIDENCIA"].includes(e?.column?.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(N(e)),1)],2)])),default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)("DATA_NAIXEMENT"===e?.column?.key||"CP_RESIDENCIA"===e?.column?.key?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(0===(e.content||"").localeCompare((0,n.unref)(c)[e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"")},(0,n.toDisplayString)(e.content),7)])),_:1},8,["data","selected-indices"])])),_:1})}}},Jo=Yo,Qo={class:"botons"},er={key:0,class:"cela fura-center"},tr={__name:"registre-canvis",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=[{value:0,text:"Mostrar canvis Identificació de l'alumne",filter:"CANVIS_IDENTIFICACIO eq true"},{value:1,text:"Mostrar canvis característiques NEE-A",filter:"CANVIS_NEEA_IDENTIFICACIO eq true"},{value:2,text:"Mostrar canvis marcatge NEE-A",filter:"CANVIS_NEEA_MARCATGE eq true"},{value:3,text:"Mostrar canvis  NEE-B",filter:"CANVIS_NEEB eq true"},{value:4,text:"Mostrar resum canvis de marcatge",filter:"CANVIS_MARCAFINAL eq true"}],i=(0,n.reactive)({opcio:0,select:[],cols:[],data:[]});async function o(e){switch(i.opcio=e,i.opcio){case 0:i.select=["CREATED","IDALU","NUM_SOLICITUD_GEDAC","NUM_SOLICITUD_EE","ID_NIVELL","TIPUS_ALUMNE","NOM","COGNOM1","DATA_NAIXEMENT","IDENTIFICACIO_FISCAL","CREATEDBY"];break;case 1:i.select=["CREATED","ID_EAP","PROFESSIONAL_ASSIGNAT_NEEA","SENSE_BARRERES","SIEI","SIAL","RETENCIO","CEEPSIR","CENTRE_CRAE","ACOLLIMENT_DGAIA","CREATEDBY"];break;case 2:i.select=["CREATED","ES_NEEA","ACORD_NEEA","TIPUS_ESCOLARITZACIO","ID_CENTRE_PROPOSAT1","ID_CENTRE_COMPARTIDA","INSCRIPCIOFINAL_NEEA","CREATEDBY"];break;case 3:i.select=["CREATED","ES_NEEB","PROFESSIONAL_ASSIGNAT_NEEB","ID_MOTIU_VULNERABILITAT","INSCRIPCIOFINAL_NEEB","CREATEDBY"];break;default:i.select=["CREATED","ES_NEEA","ES_NEEB","INSCRIPCIOFINAL_NEEA","INSCRIPCIOFINAL_NEEB","MARCA_MANUAL","ID_CENTRE_ASSIGNAT_CEB","CREATEDBY"]}const t=Da.filter((e=>i.select.includes(e.name)));i.cols=t.map((e=>({key:e.name,title:e.label})));const n=(await xe("AANEE_ALUMNE_CANVI",{$select:i.select,$expand:"RAV_MOTIU_VULNERABILITAT($select=MOTIU),GEN_NIVELL($select=NIVELL),GEN_EAP($select=NOM),GEN_CENTRE($select=CODIINOM_CENTRE),GEN_CENTRE1($select=CODIINOM_CENTRE),GEN_CENTRE2($select=CODIINOM_CENTRE)",$filter:`ID_AANEE eq ${a.query.id} and  ${l[e].filter}`,$orderby:"ID"})).value;n.forEach((function(e){e.ID_EAP=e.GEN_EAP?.NOM,e.ID_CENTRE_ASSIGNAT_CEB=e.GEN_CENTRE?.CODIINOM_CENTRE,e.ID_CENTRE_PROPOSAT1=e.GEN_CENTRE1?.CODIINOM_CENTRE,e.ID_CENTRE_COMPARTIDA=e.GEN_CENTRE2?.CODIINOM_CENTRE,e.ID_NIVELL=e.GEN_NIVELL?.NIVELL,e.ID_MOTIU_VULNERABILITAT=e.RAV_MOTIU_VULNERABILITAT?.MOTIU,e.CREATED_AMD=e.CREATE?.substr(0,10),e.DATA_NAIXEMENT_AMD=e.DATA_NAIXEMENT?.substr(0,10),e.CREATED=e.CREATED?new Date(e.CREATED).toLocaleString():"",e.DATA_NAIXEMENT=kt.date.getTextValueFromEntity({name:"DATA_NAIXEMENT"},e)})),i.data=n}function s(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{await o(0)})),(e,t)=>{const a=(0,n.resolveComponent)("fura-combo-box"),r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-icon"),u=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Registre de canvis"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Qo,[(0,n.createVNode)(a,{style:{width:"330px","padding-top":"12px","margin-bottom":"8px"},options:l,modelValue:i.opcio,"onUpdate:modelValue":[t[0]||(t[0]=e=>i.opcio=e),o]},null,8,["modelValue"]),(0,n.createVNode)(r,{style:{"margin-bottom":"8px"},class:"botoMoviment",text:"Tornar",icon:"ReturnToSession",onClick:s})]),(0,n.createVNode)(u,{compact:"",columns:i.cols,data:i.data,"auto-layout":"auto"},{header:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["TIPUS_ALUMNE","ID_NIVELL","ES_NEEA","ES_NEEB","DATA_NAIXEMENT","CREATED","SIEI","SIAL","SENSE_BARRERES","RETENCIO","CEEPSIR","CENTRE_CRAE","ACOLLIMENT_DGAIA"].includes(e.column.key)?"cela fura-center":"cela")},[(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(e?.column?.title),1)],2)])),default:(0,n.withCtx)((e=>[["RETENCIO","CEEPSIR","CENTRE_CRAE","ACOLLIMENT_DGAIA"].includes(e.column.key)?((0,n.openBlock)(),(0,n.createElementBlock)("div",er,[(0,n.createVNode)(d,{name:e.content?"CheckboxComposite":"Checkbox",style:(0,n.normalizeStyle)(e.rowIndex&&e.content!==i.data[e.rowIndex-1][e.column.key]?"color:red; font-weight: bold;":"font-weight: bold")},null,8,["name","style"])])):((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,class:(0,n.normalizeClass)(["TIPUS_ALUMNE","ID_NIVELL","ES_NEEA","ES_NEEB","DATA_NAIXEMENT","CREATED","SIEI","SIAL","SENSE_BARRERES"].includes(e.column.key)?"cela fura-center":"cela"),style:(0,n.normalizeStyle)(e.rowIndex&&0!==(e.content||"").localeCompare(i.data[e.rowIndex-1][e.column.key]||"","ES",{sensitivity:"base"})?"color:red; font-weight: 600;":"")},(0,n.toDisplayString)(e.content),7))])),_:1},8,["columns","data"])])),_:1})}}};function ar(e,t){return function(a,n,l){return[{margin:[30,30,18,0],layout:"noBorders",table:{widths:["30%","60%","4%","6%"],body:[[{text:"Consorci d'Educació de Barcelona",fontSize:12,rowSpan:2},{text:t.CODI_SIMULACIO+" "+t.NOM_SIMULACIO,fontSize:12,rowSpan:2},{text:"Pàg. ",fontSize:8},{text:a+" de "+n,alignment:"right",fontSize:8}],[{text:""},{text:""},{text:"Data ",fontSize:8},{text:(new Date).toLocaleDateString("en-GB"),alignment:"right",fontSize:8}],[{text:e,style:"districte",colSpan:4,fontSize:16},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"}]]}}]}}async function nr(e,t,a){const n=await xe("AANEE_SIMULACIO_RESULTAT_ALUMNE",{$apply:`filter(ID_SIMULACIO eq ${t.ID})/groupby((OPCIO),aggregate($count as N))`,$orderby:"OPCIO"}),l=n.value?n.value:[],i=l.filter((e=>e.OPCIO&&e.OPCIO<99)).length>0?l.filter((e=>e.OPCIO&&e.OPCIO<99)).map((e=>e.N)).reduce(((e,t)=>e+t)):0,o=l.filter((e=>!e.OPCIO)).length>0?l.filter((e=>!e.OPCIO)).map((e=>e.N)).reduce(((e,t)=>e+t)):0,r=l.length>0?l.map((e=>e.N)).reduce(((e,t)=>e+t)):0,s={layout:"noBorders",table:{widths:["30%","10%","10%","10%","10%","30%"],body:[[{text:"",style:"espai",pageBreak:"before"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}],[{text:"% places assignades per opció",style:"districte",colSpan:6},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"}],[{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}],[{text:"",style:"dreta"},{text:"Opció",style:"dreta"},{text:"Assignades",style:"dreta"},{text:"% / dem",style:"dreta"},{text:"Demanda",style:"dreta"},{text:"",style:"dreta"}],[{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}]]}};a&&s.table.body.push([{text:"Resum per opció",color:"white",tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"}]);for(let e=0;e<l.length;e++)l[e].OPCIO&&l[e].OPCIO<=10&&s.table.body.push(["",{text:l[e].OPCIO,style:"dreta"},{text:l[e].N.toLocaleString("ca-ES"),style:"dreta"},{text:(100*l[e].N/i).toLocaleString("ca-ES",{minimumFractionDigits:2,maximumFractionDigits:2})+"%",style:"dreta"},"",""]);s.table.body.push(["",{text:"Total",style:"dreta",bold:!0},{text:i.toLocaleString("ca-ES"),style:"dreta",bold:!0},{text:(100*i/r).toLocaleString("ca-ES",{minimumFractionDigits:2,maximumFractionDigits:2})+"%",style:"dreta",bold:!0},{text:r.toLocaleString("ca-ES"),style:"dreta",bold:!0},""]),s.table.body.push([{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}]),s.table.body.push(["",{text:"Ofici",style:"dreta"},{text:o.toLocaleString("ca-ES"),style:"dreta"},{text:(100*o/r).toLocaleString("ca-ES",{minimumFractionDigits:2,maximumFractionDigits:2})+"%",style:"dreta"},"",""]),e.content.push(s)}function lr(e,t,a,n){ir(t).forEach(((t,l,i)=>a(e,t,l,i,n,!1))),t.forEach((e=>{e.TITULARITAT="Total general"})),ir(t).forEach(((t,l,i)=>a(e,t,l,i,n,!1)))}function ir(e){const t=e.reduce((function(e,t){const a=t.TITULARITAT;return e[a]=e[a]||{TITULARITAT:t.TITULARITAT,N:0,GRUPS_FINAL:0,OFERTA_TOTAL_FINAL:0,PREVISSIO_RESERVA:0,DEMANDA_1OPCIO:0,DEMANDA_1OPCIO_ADSCRITS:0,ALUMNES_OFICI:0,ALUMNES_OFICI_ADSCRITS:0,ALUMNES_OFICI_ORDINARIS:0,ALUMNES_OFICI_NEE:0,PLACES_VACANTS:0,PLACES_VACANTS_ORDINARIES:0,PLACES_VACANTS_NEE:0,ASSIGNATS_ONSIGUI:0,ALUMNES_ASSIGNATS_1OPCIO:0,ALUMNES_ASSIGNATS_NO1OPCIO:0,ALUMNES_ASSIGNATS_TOTAL:0,ALUMNES_ASSIGNATS_RESTA:0,ALUMNES_ASSIGNATS_1OPCIOv:0},e[a].N++,e[a].GRUPS_FINAL+=t.GRUPS_FINAL,e[a].OFERTA_TOTAL_FINAL+=t.OFERTA_TOTAL_FINAL,e[a].PREVISSIO_RESERVA+=t.PREVISSIO_RESERVA,e[a].DEMANDA_1OPCIO+=t.DEMANDA_1OPCIO,e[a].DEMANDA_1OPCIO_ADSCRITS+=t.DEMANDA_1OPCIO_ADSCRITS,e[a].ALUMNES_OFICI+=t.ALUMNES_OFICI,e[a].ALUMNES_OFICI_ADSCRITS+=t.ALUMNES_OFICI_ADSCRITS,e[a].ALUMNES_OFICI_ORDINARIS+=t.ALUMNES_OFICI_ORDINARIS,e[a].ALUMNES_OFICI_NEE+=t.ALUMNES_OFICI_NEE,e[a].PLACES_VACANTS+=t.PLACES_VACANTS,e[a].PLACES_VACANTS_ORDINARIES+=t.PLACES_VACANTS_ORDINARIES,e[a].PLACES_VACANTS_NEE+=t.PLACES_VACANTS_NEE,e[a].ASSIGNATS_ONSIGUI+=t.ASSIGNATS_ONSIGUI,e[a].ALUMNES_ASSIGNATS_NO1OPCIO+=t.ALUMNES_ASSIGNATS_NO1OPCIO,e[a].ALUMNES_ASSIGNATS_1OPCIO+=t.ALUMNES_ASSIGNATS_1OPCIO,e[a].ALUMNES_ASSIGNATS_TOTAL+=t.ALUMNES_ASSIGNATS_TOTAL,e[a].ALUMNES_ASSIGNATS_RESTA+=t.ALUMNES_ASSIGNATS_RESTA,e[a].ALUMNES_LLISTA_ESPERA+=t.ALUMNES_LLISTA_ESPERA,e[a].ALUMNES_ASSIGNATS_1OPCIOv=t.ALUMNES_ASSIGNATS_1OPCIO,e}),{});return Object.values(t)}async function or(e,t,a){const n=[t.map((e=>sr(e.label))),...await rr(t,a)].map((e=>e.join(";"))).join("\n"),l=document.createElement("a");l.setAttribute("href",encodeURI("data:text/csv;charset=utf-8,\ufeff"+n)),l.setAttribute("download",e),l.style.display="none",document.body.appendChild(l),l.click(),l.remove()}async function rr(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof kt[a.type]?.getCsvValueFromEntity){const e=sr(await kt[a.type].getCsvValueFromEntity(a,n));t.push(e)}else t.push("");a.push(t)}return a}function sr(e){const t=String(e??"");return t.includes('"')||t.includes(";")||t.includes("\n")?`"${t.replaceAll('"','""')}"`:t}async function dr(e,t,a){const n=(await xe("GEDAC_OFERTA_EDUCATIVA",{$expand:"GEN_CENTRE($select=TITULARITAT,CODIINOM_DISTRICTE),GEN_NIVELL($select=NIVELL),GEN_ZONA($select=CODI_ZONA)",$filter:t,$orderby:"GEN_CENTRE/CODIINOM_DISTRICTE asc"})).value||[];n.forEach((function(e){e.DISTRICTE=e.GEN_CENTRE.CODIINOM_DISTRICTE,e.ZONA=e.GEN_ZONA.CODI_ZONA,e.NIVELL=e.GEN_NIVELL.NIVELL})),"PDF"===e?function(e,t){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const a={pageOrientation:"landscape",pageMargins:[30,75,30,30],header:function(e,t){return{margin:[30,30,20,0],columns:[{text:"Assignació places NESE",width:165,alignment:"left",fontSize:14},{text:"Oferta i Demanda",width:"*",alignment:"center",fontSize:14},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:(new Date).toLocaleDateString("en-GB"),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}},content:[{layout:{defaultBorder:!1},table:{headerRows:2,widths:["6%","20%","7%","1%","*","*","*","1%","*","*","*"],body:[]}}],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:13,italics:!0},districte:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7",pageBreak:"before"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10,background:"#DDF6FB",fillColor:"#DDF6FB"},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"},imparellvermell:{background:"#eeeeee",fillColor:"#eeeeee",color:"red",bold:!0},vermell:{color:"red",bold:!0}},defaultStyle:{fontSize:8}};function n(e,t,a,n,l,i){let[o,r,s,d,u,c]=[0,0,0,0,0,0];for(let e=0;e<i.length;e++)o+=i[e].OFERTA_NEEA,r+=i[e].OFERTA_NEEB,s+=i[e].OFERTA_NEE,d+=i[e].DEMANDA_1OPCIO_NEEA||0,u+=i[e].DEMANDA_1OPCIO_NEEB||0,c+=i[e].DEMANDA_1OPCIO_NEE||0;e.content[0].table.body.push([{text:t,style:n,colSpan:l||1},{text:a,style:n},{text:"",style:n},{text:"",style:n},{text:o.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:r.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:s.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:" ",style:n},{text:d.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:u.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:c.toLocaleString("ca-ES"),style:n,alignment:"right"}])}a.content[0].table.body.push([{text:"Agrupació",bold:!0,border:[!1,!1,!1,!0],margin:[2,0,0,2],colSpan:3},"","","",{text:"Oferta",bold:!0,alignment:"center",colSpan:3,border:[!1,!1,!1,!0],margin:[2,0,0,2]},"","","",{text:"Demanda",bold:!0,alignment:"center",border:[!1,!1,!1,!0],margin:[2,0,0,2],colSpan:3},"",""]),a.content[0].table.body.push([{text:"Centre",bold:!0},{text:"Titularitat",bold:!0},{text:"Nivell",bold:!0},{text:""},{text:"NEE-A",bold:!0,alignment:"right"},{text:"NEE-B",bold:!0,alignment:"right"},{text:"Total",bold:!0,alignment:"right"},{text:""},{text:"NEE-A",bold:!0,alignment:"right"},{text:"NEE-B",bold:!0,alignment:"right"},{text:"Total",bold:!0,alignment:"right"}]),e.forEach(((e,l,i)=>function(e,t,a,l,i){const o=a%2?"imparell":"";0===a&&n(e,"T.general"," ","general",3,l),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE||n(e,t.DISTRICTE,"","districte",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE))),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA||n(e,t.ZONA,"","zona",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA))),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA&&l[a-1].TITULARITAT===t.TITULARITAT||n(e,"",t.TITULARITAT,"titularitat",1,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA&&e.TITULARITAT===t.TITULARITAT))),i||0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA&&l[a-1].TITULARITAT===t.TITULARITAT&&l[a-1].CODI_CENTRE===t.CODI_CENTRE||n(e,t.CODI_CENTRE+" "+t.NOM_CENTRE," ","centre",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA&&e.TITULARITAT===t.TITULARITAT&&e.CODI_CENTRE===t.CODI_CENTRE))),e.content[0].table.body.push([{text:i?t.CODI_CENTRE:"",style:o},{text:i?t.NOM_CENTRE:"",style:o},{text:t.NIVELL,style:o},{text:"",style:o},{text:t.OFERTA_NEEA,alignment:"right",style:o},{text:t.OFERTA_NEEB,alignment:"right",style:o},{text:t.OFERTA_NEE,alignment:"right",style:o},{text:"",style:o},{text:t.DEMANDA_1OPCIO_NEEA||0,alignment:"right",style:o+((t.DEMANDA_1OPCIO_NEEA||0)>t.OFERTA_NEEA?"vermell":"")},{text:t.DEMANDA_1OPCIO_NEEB||0,alignment:"right",style:o+((t.DEMANDA_1OPCIO_NEEB||0)>t.OFERTA_NEEB?"vermell":"")},{text:t.DEMANDA_1OPCIO_NEE||0,alignment:"right",style:o+((t.DEMANDA_1OPCIO||0)>t.OFERTA?"vermell":"")}])}(a,e,l,i,t))),Il.createPdf(a).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"ofertaDemandaNEE.pdf"})}(n,a):async function(e){or("ofertaIdemanda.csv",[{name:"DISTRICTE",label:"Districte",type:"string"},{name:"ZONA",label:"Zona",type:"string"},{name:"CODI_CENTRE",label:"C.Centre",type:"string"},{name:"NOM_CENTRE",label:"Nom centre",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"NIVELL",label:"Nivell",type:"string"},{name:"OFERTA_ORDINARIA",label:"Oferta Ordinària",type:"number"},{name:"OFERTA_NEEA",label:"Oferta NEE-A",type:"number"},{name:"OFERTA_NEEB",label:"Oferta NEE-B",type:"number"},{name:"OFERTA",label:"Oferta total",type:"number"},{name:"DEMANDA_1OPCIO_ORDINARIA",label:"Demanda Ordinària",type:"number"},{name:"DEMANDA_1OPCIO_NEEA",label:"Demanda NEE-A",type:"number"},{name:"DEMANDA_1OPCIO_NEEB",label:"Demanda NEE-B",type:"number"},{name:"DEMANDA_1OPCIO",label:"Demanda total",type:"number"},{name:"EXCES_DEMANDA_ORDINARIA",label:"Demanda NEE > Oferta Ord.",type:"boolean"},{name:"EXCES_DEMANDA_NEEA",label:"Demanda > Oferta NEE-A",type:"boolean"},{name:"EXCES_DEMANDA_NEEB",label:"Demanda > Oferta NEE-B",type:"boolean"},{name:"EXCES_DEMANDA",label:"Demanda > Oferta",type:"boolean"}],e)}(n)}async function ur(e,t,a){const n=(await xe("GEDAC_OFERTA_EDUCATIVA",{$expand:"GEN_CENTRE($select=TITULARITAT,CODI_CENTRE,NOM_CENTRE,CODIINOM_DISTRICTE),GEN_NIVELL($select=NIVELL),GEN_ZONA($select=CODI_ZONA)",$filter:t,$orderby:"GEN_CENTRE/CODIINOM_DISTRICTE asc,GEN_ZONA/CODI_ZONA,TITULARITAT,CODI_CENTRE"})).value||[];n.forEach((function(e){e.CODI_CENTRE=e.GEN_CENTRE.CODI_CENTRE,e.NOM_CENTRE=e.GEN_CENTRE.NOM_CENTRE,e.DISTRICTE=e.GEN_CENTRE.CODIINOM_DISTRICTE,e.ZONA=e.GEN_ZONA.CODI_ZONA,e.NIVELL=e.GEN_NIVELL.NIVELL})),"PDF"===e?function(e,t){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const a={pageOrientation:"landscape",pageMargins:[30,75,30,30],header:function(e,t){return{margin:[30,30,20,0],columns:[{text:"Assignació places NESE",width:165,alignment:"left",fontSize:14},{text:"Resum assignacions",width:"*",alignment:"center",fontSize:14},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:(new Date).toLocaleDateString("en-GB"),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}},content:[{layout:{defaultBorder:!1},table:{headerRows:2,widths:["7%","25%","8%","*","*","*",1,"*","*","*","*",1,"*","*","*","*"],body:[]}}],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:13,italics:!0},districte:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7",pageBreak:"before"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"}},defaultStyle:{fontSize:8}};function n(e,t,a,n,l,i){let[o,r,s,d,u,c,m,E,p,A,I]=[0,0,0,0,0,0,0,0,0,0,0];for(let e=0;e<i.length;e++)o+=i[e].OFERTA_NEEA,r+=i[e].OFERTA_NEEB,s+=i[e].OFERTA_NEE,d+=i[e].ASSIGNATS_NEEA,c+=i[e].ASSIGNATS_MANUAL_NEEA,m+=i[e].ASSIGNATS_1OPCIO_NEEA,E+=i[e].ASSIGNATS_OFICI_NEEA,u+=i[e].ASSIGNATS_NEEB,p+=i[e].ASSIGNATS_MANUAL_NEEB,A+=i[e].ASSIGNATS_1OPCIO_NEEB,I+=i[e].ASSIGNATS_OFICI_NEEB;e.content[0].table.body.push([{text:t,style:n,colSpan:l||1},{text:a,style:n},{text:" ",style:n},{text:o.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:r.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:s.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:" ",style:n},{text:c.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:m.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:E.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:d.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:"",style:n},{text:p.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:A.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:I.toLocaleString("ca-ES"),style:n,alignment:"right"},{text:u.toLocaleString("ca-ES"),style:n,alignment:"right"}])}a.content[0].table.body.push([{text:""},{text:""},{text:""},{text:"Oferta",bold:!0,alignment:"center",colSpan:3,border:[!1,!1,!1,!0],margin:[2,0,0,2]},"","","",{text:"Assignacions NEE-A ",bold:!0,alignment:"center",border:[!1,!1,!1,!0],margin:[2,0,0,2],colSpan:4},"","","","",{text:"Assignacions NEE-B ",bold:!0,alignment:"center",border:[!1,!1,!1,!0],margin:[2,0,0,2],colSpan:4},"","",""]),a.content[0].table.body.push([{text:""},{text:""},{text:""},{text:"NEE-A",bold:!0,alignment:"right"},{text:"NEE-B",bold:!0,alignment:"right"},{text:"Total",bold:!0,alignment:"right"},{text:""},{text:"Manual",bold:!0,alignment:"right"},{text:"1a opció",bold:!0,alignment:"right"},{text:"Ofici",bold:!0,alignment:"right"},{text:"Total",bold:!0,alignment:"right"},{text:""},{text:"Manual",bold:!0,alignment:"right"},{text:"1a opció",bold:!0,alignment:"right"},{text:"Ofici",bold:!0,alignment:"right"},{text:"Total",bold:!0,alignment:"right"}]),e.forEach(((e,l,i)=>function(e,t,a,l,i){0===a&&n(e,"T.general"," ","general",3,l),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE||n(e,t.DISTRICTE,"","districte",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE))),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA||n(e,t.ZONA,"","zona",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA))),0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA&&l[a-1].TITULARITAT===t.TITULARITAT||n(e,"",t.TITULARITAT,"titularitat",1,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA&&e.TITULARITAT===t.TITULARITAT))),i||0!==a&&l[a-1].DISTRICTE===t.DISTRICTE&&l[a-1].ZONA===t.ZONA&&l[a-1].TITULARITAT===t.TITULARITAT&&l[a-1].CODI_CENTRE===t.CODI_CENTRE||n(e,t.CODI_CENTRE+" "+t.NOM_CENTRE," ","centre",3,l.filter((e=>e.DISTRICTE===t.DISTRICTE&&e.ZONA===t.ZONA&&e.TITULARITAT===t.TITULARITAT&&e.CODI_CENTRE===t.CODI_CENTRE))),e.content[0].table.body.push([{text:i?t.CODI_CENTRE:""},{text:i?t.NOM_CENTRE:""},{text:t.NIVELL},{text:t.OFERTA_NEEA,alignment:"right"},{text:t.OFERTA_NEEB,alignment:"right"},{text:t.OFERTA_NEE,alignment:"right"},{text:""},{text:t.ASSIGNATS_MANUAL_NEEA,alignment:"right"},{text:t.ASSIGNATS_1OPCIO_NEEA,alignment:"right"},{text:t.ASSIGNATS_OFICI_NEEA,alignment:"right"},{text:t.ASSIGNATS_NEEA,alignment:"right"},{text:""},{text:t.ASSIGNATS_MANUAL_NEEB,alignment:"right"},{text:t.ASSIGNATS_1OPCIO_NEEB,alignment:"right"},{text:t.ASSIGNATS_OFICI_NEEB,alignment:"right"},{text:t.ASSIGNATS_NEEB,alignment:"right"}])}(a,e,l,i,t))),Il.createPdf(a).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"resumAssignacions.pdf"})}(n,a):async function(e){or("resumAssignacions.csv",[{name:"DISTRICTE",label:"Districte",type:"string"},{name:"ZONA",label:"Zona",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"CODI_CENTRE",label:"Centre",type:"string"},{name:"NOM_CENTRE",label:"Nom centre",type:"string"},{name:"NIVELL",label:"Nivell",type:"string"},{name:"OFERTA_ORDINARIA",label:"Oferta Ord.",type:"number"},{name:"OFERTA_NEEA",label:"Oferta NEE-A",type:"number"},{name:"OFERTA_NEEB",label:"Oferta NEE-B",type:"number"},{name:"OFERTA_NEE",label:"Oferta total",type:"number"},{name:"DEMANDA_1OPCIO_ORDINARIA",label:"Demanda Ordi.",type:"number"},{name:"DEMANDA_1OPCIO_NEEA",label:"Demanda NEE-A",type:"number"},{name:"DEMANDA_1OPCIO_NEEB",label:"Demanda NEE-B",type:"number"},{name:"DEMANDA_1OPCIO",label:"Demanda total",type:"number"},{name:"ASSIGNATS_ORDINARIS",label:"Assignats ord.",type:"number"},{name:"ASSIGNATS_NEEA",label:"Assignats NEE-A",type:"number"},{name:"ASSIGNATS_NEEB",label:"Assignats NEE-B",type:"number"},{name:"ASSIGNATS",label:"Total assignats",type:"number"},{name:"ASSIGNATS_MANUAL_NEEA",label:"NEE-A ass. manual",type:"number"},{name:"ASSIGNATS_MANUAL_NEEB",label:"NEE-B ass. manual",type:"number"},{name:"ASSIGNATS_1OPCIO_ORDINARIS",label:"Ord. ass.1ª opc.",type:"number"},{name:"ASSIGNATS_1OPCIO_NEEA",label:"NEE-A ass.1ª opc.",type:"number"},{name:"ASSIGNATS_1OPCIO_NEEB",label:"NEE-B ass.1ª opc.",type:"number"},{name:"ASSIGNATS_1OPCIO",label:"Total ass.1ª opc.",type:"number"},{name:"ASSIGNATS_1OPCIO_ADSCRITS",label:"Ass. 1a op. addscrits",type:"number"},{name:"ASSIGNATS_2A_OPCIO_NEEA",label:"NEE-A ass.2ª opc.",type:"number"},{name:"ASSIGNATS_OFICI_ORDINARI",label:"Ass. ofici Ord",type:"number"},{name:"ASSIGNATS_OFICI_NEEA",label:"Ass. ofici NEE-A",type:"number"},{name:"ASSIGNATS_OFICI_NEEB",label:"Ass. ofici NEE-B",type:"number"},{name:"ASSIGNATS_ORDINARIS",label:"Total assignats Ord.",type:"number"},{name:"ASSIGNATS_NEEA",label:"Total assignats NEE-A",type:"number"},{name:"ASSIGNATS_NEEB",label:"Total assignats NEE-B",type:"number"}],e)}(n)}function cr(e,t){return{margin:[30,30,20,0],columns:[{text:"Assignació places NESE",width:165,alignment:"left",fontSize:14},{text:"Detall assignacions",width:"*",alignment:"center",fontSize:14},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:(new Date).toLocaleDateString("en-GB"),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}}function mr(e,t,a,n,l,i){e.content[0].table.body.push([{text:t,style:n,colSpan:l||1},{text:a,style:n}].concat(Array(9).fill({text:"",style:n})))}const Er={class:"AANEE_ASSIGNACIO_PLACES"},pr={style:{"grid-area":"BOTONS","text-align":"center"}},Ar=(e=>((0,n.pushScopeId)("data-v-3f4e7711"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("iframe",{style:{"grid-area":"VISOR"},class:"visor",id:"pdfVISOR"},null,-1))),Ir={__name:"calcul-assignacio",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=La(),i=we(),o=(0,n.computed)((()=>!s.dataCalcul||!s.reportId)),s=(0,n.reactive)({dataCalcul:null,adscripcioNEEA:!0,adscripcioNEEB:!0,distanciaPrimariaTit:20,distanciaSecundariaTit:25,distanciaPrimaria:30,distanciaSecundaria:35,desempat:0,tipusGedac:!1,reportId:null,id_etapa:null,etapes:[],nivells:[],centres:[],id_centre:null,id_nivell:null,reportList:[{value:1,text:"Resum assignacions"},{value:2,text:"Detall assignacions"},{value:3,text:"Resum oferta i demanda"},{value:4,text:"Llista assignacions"}]});async function d(e){const t=[];if(s.id_centre&&(2!==s.reportId?t.push(`ID_CENTRE eq ${s.id_centre}`):t.push(`ID_CENTRE_ASSIGNAT eq ${s.id_centre}`)),s.id_nivell&&t.push(`ID_NIVELL eq ${s.id_nivell}`),s.id_etapa)switch(s.id_etapa){case 1:t.push("ID_NIVELL in (2,3,4)");break;case 2:t.push("ID_NIVELL in (5,6,7,8,9,10)");break;case 3:t.push("ID_NIVELL in (11,12,13,14)")}switch(s.reportId){case 1:ur(e,t.join(" and ")||void 0,s.id_nivell);break;case 2:!async function(e,t,a){const n=(await xe("AANEE_ALUMNE_ASSIGNACIO",{$expand:"AANEE_ALUMNE($select=NUM_SOLICITUD_GEDAC,IDALU,COGNOMSINOM,SENSE_BARRERES,SIEI,SIAL),GEN_CENTRE($select=ID,CODI_CENTRE),GEN_CENTRE1($select=ID,CODIINOM_CENTRE,TITULARITAT,CODIINOM_DISTRICTE),GEN_ZONA($select=CODI_ZONA),GEN_NIVELL($select=NIVELL)",$filter:t,$orderby:"GEN_CENTRE1/CODIINOM_DISTRICTE,GEN_ZONA/CODI_ZONA,GEN_CENTRE1/TITULARITAT,GEN_CENTRE1/CODIINOM_CENTRE,GEN_NIVELL/ID"})).value||[];n.forEach((function(e){e.NUM_SOLICITUD=e.AANEE_ALUMNE.NUM_SOLICITUD_GEDAC,e.IDALU=e.AANEE_ALUMNE.IDALU,e.TIPUS_ALUMNE=e.AANEE_ALUMNE.TIPUS_ALUMNE,e.TIPUS_ALUMNE_GEDAC=e.AANEE_ALUMNE.TIPUS_ALUMNE_GEDAC,e.TIPUS_ALUMNE_CALCUL=e.AANEE_ALUMNE.TIPUS_ALUMNE_CALCUL,e.TIPUS_ESCOLARITZACIOL=e.AANEE_ALUMNE.TIPUS_ESCOLARITZACIOL,e.COGNOMSINOM=e.AANEE_ALUMNE.COGNOMSINOM,e.SENSE_BARRERES=e.AANEE_ALUMNE.SENSE_BARRERES,e.SIEI=e.AANEE_ALUMNE.SIEI,e.SIAL=e.AANEE_ALUMNE.SIAL,e.CODI_CENTRE_P1=e.GEN_CENTRE.CODI_CENTRE,e.CODIINOM_CENTRE=e.GEN_CENTRE1.CODIINOM_CENTRE,e.TITULARITAT=e.GEN_CENTRE1.TITULARITAT,e.DISTRICTE=e.GEN_CENTRE1.CODIINOM_DISTRICTE,e.ZONA=e.GEN_ZONA.CODI_ZONA,e.NIVELL=e.GEN_NIVELL.NIVELL})),"PDF"===e?function(e,t){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const a={pageOrientation:"landscape",pageMargins:[40,75,40,40],header:cr,content:[{layout:{defaultBorder:!1},table:{headerRows:1,widths:["1%","25%","7%","25%","4%","6%","4%","7%","6%","4%","4%"],body:[]}}],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:13,italics:!0},districte:{bold:!0,fontSize:12,background:"#0078d7",color:"white",fillColor:"#0078d7",pageBreak:"before"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"}},defaultStyle:{fontSize:8}};a.content[0].table.body.push([{text:""},{text:""},{text:""},{text:"Cognoms i nom",bold:!0},{text:"Tipus",bold:!0},{text:"Assignació"},{text:"Opció\nassig.",bold:!0,alignment:"right"},{text:"Centre\n1a opció",bold:!0,alignment:"center"},{text:"Sense\nbarreres",bold:!0,alignment:"center"},{text:"SIEI",bold:!0,alignment:"center"},{text:"SIAL",bold:!0,alignment:"center"}]),e.forEach(((e,n,l)=>function(e,t,a,n,l){0!==a&&n[a-1].DISTRICTE===t.DISTRICTE||mr(e,t.DISTRICTE,"","districte",3),0!==a&&n[a-1].DISTRICTE===t.DISTRICTE&&n[a-1].ZONA===t.ZONA||mr(e,t.ZONA,"","zona",3),0!==a&&n[a-1].DISTRICTE===t.DISTRICTE&&n[a-1].ZONA===t.ZONA&&n[a-1].TITULARITAT===t.TITULARITAT||mr(e,"",t.TITULARITAT,"titularitat",1),l||0!==a&&n[a-1].DISTRICTE===t.DISTRICTE&&n[a-1].ZONA===t.ZONA&&n[a-1].TITULARITAT===t.TITULARITAT&&n[a-1].CODIINOM_CENTRE===t.CODIINOM_CENTRE||mr(e,t.CODIINOM_CENTRE," ","centre",3),e.content[0].table.body.push([{text:!l||0!==a&&n[a-1].CODIINOM_CENTRE===t.CODIINOM_CENTRE?"":t.CODIINOM_CENTRE,colSpan:2},{text:""},{text:t.NIVELL},{text:t.COGNOMSINOM},{text:t.TIPUS_ALUMNE_CALCUL},{text:t.TIPUS_ASSIGNACIO},{text:t.OPCIO_ASSIGNACIO,alignment:"right"},{text:t.CODI_CENTRE_P1,alignment:"center"},{text:"Sí"===t.SENSE_BARRERES?"X":"",alignment:"center"},{text:"Sí"===t.SIEI?"X":"",alignment:"center"},{text:"Sí"===t.SIAL?"X":"",alignment:"center"}])}(a,e,n,l,t))),Il.createPdf(a).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"detallAssignacions.pdf"})}(n,a):async function(e){or("detallAssignacions.csv",[{name:"DISTRICTE",label:"Districte",type:"string"},{name:"ZONA",label:"Zona",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"CODIINOM_CENTRE",label:"Centre",type:"string"},{name:"NIVELL",label:"Nivell",type:"string"},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string"},{name:"TIPUS_ALUMNE_CALCUL",label:"Tipus alumne",type:"string"},{name:"TIPUS_ASSIGNACIO",label:"Tipus assignació",type:"string"},{name:"GRUPS_ASSIGNACIO",label:"Grup assignació",type:"string"},{name:"OPCIO_ASSIGNACIO",label:"Opció assignada",type:"number"},{name:"ORDRE_ASSIGNACIO",label:"Ordre assignació",type:"number"},{name:"CODI_CENTRE_P1",label:"Centre 1ª opció",type:"string"},{name:"SENSE_BARRERES",label:"Sense barreres",type:"string"},{name:"SIEI",label:"SIEI",type:"string"},{name:"SIAL",label:"SIAL",type:"string"}],e)}(n)}(e,t.join(" and ")||void 0,s.id_nivell);break;case 3:dr(e,t.join(" and ")||void 0,s.id_nivell);break;case 4:!async function(){const e=T(),t=await fetch(`${m}/Stored/PR_AANEE_LLISTA_ASSIGNACIO`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:e.jwt},body:JSON.stringify({})}),a=await t.json();or("LlistaAssignacions.csv",[{name:"SITUACIO",label:"Situació",type:"string"},{name:"TIPUS_ASSIGNACIO",label:"Tipus assignació",type:"string"},{name:"GRUP_ASSIGNACIO",label:"Grup assignació",type:"string"},{name:"ORDRE_ASSIGNACIO",label:"Ordre assignació",type:"string"},{name:"OPCIO_ASSIGNACIO",label:"Opció",type:"string"},{name:"OPCIOCENTRE",label:"Preferència",type:"string"},{name:"NUM_SOLICITUD",label:"Num.Sol·licitud",type:"string"},{name:"ESTAT_SOLICITUD",label:"Estat Sol·licitud",type:"string"},{name:"IDALU",label:"Idalu",type:"string"},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string"},{name:"NIVELL",label:"Nivell",type:"string"},{name:"TIPUS_ALUMNE",label:"Tipus alumne AANEE",type:"string"},{name:"TIPUS_ALUMNE_GEDAC",label:"Tipus alumne GEDAC",type:"string"},{name:"TIPUS_ALUMNE_CALCUL",label:"Tipus alumne càlcul",type:"string"},{name:"TIPUS_ESCOLARITZACIO",label:"Tipus escolarització",type:"string"},{name:"CODI_CENTRE_PROCEDENCIA",label:"C. procedencia",type:"string"},{name:"NOM_CENTRE_PROCEDENCIA",label:"Nom c. procedencia",type:"string"},{name:"CODI_CENTRE_ASSIGNAT",label:"C. assignat",type:"string"},{name:"NOM_CENTRE_ASSIGNAT",label:"Nom c. assignat",type:"string"},{name:"DISTRICTE_ASS",label:"Districte",type:"string"},{name:"CODI_ZONA_ASS",label:"Zona",type:"string"},{name:"CODI_CENTRE_P1",label:"C. 1a opció",type:"string"},{name:"NOM_CENTRE1",label:"Nom c. 1a opció",type:"string"},{name:"DISTRICTE_1A",label:"Districte 1a op.",type:"string"},{name:"CODI_ZONA_1A",label:"Zona 1a op.",type:"string"},{name:"CODI_CENTRE_P2",label:"C. 2a opció",type:"string"},{name:"NOM_CENTRE2",label:"Nom c. 2a opció",type:"string"},{name:"CODI_CENTRE_P3",label:"C. 3a opció",type:"string"},{name:"NOM_CENTRE3",label:"Nom c. 3a opció",type:"string"},{name:"CODI_CENTRE_P4",label:"C. 4a opció",type:"string"},{name:"NOM_CENTRE4",label:"Nom c. 4a opció",type:"string"},{name:"CODI_CENTRE_P5",label:"C. 5a opció",type:"string"},{name:"NOM_CENTRE5",label:"Nom c. 5a opció",type:"string"},{name:"CODI_CENTRE_P6",label:"C. 6a opció",type:"string"},{name:"NOM_CENTRE6",label:"Nom c. 6a opció",type:"string"},{name:"CODI_CENTRE_P7",label:"C. 7a opció",type:"string"},{name:"NOM_CENTRE7",label:"Nom c. 7a opció",type:"string"},{name:"CODI_CENTRE_P8",label:"C. 8a opció",type:"string"},{name:"NOM_CENTRE8",label:"Nom c. 8a opció",type:"string"},{name:"CODI_CENTRE_P9",label:"C. 9a opció",type:"string"},{name:"NOM_CENTRE9",label:"Nom c. 9a opció",type:"string"},{name:"CODI_CENTRE_P10",label:"C. 10a opció",type:"string"},{name:"NOM_CENTRE10",label:"Nom c. 10a opció",type:"string"},{name:"AVALUACIO_NEEA",label:"Avaluació NEE-A",type:"string"},{name:"ES_NEEA",label:"És NEE-A",type:"string"},{name:"INSCRIPCIOFINAL_NEEA",label:"Preinscripció final NEE-A",type:"string"},{name:"ACORD_NEEA",label:"Acord/Desacord NEE-A",type:"string"},{name:"SENSE_BARRERES",label:"Sense barreres",type:"string"},{name:"SIEI",label:"SIEI",type:"string"},{name:"SIAL",label:"SIAL",type:"string"},{name:"CODI_CENTRE_PROPOSAT1",label:"1r centre proposat",type:"string"},{name:"NOM_CENTRE_PROPOSAT1",label:"Nom 1r centre proposat",type:"string"},{name:"CODI_CENTRE_PROPOSAT2",label:"2nr centre proposat",type:"string"},{name:"NOM_CENTRE_PROPOSAT2",label:"Nom 2n centre proposat",type:"string"},{name:"CODI_CENTRE_PROPOSAT3",label:"3r centre proposat",type:"string"},{name:"NOM_CENTRE_PROPOSAT3",label:"Nom 3r centre proposat",type:"string"},{name:"CODI_CENTRE_COMPARTIDA",label:"Centre compartida",type:"string"},{name:"NOM_CENTRE_COMPARTIDA",label:"Nom centre compartida",type:"string"},{name:"CODI_CENTRE_ASSIGNAT_CEB",label:"C. assignat escolarització",type:"string"},{name:"NOM_CENTRE_ASSIGNAT_CEB",label:"Nom c. assignat escolarització",type:"string"},{name:"AVALUACIO_NEEA",label:"Avaluació NEE-B",type:"string"},{name:"ES_NEEB",label:"És NEE-B",type:"string"},{name:"INSCRIPCIOFINAL_NEEB",label:"Preinscripció final NEE-B",type:"string"},{name:"GERMANS_ALCENTRE",label:"Germans al centre",type:"string"},{name:"ACOLLIMENT_FAMILIAR",label:"Acolliment familiar",type:"number"},{name:"SITUACIO_ACOLLIMENT",label:"Situació acolliment",type:"string"},{name:"ES_FORA_TERMINI",label:"Fora termini",type:"number"},{name:"ES_PENALITZA_DUPLICADA",label:"Penalitza duplicada",type:"number"},{name:"SIMULTANEITAT",label:"Simultaneïtat",type:"number"},{name:"ADSCRIPCIO",label:"Adscripció barem",type:"number"},{name:"ADSCRIPCIO_OP1",label:"Adscripció 1op.",type:"boolean"},{name:"ADSCRIPCIO_OP2",label:"Adscripció 2op.",type:"boolean"},{name:"ADSCRIPCIO_OP3",label:"Adscripció 3op.",type:"boolean"},{name:"ADSCRIPCIO_OP4",label:"Adscripció 3op.",type:"boolean"},{name:"ADSCRIPCIO_OP5",label:"Adscripció 3op.",type:"boolean"},{name:"ADSCRIPCIO_OP6",label:"Adscripció 3op.",type:"boolean"},{name:"PUNTS_GENERALS",label:"Punts generals",type:"number"},{name:"PUNTS_COMPLEMENTARIS",label:"Punts complementaris",type:"number"},{name:"NUMERO_DESEMPAT",label:"Número desempat",type:"number"},{name:"DEMANA_ASSIGNACIO_OFICI",label:"Demana assignació d'ofici",type:"string"},{name:"MUNICIPI_RESIDENCIA",label:"Municipi residència",type:"string"},{name:"CODI_CENTRE_PROCEDENCIA",label:"Centre procedència",type:"string"},{name:"NOM_CENTRE_PROCEDENCIA",label:"Nom centre procedència",type:"string"},{name:"NOM_MUNICIPI_PROXIMITAT",label:"Municipi proximitat",type:"string"},{name:"DISTANCIA_ASSIGNACIO_FORMAT",label:"Distància 1ª op.",type:"string"}],JSON.parse(a||"[]"))}()}}function u(){t.push(a.query.return)}return(0,n.onMounted)((async()=>{s.dataCalcul=l.dataCalcul,await i.loadDictionary("GEN_ETAPA"),await i.loadDictionary("GEN_CENTRE"),await i.loadDictionary("GEN_NIVELL"),s.etapes=i.data.GEN_ETAPA.filter((e=>e.ID<=3)).map((e=>({value:e.ID,text:e.ETAPA}))),s.nivells=i.data.GEN_NIVELL.filter((e=>e.ID>=2)).map((e=>({value:e.ID,text:e.NIVELL}))),s.centres=i.data.GEN_CENTRE.map((e=>({value:e.ID,text:e.NOMICODI_CENTRE})))})),(e,i)=>{const r=(0,n.resolveComponent)("fura-label"),c=(0,n.resolveComponent)("fura-checkbox"),E=(0,n.resolveComponent)("fura-number-field"),p=(0,n.resolveComponent)("fura-button"),A=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Calcular assignació de places"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Er,[(0,n.createVNode)(r,{style:{"grid-area":"calcul","margin-top":"32px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Paràmetres càlcul ")])),_:1}),(0,n.createVNode)(c,{style:{"grid-area":"adscripcioNEEA","margin-top":"36px"},label:"Emprar  adscripcions NEE-A",modelValue:s.adscripcioNEEA,"onUpdate:modelValue":i[0]||(i[0]=e=>s.adscripcioNEEA=e)},null,8,["modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"adscripcioNEEB","margin-top":"36px"},label:"Emprar adscripcions NEE-B",modelValue:s.adscripcioNEEB,"onUpdate:modelValue":i[1]||(i[1]=e=>s.adscripcioNEEB=e)},null,8,["modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"TIPUSGEDAC","margin-top":"36px"},class:"show-all",label:"Emprar tipus alumne GEDAC",modelValue:s.tipusGedac,"onUpdate:modelValue":i[2]||(i[2]=e=>s.tipusGedac=e)},null,8,["modelValue"]),(0,n.createVNode)(E,{style:{"grid-area":"DESEMPAT"},align:"right",label:"Nº desempat","use-grouping":"","maximum-fraction-digits":0,modelValue:s.desempat,"onUpdate:modelValue":i[3]||(i[3]=e=>s.desempat=e)},null,8,["modelValue"]),(0,n.createVNode)(p,{style:{"grid-area":"CALCULAR","margin-top":"28px"},text:"Calcular",icon:"Calculator",onClick:i[4]||(i[4]=e=>async function(){const e=T(),n=he();n.confirm({title:"Calcul assignació de places",message:"Calcular l'assignació de places ?",accept:async()=>{n.loadStart("calcul");const i=await fetch(`${m}/Stored/pr_AANEE_CALCUL_ASSIGNACIO`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:e.jwt},body:JSON.stringify({adscritsNeea:s.adscripcioNEEA?1:0,adscritsNeeb:s.adscripcioNEEB?1:0,desempat:s.desempat,tipusGedac:s.tipusGedac?1:0})});if(n.loadEnd("calcul"),200===i.status){n.alert({title:"Assignació de places",message:"Càlcul finalitzat"});const e=await xe("AANEE_SETTINGS(1)");l.saveConfig(e),t.push(a.query.return)}else n.alert({title:"Assignació de places",message:"Error inesperat."})}})}())}),(0,n.createVNode)(A,{style:{"grid-area":"REPORT"},label:"Fer aquest informe",disabled:!s.dataCalcul,options:s.reportList,required:"",modelValue:s.reportId,"onUpdate:modelValue":i[5]||(i[5]=e=>s.reportId=e)},null,8,["disabled","options","modelValue"]),(0,n.createVNode)(A,{label:"Etapa",style:{"grid-area":"ID_ETAPA"},disabled:4===s.reportId,options:s.etapes,"clear-value-on-disabled":"",modelValue:s.id_etapa,"onUpdate:modelValue":i[6]||(i[6]=e=>s.id_etapa=e)},null,8,["disabled","options","modelValue"]),(0,n.createVNode)(A,{label:"Nivell",style:{"grid-area":"ID_NIVELL"},disabled:4===s.reportId,options:s.nivells,"clear-value-on-disabled":"",modelValue:s.id_nivell,"onUpdate:modelValue":i[7]||(i[7]=e=>s.id_nivell=e)},null,8,["disabled","options","modelValue"]),(0,n.createVNode)(A,{label:"Centre",style:{"grid-area":"ID_CENTRE"},disabled:4===s.reportId,options:s.centres,"allow-freeform":"","auto-complete":"","immediate-scroll":"","clear-value-on-disabled":"",modelValue:s.id_centre,"onUpdate:modelValue":i[8]||(i[8]=e=>s.id_centre=e)},null,8,["disabled","options","modelValue"]),(0,n.createElementVNode)("div",pr,[(0,n.createVNode)(p,{class:"boto",disabled:(0,n.unref)(o)||4===s.reportId,text:"PDF",icon:"PDF",onClick:i[9]||(i[9]=e=>d("PDF"))},null,8,["disabled"]),(0,n.createVNode)(p,{class:"boto",disabled:(0,n.unref)(o),text:"CSV",icon:"ExcelLogo",onClick:i[10]||(i[10]=e=>d("CSV"))},null,8,["disabled"]),(0,n.createVNode)(p,{class:"boto",text:"Tornar",icon:"ChromeClose",onClick:u})]),Ar])])),_:1})}}},Nr=(0,R.Z)(Ir,[["__scopeId","data-v-3f4e7711"]]);async function yr(e){return(await xe("AANEE_SIMULACIO_OFERTA",{$filter:`ID_SIMULACIO eq ${e.ID}`,$expand:"GEN_CENTRE($select=CODIINOM_CENTRE)",$orderby:"GEN_CENTRE/CODI_CENTRE"})).value}async function Cr(e,t,a,n){fr(e,t,await yr(t),a,!0)}function fr(e,t,a,n,l){e.content.push([{text:"Modificacions "+t.CODI_SIMULACIO+" "+t.NOM_SIMULACIO,color:"white",pageBreak:l?"before":"",tocItem:!0,fontSize:2,tocStyle:{bold:!0},tocMargin:[20,10,0,0]}]);const i={layout:"noBorders",table:{widths:["100%"],body:[[{text:"Modificacions "+t.CODI_SIMULACIO+" "+t.NOM_SIMULACIO,style:"tocTitle"}],[{text:" ",fontSize:6}],[{text:"Modificació de l'oferta",style:"districte"}],[{text:" ",fontSize:4}]]}};e.content.push(i);const o={layout:"noBorders",table:{widths:["30%","9%","10%","9%","9%","10%","9%","9%"],body:[[{text:"Centre",bold:!0},{text:"+/- grups",alignment:"right",bold:!0},{text:"Ordinaria X grup",alignment:"right",bold:!0},{text:"NEE A x Grup",alignment:"right",bold:!0},{text:"NEE B x Grup",alignment:"right",bold:!0},{text:"Ordinària. x Centre",alignment:"right",bold:!0},{text:"NEE-A x Centre",alignment:"right",bold:!0},{text:"NEE-B x Centre",alignment:"right",bold:!0}]]}};a.forEach(((e,t,a)=>{return l=o.table,i=e,n.incloureIndex,void l.body.push([{text:i.GEN_CENTRE.CODIINOM_CENTRE},{text:i.MODIFICACIO_GRUPS,alignment:"right"},{text:i.MODIFICACIO_ORDINARIA_GRUP,alignment:"right"},{text:i.MODIFICACIO_NEEA_GRUP,alignment:"right"},{text:i.MODIFICACIO_NEEB_GRUP,alignment:"right"},{text:i.MODIFICACIO_ORDINARIA_CENTRE,alignment:"right"},{text:i.MODIFICACIO_NEEA_CENTRE,alignment:"right"},{text:i.MODIFICACIO_NEEB_CENTRE,alignment:"right"}]);var l,i})),e.content.push(o)}function _r(e,t,a,n,l,i,o){let[r,s,d,u,c,m,E,p,A,I,N,y,C]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let e=0;e<i.length;e++)r+=i[e].GRUPS_FINAL,s+=i[e].PREVISSIO_RESERVA,d+=i[e].OFERTA_TOTAL_FINAL,u+=i[e].DEMANDA_1OPCIO,c+=i[e].DEMANDA_1OPCIO_ADSCRITS,m+=i[e].ALUMNES_ASSIGNATS_TOTAL,E+=i[e].ALUMNES_OFICI,p+=i[e].ALUMNES_OFICI_ADSCRITS,A+=i[e].PLACES_VACANTS,I+=i[e].ALUMNES_OFICI_ORDINARIS,N+=i[e].PLACES_VACANTS_ORDINARIES,y+=i[e].ALUMNES_OFICI_NEE,C+=i[e].PLACES_VACANTS_NEE;e.push([{text:a,alignment:n,style:l,colSpan:2},{text:"",style:l},{text:r.toLocaleString("ca-ES"),alignment:"right",style:l},{text:s.toLocaleString("ca-ES"),alignment:"right",style:l},{text:d.toLocaleString("ca-ES"),alignment:"right",style:l},{text:u.toLocaleString("ca-ES"),alignment:"right",style:l},{text:c.toLocaleString("ca-ES"),alignment:"right",style:l},{text:m.toLocaleString("ca-ES"),alignment:"right",style:l},{text:E.toLocaleString("ca-ES"),alignment:"right",style:l},{text:p.toLocaleString("ca-ES"),alignment:"right",style:l},{text:A.toLocaleString("ca-ES"),alignment:"right",style:l},{text:I.toLocaleString("ca-ES"),alignment:"right",style:l},{text:N.toLocaleString("ca-ES"),alignment:"right",style:l},{text:y.toLocaleString("ca-ES"),alignment:"right",style:l},{text:C.toLocaleString("ca-ES"),alignment:"right",style:l},{text:"",alignment:"right",style:l},{text:"",alignment:"right",style:l}]),["districte","zona"].includes(l)&&e.push([{text:"",fontSize:"4px",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}]),o&&e.push([{text:a,color:"white",tocItem:!0,tocMargin:[40,10,0,0]},"","","","","","","","","","","","","","","",""])}function Tr(e,t,a,n,l,i,o){let[r,s,d,u,c,m,E,p,A,I,N,y,C]=[0,0,0,0,0,0,0,0,0,0,0,0,0];const f="districte"===l&&t>0?"before":"none";for(let e=0;e<i.length;e++)r+=i[e].GRUPS_FINAL,s+=i[e].PREVISSIO_RESERVA,d+=i[e].OFERTA_TOTAL_FINAL,u+=i[e].DEMANDA_1OPCIO,c+=i[e].DEMANDA_1OPCIO_ADSCRITS,m+=i[e].ALUMNES_ASSIGNATS_TOTAL,E+=i[e].ALUMNES_OFICI,p+=i[e].ALUMNES_OFICI_ADSCRITS,A+=i[e].PLACES_VACANTS,I+=i[e].ALUMNES_OFICI_ORDINARIS,N+=i[e].PLACES_VACANTS_ORDINARIES,y+=i[e].ALUMNES_OFICI_NEE,C+=i[e].PLACES_VACANTS_NEE;e.push([{text:a,alignment:n,style:l,pageBreak:f,colSpan:2},{text:"",style:l,pageBreak:f},{text:r.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:s.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:d.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:u.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:c.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:m.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:E.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:p.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:A.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:I.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:N.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:y.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:C.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:f},{text:"",style:l,pageBreak:f},{text:"",style:l,pageBreak:f}]),["districte","zona"].includes(l)&&e.push([{text:"",fontSize:"4px",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}]),o&&e.push([{text:a||"",color:"white",tocItem:!0,tocMargin:[40,10,0,0]},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"},{text:"",color:"white"}])}function gr(e,t,a,n,l,i,o){let[r,s,d,u,c,m,E,p,A,I,N,y]=Array(12).fill(0);const C="districte"===l&&t>0?"before":"none";for(let e=0;e<i.length;e++)r+=i[e].GRUPS_FINAL,s+=i[e].OFERTA_TOTAL_FINAL,d+=i[e].DEMANDA_1OPCIO,u+=i[e].DEMANDA_1OPCIO_ADSCRITS,c+=i[e].ALUMNES_OFICI,m+=i[e].ALUMNES_OFICI_ADSCRITS,E+=i[e].PLACES_VACANTS,p+=i[e].ASSIGNATS_ONSIGUI,A+=i[e].ALUMNES_ASSIGNATS_1OPCIO,I+=i[e].ALUMNES_ASSIGNATS_NO1OPCIO,N+=i[e].ALUMNES_ASSIGNATS_TOTAL,y+=i[e].ALUMNES_ASSIGNATS_RESTA;e.push([{text:a,alignment:n,style:l,pageBreak:C},{text:r.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:s.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:d.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:u.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:c.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:m.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:E.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:p.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:A.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:I.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:N.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:A.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C},{text:y.toLocaleString("ca-ES"),alignment:"right",style:l,pageBreak:C}]),["districte","zona"].includes(l)&&e.push(Array(14).fill({text:"",fontSize:"4px",style:"espai"})),o&&"districte"===l&&e.push([{text:a||"xxxx",color:"white",fontSize:3,tocItem:!0,tocMargin:[40,10,0,0]}].concat(Array(13).fill({text:"",style:"espai"})))}const Or={class:"AANEE_SIMULACIO-reports"},Sr={style:{"grid-area":"BOTONS","text-align":"center"}},br=(0,n.createElementVNode)("iframe",{style:{"grid-area":"VISOR"},class:"visor",id:"pdfVISOR"},null,-1),Dr={__name:"reports_simulacions",setup(e){const t=(0,r.useRouter)(),a=(0,r.useRoute)(),l=(0,n.reactive)({reportId:null,filename:"",id_centre:null,id_nivell:null,titularitat:null,numSolicitud:null,incloureIndex:!0,incloureDescripcio:!0,incloureTotalsTit:!0,incloureTotalsOpcio:!0,inclureModificacions:!0,centres:[],centresFiltered:[],reportList:[{value:1,text:"Resum per districtes, zones i titularitat"},{value:2,text:"Resum per districtes, zones, titularitat i centres"},{value:3,text:"Resum per centres"},{value:4,text:"Modificació oferta simulació"},{value:5,text:"Llista d'alumnes"},{value:6,text:"Llista d'inscripcions del centre"},{value:7,text:"Sol·licituds preferents a l'alumne escollit"}]}),i=(0,n.computed)((()=>!l.reportId||[5,6,7].includes(l.reportId))),o=(0,n.computed)((()=>!l.reportId||6===l.reportId&&!l.id_centre||7===l.reportId&&!l.numSolicitud));function s(){t.push(a.query.return)}async function d(e){const t=await xe(`AANEE_SIMULACIO(${a.query.id})`,{$select:"ID,CODI_SIMULACIO,NOM_SIMULACIO,ID_NIVELL,DESCRIPCIO",$expand:"GEN_NIVELL($select=ID_ETAPA)"});switch(l.reportId){case 1:!async function(e,t,a,n){const l=`ID_SIMULACIO eq ${t.ID}`+(a.titularitat?` and GEN_CENTRE/TITULARITAT eq '${a.titularitat}'`:""),i=(await xe("AANEE_SIMULACIO_RESULTAT_CENTRE",{$apply:`filter(${l})/groupby((CODIINOM_DISTRICTE,CODI_ZONA,GEN_CENTRE/TITULARITAT),aggregate(GRUPS_FINAL with sum as GRUPS_FINAL,PREVISSIO_RESERVA with sum as PREVISSIO_RESERVA,OFERTA_ORDINARIA_FINAL with sum as OFERTA_ORDINARIA_FINAL,OFERTA_NEE_FINAL with sum as OFERTA_NEE_FINAL,ALUMNES_ASSIGNATS_TOTAL with sum as ALUMNES_ASSIGNATS_TOTAL,ALUMNES_ASSIGNATS_ORDINARIS with sum as ALUMNES_ASSIGNATS_ORDINARIS,ALUMNES_ASSIGNATS_NEE with sum as ALUMNES_ASSIGNATS_NEE,DEMANDA_1OPCIO with sum as DEMANDA_1OPCIO,DEMANDA_1OPCIO_ADSCRITS with sum as DEMANDA_1OPCIO_ADSCRITS,ALUMNES_OFICI with sum as ALUMNES_OFICI,ALUMNES_OFICI_ADSCRITS with sum as ALUMNES_OFICI_ADSCRITS,ALUMNES_OFICI_ORDINARIS with sum as ALUMNES_OFICI_ORDINARIS,ALUMNES_OFICI_NEE with sum as ALUMNES_OFICI_NEE))`,$orderBy:"CODIINOM_DISTRICTE,CODI_ZONA,GEN_CENTRE/TITULARITAT desc"})).value;i.forEach((function(e){e.OFERTA_TOTAL_FINAL=e.OFERTA_ORDINARIA_FINAL+e.OFERTA_NEE_FINAL,e.PLACES_VACANTS=e.OFERTA_ORDINARIA_FINAL+e.OFERTA_NEE_FINAL-e.ALUMNES_ASSIGNATS_TOTAL,e.PLACES_VACANTS_ORDINARIES=e.OFERTA_ORDINARIA_FINAL-e.ALUMNES_ASSIGNATS_ORDINARIS,e.PLACES_VACANTS_NEE=e.OFERTA_NEE_FINAL-e.ALUMNES_ASSIGNATS_NEE,e.TITULARITAT=e.GEN_CENTRE.TITULARITAT})),"PDF"===e?async function(e,t,a,n){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const l={pageOrientation:"landscape",pageMargins:[30,80,18,0],header:ar("Resum per Districtes, Zones i titularitat",t),content:[],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:7,italics:!0},districte:{bold:!0,fontSize:11,background:"#0078d7",color:"white",fillColor:"#0078d7"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:7},centre:{fontSize:6},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"},espai:{fontSize:6}},defaultStyle:{fontSize:7}};t.DESCRIPCIO&&a.incloureDescripcio&&(l.content.push({text:" ",fontSize:4}),l.content.push([{margin:[3,0,0,7],text:[{text:"Descripció: ",bold:!0,fontSize:12},{text:t.DESCRIPCIO,alignment:"justify",fontSize:11}]}]),l.content.push({text:" ",fontSize:4})),a.incloureIndex&&(l.content.push([{toc:{title:{text:"ÍNDEX \n\r",fontSize:12},numberStyle:{bold:!0}},margin:[120,20,120,0],pageBreak:"after"}]),l.content.push([{text:"Resum per Districtes, Zones i Titularitat",color:"white",fontSixe:4,tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]}]));const i={layout:"noBorders",table:{headerRows:1,widths:["15%","3%","4%","*","*","*","*","*","*","*","*","*","*","*","*","*","*"],body:[[{text:"Districte/Zona/Titularitat/Centre",colSpan:2},{text:""},{text:"Grups",alignment:"right"},{text:"Reserva",alignment:"right"},{text:"Places",alignment:"right"},{text:"Demanda",alignment:"right"},{text:"Demanda\nAdscrits",alignment:"right"},{text:"Assignades",alignment:"right"},{text:"Ofici\ntotal",alignment:"right"},{text:"Ofici\nadscrits",alignment:"right"},{text:"Vacants\ntotal",alignment:"right"},{text:"Ofici\nordinaris",alignment:"right"},{text:"Vacants\nordinaris",alignment:"right"},{text:"Ofici\nNEE",alignment:"right"},{text:"Vacants\nNEE",alignment:"right"},{text:"Llista\nd'espera",alignment:"right"},{text:"Espera\ndofici",alignment:"right"}]]}};if(e.forEach(((e,t,n)=>o(i.table.body,e,t,n,a.incloureIndex,!0))),a.incloureTotalsTit){const t=[{text:"",fontSize:"4px",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}];a.incloureIndex&&i.table.body.push([{text:"Total per titularitat",color:"white",fontSize:3,tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]},"","","","","","","","","","","","","","","",""]),i.table.body.push(t),i.table.body.push([{text:"Total per titularitat",style:"districte",colSpan:15},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"}]),i.table.body.push(t),lr(i.table.body,e,o,a.incloureIndex)}function o(e,t,n,l,i,o){o?(0===n&&_r(e,0,"T.general","left","general",l,!1),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE||_r(e,0,t.CODIINOM_DISTRICTE,"left","districte",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE)),i),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA||_r(e,0,t.CODI_ZONA,"right","zona",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA),!1)),a.titularitat||0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA&&l[n-1].TITULARITAT===t.TITULARITAT||_r(e,0,t.TITULARITAT,"right","titularitat",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA&&e.TITULARITAT===t.TITULARITAT)),!1)):e.push([{text:l[n].TITULARITAT,colSpan:2},{text:""},{text:l[n].GRUPS_FINAL.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].PREVISSIO_RESERVA.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].OFERTA_TOTAL_FINAL.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].DEMANDA_1OPCIO.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].DEMANDA_1OPCIO_ADSCRITS.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].ALUMNES_ASSIGNATS_TOTAL.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].ALUMNES_OFICI.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].ALUMNES_OFICI_ADSCRITS.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].PLACES_VACANTS.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].ALUMNES_OFICI_ORDINARIS.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].PLACES_VACANTS_ORDINARIES.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].ALUMNES_OFICI_NEE.toLocaleString("ca-ES"),alignment:"right"},{text:l[n].PLACES_VACANTS_NEE.toLocaleString("ca-ES"),alignment:"right"},{text:"",alignment:"right"},{text:"",alignment:"right"}])}l.content.push(i),a.incloureTotalsOpcio&&await nr(l,t,a.incloureIndex),a.inclureModificacions&&await Cr(l,t,a),Il.createPdf(l).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"prova.pdf"})}(i,t,a):async function(e,t){e.forEach((function(e){e.N=1})),or("resumDistrictesZonesTitularitat.csv",[{name:"CODIINOM_DISTRICTE",label:"Districte",type:"string"},{name:"CODI_ZONA",label:"Zona",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"NOMICODI_CENTRE",label:"Nom i codi centre",type:"string"},{name:"N",label:"N",type:"number"},{name:"GRUPS_FINAL",label:"Grups",type:"number"},{name:"PREVISSIO_RESERVA",label:"Reserva",type:"number"},{name:"OFERTA_TOTAL_TOTAL",label:"Places",type:"number"},{name:"DEMANDA_1OPCIO",label:"Demanda 1ª opció",type:"number"},{name:"DEMANDA_1OPCIO_ADSCRITS",label:"Demanda 1ª opció\nadscrits",type:"number"},{name:"ALUMNES_ASSIGNATS_TOTAL",label:"Assignades",type:"number"},{name:"ALUMNES_OFICI",label:"Ofici total",type:"number"},{name:"ALUMNES_OFICI_ADSCRITS",label:"Ofici adscrits",type:"number"},{name:"PLACES_VACANTS",label:"Vacants total",type:"number"},{name:"ALUMNES_OFICI_ORDINARIS",label:"Ofici ordinaris",type:"number"},{name:"PLACES_VACANTS_ORDINARIES",label:"Vacants ordinaris",type:"number"},{name:"ALUMNES_OFICI_NEE",label:"Ofici NEE",type:"number"},{name:"PLACES_VACANTS_NEE",label:"Vacants NEE",type:"number"},{name:"ALUMNES_LLISTA_ESPERA",label:"Llista d'espera",type:"number"},{name:"ALUMNES_OFICI_CENTRE",label:"Espera ofici",type:"number"}],e)}(i)}(e,t,l,l.explicacio);break;case 2:!async function(e,t,a,n,l){const i=(await xe("AANEE_SIMULACIO_RESULTAT_CENTRE",{$filter:`ID_SIMULACIO eq ${t.ID}`+(a.titularitat?` and GEN_CENTRE/TITULARITAT eq '${a.titularitat}'`:""),$expand:"GEN_CENTRE($select=NOMICODI_CENTRE,TITULARITAT)",$orderBy:"CODIINOM_DISTRICTE,CODI_ZONA,GEN_CENTRE/TITULARITAT desc,GEN_CENTRE/NOM_CENTRE"})).value;var o;i.forEach((function(e){e.NOMICODI_CENTRE=(e.GEN_CENTRE.NOMICODI_CENTRE||"")+(0!==(e.MODIFICACIO_OFERTA_ORDINARIA||0)||0!==(e.MODIFICACIO_OFERTA_NEEA||0)||0!==(e.MODIFICACIO_OFERTA_NEEB||0)?" (*)":""),e.TITULARITAT=e.GEN_CENTRE.TITULARITAT||""})),"PDF"===e?async function(e,t,a,n,l){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const i={pageOrientation:"landscape",pageMargins:[30,80,18,0],header:ar("Resum per Districtes, Zones, Titularitat i Centres",t),content:[],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:12,italics:!0},dreta:{fontSize:12,italics:!0,alignment:"right"},districte:{bold:!0,fontSize:11,background:"#0078d7",color:"white",fillColor:"#0078d7"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"},espai:{fontSize:6}},defaultStyle:{fontSize:7}};t.DESCRIPCIO&&a.incloureDescripcio&&(i.content.push({text:" ",fontSize:4}),i.content.push([{margin:[3,0,0,7],text:[{text:"Descripció: ",bold:!0,fontSize:12},{text:t.DESCRIPCIO,alignment:"justify",fontSize:11}]}]),i.content.push({text:" ",fontSize:4})),a.incloureIndex&&(i.content.push([{toc:{title:{text:"ÍNDEX \n\r",fontSize:12},numberStyle:{bold:!0}},margin:[120,20,120,0],pageBreak:"after"}]),i.content.push([{text:"Resum per Districtes, Zones, Titularitat i centres",color:"white",fontSixe:4,tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]}]));const o={layout:"noBorders",table:{headerRows:1,widths:["16%","3%","4%","*","*","*","*","*","*","*","*","*","*","*","*","*","*"],body:[[{text:"Districte/Zona/Titularitat/Centre",colSpan:2},{text:""},{text:"Grups",alignment:"right"},{text:"Reserva",alignment:"right"},{text:"Places",alignment:"right"},{text:"Demanda",alignment:"right"},{text:"Demanda\nAdscrits",alignment:"right"},{text:"Assignades",alignment:"right"},{text:"Ofici\ntotal",alignment:"right"},{text:"Ofici\nadscrits",alignment:"right"},{text:"Vacants\ntotal",alignment:"right"},{text:"Ofici\nordinaris",alignment:"right"},{text:"Vacants\nordinaris",alignment:"right"},{text:"Ofici\nNEE",alignment:"right"},{text:"Vacants\nNEE",alignment:"right"},{text:"Llista\nd'espera",alignment:"right"},{text:"Espera\ndofici",alignment:"right"}]]}};if(e.forEach(((e,t,n)=>r(o.table.body,e,t,n,a.incloureIndex,!0,!0))),a.incloureTotalsTit){const t=[{text:"",fontSize:"4px",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}];a.incloureIndex&&o.table.body.push([{text:"Total per titularitat",color:"white",fontSize:3,tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"},{text:"",style:"espai"}]),o.table.body.push(t),o.table.body.push([{text:"Total per titularitat",style:"districte",colSpan:15},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"},{text:"",style:"districte"}]),o.table.body.push(t),lr(o.table.body,e,r,a.incloureIndex)}function r(e,t,n,l,i,o,r){o&&(0===n&&Tr(e,n,"T.general","left","general",l,!1),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE||Tr(e,n,t.CODIINOM_DISTRICTE,"left","districte",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE)),i),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA||Tr(e,n,t.CODI_ZONA,"right","zona",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA),!1)),a.titularitat||0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA&&l[n-1].TITULARITAT===t.TITULARITAT||Tr(e,n,t.TITULARITAT,"right","titularitat",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA&&e.TITULARITAT===t.TITULARITAT)),!1));const s=n%2!=0?"imparell":"";e.push([{text:t.NOMICODI_CENTRE?t.NOMICODI_CENTRE:t.TITULARITAT,style:s,colSpan:2,alignment:t.CODI_CENTRE?"left":"right"},{text:"",style:s},{text:t.GRUPS_FINAL.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.PREVISSIO_RESERVA.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.OFERTA_TOTAL_FINAL.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.DEMANDA_1OPCIO.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.DEMANDA_1OPCIO_ADSCRITS.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.ALUMNES_ASSIGNATS_TOTAL.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.ALUMNES_OFICI.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.ALUMNES_OFICI_ADSCRITS.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.PLACES_VACANTS.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.ALUMNES_OFICI_ORDINARIS.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.PLACES_VACANTS_ORDINARIES.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.ALUMNES_OFICI_NEE.toLocaleString("ca-ES"),alignment:"right",style:s},{text:t.PLACES_VACANTS_NEE.toLocaleString("ca-ES"),alignment:"right",style:s},{text:r?t.ALUMNES_LLISTA_ESPERA.toLocaleString("ca-ES"):"",alignment:"right",style:s},{text:r?t.ALUMNES_OFICI_CENTRE.toLocaleString("ca-ES"):"",alignment:"right",style:s}])}i.content.push(o),a.incloureTotalsOpcio&&await nr(i,t,a.incloureIndex),a.inclureModificacions&&await Cr(i,t,a),Il.createPdf(i).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"DistrictesZonesCentres.pdf"})}(i,t,a):((o=i).forEach((function(e){e.N=1})),or("resumDistrictesZonesTitularitat.csv",[{name:"DISTRICTE",label:"Districte",type:"string"},{name:"CODI_ZONA",label:"Zona",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"NOMICODI_CENTRE",label:"Nom i codi centre",type:"string"},{name:"N",label:"N",type:"number"},{name:"GRUPS_FINAL",label:"Grups",type:"number"},{name:"PREVISSIO_RESERVA",label:"Reserva",type:"number"},{name:"OFERTA_TOTAL_FINAL",label:"Places",type:"number"},{name:"DEMANDA_1OPCIO",label:"Demanda 1ª opció",type:"number"},{name:"DEMANDA_1OPCIO_ADSCRITS",label:"Demanda 1ª op. Adscrits",type:"number"},{name:"ALUMNES_ASSIGNATS_TOTAL",label:"Assignades",type:"number"},{name:"ALUMNES_ASSIGNATS_ADSCRITS",label:"Assignades",type:"number"},{name:"ALUMNES_ASSIGNATS_ORDINARIS",label:"Assignats Ord.",type:"number"},{name:"ALUMNES_ASSIGNATS_NEEA",label:"Assignats NEE-A",type:"number"},{name:"ALUMNES_ASSIGNATS_NEEB",label:"Assignats NEE-B",type:"number"},{name:"ALUMNES_OFICI",label:"Ofici total",type:"number"},{name:"ALUMNES_OFICI_ADSCRITS",label:"Ofici adscrits",type:"number"},{name:"PLACES_VACANTS",label:"Vacants total",type:"number"},{name:"ALUMNES_OFICI_ORDINARIS",label:"Ofici ordinaris",type:"number"},{name:"PLACES_VACANTS_ORDINARIES",label:"Vacants ordinaris",type:"number"},{name:"PLACES_VACANTS_NEEA",label:"Vacants NEE-A",type:"number"},{name:"PLACES_VACANTS_NEEB",label:"Vacants NEE-B",type:"number"},{name:"PLACES_VACANTS_NEE",label:"Vacants NEE",type:"number"},{name:"ALUMNES_OFICI_NEE",label:"Ofici NEE",type:"number"},{name:"ALUMNES_LLISTA_ESPERA",label:"Llista d'espera",type:"number"},{name:"ALUMNES_OFICI_CENTRE",label:"Espera ofici",type:"number"}],o))}(e,t,l,l.explicacio);break;case 3:!async function(e,t,a,n){const l=(await xe("AANEE_SIMULACIO_RESULTAT_CENTRE",{$filter:`ID_SIMULACIO eq ${t.ID}`+(a.titularitat?` and GEN_CENTRE/TITULARITAT eq '${a.titularitat}'`:""),$expand:"GEN_CENTRE($select=NOMICODI_CENTRE,TITULARITAT)",$orderBy:"CODIINOM_DISTRICTE,CODI_ZONA,GEN_CENTRE/TITULARITAT desc,GEN_CENTRE/NOM_CENTRE"})).value;var i;l.forEach((function(e){e.NOMICODI_CENTRE=e.GEN_CENTRE.NOMICODI_CENTRE||"",e.TITULARITAT=e.GEN_CENTRE.TITULARITAT||""})),"PDF"===e?async function(e,t,a,n){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const l={pageOrientation:"landscape",pageMargins:[30,80,18,0],header:ar("Resum per Centres",t),content:[],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:12,italics:!0},districte:{bold:!0,fontSize:11,background:"#0078d7",color:"white",fillColor:"#0078d7"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"},espai:{fontSize:6}},defaultStyle:{fontSize:7}};t.DESCRIPCIO&&a.incloureDescripcio&&(l.content.push({text:" ",fontSize:4}),l.content.push([{margin:[3,0,0,7],text:[{text:"Descripció: ",bold:!0,fontSize:12},{text:t.DESCRIPCIO,alignment:"justify",fontSize:11}]}]),l.content.push({text:" ",fontSize:4})),a.incloureIndex&&(l.content.push([{toc:{title:{text:"ÍNDEX \n\r",fontSize:12},numberStyle:{bold:!0}},margin:[120,20,120,0],pageBreak:"after"}]),l.content.push([{text:"Resum per Districtes, Zones, Titularitat i centres",color:"white",tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]}]));const i={layout:"noBorders",table:{headerRows:2,widths:["28%","4%"].concat(Array(12).fill("*")),body:[["",{text:t.NIVELL,alignment:"center",decoration:"underline"},"","","","","",{text:"Sol·licituds de 1ª opció del centre",alignment:"right",decoration:"underline",colSpan:3},"","",{text:"Assignació vacants del centre",alignment:"right",decoration:"underline",colSpan:3},"",""],["",{text:"UN",alignment:"right"},{text:"OF",alignment:"right"},{text:"SO",alignment:"right"},{text:"SO\nadscrits",alignment:"right"},{text:"AOF",alignment:"right"},{text:"AOF\nadscrits",alignment:"right"},{text:"VA",alignment:"right"},{text:"total",alignment:"right"},{text:"assignades propi centre",alignment:"right"},{text:"assignades altres ctes.",alignment:"right"},{text:"total",alignment:"right"},{text:"del propi centre",alignment:"right"},{text:"d'altres centres",alignment:"right"}]]}};if(e.forEach(((e,t,n)=>o(i.table.body,e,t,n,a.incloureIndex,!0))),a.incloureTotalsTit){const t=Array(14).fill({text:"",fontSize:"4px",style:"espai"});a.incloureIndex&&i.table.body.push([{text:"Total per titularitat",color:"white",fontSize:3,tocItem:!0,tocStyle:{bold:!0},tocMargin:[20,10,0,0]}].concat(Array(13).fill({text:"",fontSize:"4px",style:"espai"}))),i.table.body.push(t),i.table.body.push([{text:"Total per titularitat",style:"districte",colSpan:14}].concat(Array(13).fill({text:"",style:"districte"}))),i.table.body.push(t),lr(i.table.body,e,o,a.incloureIndex)}function o(e,t,n,l,i,o){o&&(0===n&&gr(e,n,"T.general","left","general",l,!1),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE||gr(e,n,t.CODIINOM_DISTRICTE,"left","districte",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE)),i),0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA||gr(e,n,t.CODI_ZONA,"right","zona",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA),!1)),a.titularitat||0!==n&&l[n-1].CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&l[n-1].CODI_ZONA===t.CODI_ZONA&&l[n-1].TITULARITAT===t.TITULARITAT||gr(e,n,t.TITULARITAT,"right","titularitat",l.filter((e=>e.CODIINOM_DISTRICTE===t.CODIINOM_DISTRICTE&&e.CODI_ZONA===t.CODI_ZONA&&e.TITULARITAT===t.TITULARITAT)),!1));const r=n%2!=0?"imparell":"";e.push([{text:t.NOMICODI_CENTRE?t.NOMICODI_CENTRE:t.TITULARITAT,style:r},{text:t.GRUPS_FINAL.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.OFERTA_TOTAL_FINAL.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.DEMANDA_1OPCIO,alignment:"right",style:r},{text:t.DEMANDA_1OPCIO_ADSCRITS,alignment:"right",style:r},{text:t.ALUMNES_OFICI.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_OFICI_ADSCRITS.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.PLACES_VACANTS.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ASSIGNATS_ONSIGUI.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_ASSIGNATS_1OPCIO.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_ASSIGNATS_NO1OPCIO.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_ASSIGNATS_TOTAL.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_ASSIGNATS_1OPCIOv?t.ALUMNES_ASSIGNATS_1OPCIOv.toLocaleString("ca-ES"):t.ALUMNES_ASSIGNATS_1OPCIO.toLocaleString("ca-ES"),alignment:"right",style:r},{text:t.ALUMNES_ASSIGNATS_RESTA.toLocaleString("ca-ES"),alignment:"right",style:r}])}l.content.push(i),a.incloureTotalsOpcio&&await nr(l,t,a.incloureIndex),a.inclureModificacions&&await Cr(l,t,a),Il.createPdf(l).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"ResumPerCentres.pdf"})}(l,t,a):((i=l).forEach((function(e){e.N=1})),or("resumcentres.csv",[{name:"DISTRICTE",label:"Districte",type:"string"},{name:"CODI_ZONA",label:"Zona",type:"string"},{name:"TITULARITAT",label:"Titularitat",type:"string"},{name:"NOMICODI_CENTRE",label:"Nom i codi centre",type:"string"},{name:"N",label:"N",type:"number"},{name:"GRUPS_FINAL",label:"Grups",type:"number"},{name:"OFERTA_TOTAL_FINAL",label:"Oferta total",type:"number"},{name:"DEMANDA_1OPCIO",label:"Demanda 1ª opció",type:"number"},{name:"DEMANDA_1OPCIO_ADSCRITS",label:"Demanda 1a opció Adscrits",type:"number"},{name:"ALUMNES_OFICI",label:"Alumnes d'ofici",type:"number"},{name:"ALUMNES_OFICI_ADSCRITS",label:"Ofici adscrits",type:"number"},{name:"PLACES_VACANTS",label:"Places vacants",type:"number"},{name:"DEMANDA_1OPCIO",label:"Assignats a qualsevol lloc",type:"number"},{name:"ALUMNES_ASSIGNATS_1OPCIO",label:"Assignats 1ª opció",type:"number"},{name:"ALUMNES_ASSIGNATS_NO1OPCIO",label:"Resta 1ª opció",type:"number"},{name:"ALUMNES_ASSIGNATS_TOTAL",label:"Alumnes assignats total",type:"number"},{name:"ALUMNES_ASSIGNATS_1OPCIO",label:"Assignats del propi centre",type:"number"},{name:"ALUMNES_ASSIGNATS_RESTA",label:"Assignats d'altres centres",type:"number"}],i))}(e,t,l,l.explicacio);break;case 4:!async function(e,t,a,n){const l=await yr(t);if("PDF"===e){Nl?.pdfMake&&(Il.vfs=Nl.pdfMake.vfs);const e={pageOrientation:"landscape",pageMargins:[30,80,18,0],header:ar("Modificacions simulació",t),content:[],styles:{title:{bold:!0,fontSize:13,background:"#0078d7",color:"white",fillColor:"#0078d7"},tocTitle:{bold:!0,fontSize:13,background:"#0062b0",color:"white",fillColor:"#0062b0"},general:{fontSize:12,italics:!0},districte:{bold:!0,fontSize:11,background:"#0078d7",color:"white",fillColor:"#0078d7"},zona:{bold:!0,fontSize:11,background:"#91c8fb",color:"white",fillColor:"#91c8fb"},titularitat:{italics:!0,fontSize:10},centre:{fontSize:9},header:{italics:!0,bold:!0},imparell:{background:"#eeeeee",fillColor:"#eeeeee"},espai:{fontSize:6}},defaultStyle:{fontSize:8}};t.DESCRIPCIO&&a.incloureDescripcio&&(e.content.push({text:" ",fontSize:4}),e.content.push([{margin:[3,0,0,7],text:[{text:"Descripció: ",bold:!0,fontSize:12},{text:t.DESCRIPCIO,alignment:"justify",fontSize:11}]}]),e.content.push({text:" ",fontSize:4})),fr(e,t,l,a,!1),Il.createPdf(e).getDataUrl((e=>{document.getElementById("pdfVISOR").src=e}),{defaultFileName:"ResumPerCentres.pdf"})}else!async function(e){or("modificacions.csv",[{name:"CODIINOM_CENTRE",label:"Codi i nom Centre",type:"string"},{name:"MODIFICACIO_GRUPS",label:"Grups",type:"string"},{name:"MODIFICACIO_ORDINARIA_GRUP",label:"Mod. oferta ordinària grup",type:"string"},{name:"MODIFICACIO_OFERTA_NEEA_GRUP",label:"Mod. oferta NEE-A grup",type:"string"},{name:"MODIFICACIO_OFERTA_NEEB_GRUP",label:"Mod. oferta NEE-B grup",type:"number"},{name:"MODIFICACIO_ORDINARIA_CENTRE",label:"Mod. oferta ordinària cte",type:"string"},{name:"MODIFICACIO_OFERTA_NEEA_CENTRE",label:"Mod. oferta NEE-A cte",type:"string"},{name:"MODIFICACIO_OFERTA_NEEB_CENTRE",label:"Mod. oferta NEE-B cte",type:"number"}],yr(e))}(t)}(e,t,l,l.explicacio);break;case 5:!async function(e){const t=T(),a=await fetch(`${m}/Stored/PR_AANEE_SIMULACIO_LLISTA_ALUMNES`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:t.jwt},body:JSON.stringify({ID_SIMULACIO:e})}),n=await a.json();or("LlistatAlumnes.csv",[{name:"NUM_SOLICITUD",label:"Num.Sol·licitud",type:"string"},{name:"IDALU",label:"IDALU",type:"string"},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string"},{name:"TIPUS_ALUMNE",label:"Tipus alumne",type:"string"},{name:"CODI_CENTRE_PROCEDENCIA",label:"C. procedencia",type:"string"},{name:"NOM_CENTRE_PROCEDENCIA",label:"Nom centre procedència",type:"string"},{name:"CODI_CENTRE_ASSIGNAT",label:"C. assignat",type:"string"},{name:"NOM_CENTRE_ASSIGNAT",label:"Nom centre assignat",type:"string"},{name:"DISTRICTE_ASS",label:"Districte",type:"string"},{name:"ZONA_ASS",label:"Zona",type:"string"},{name:"CODI_CENTRE_P1",label:"1ª opció",type:"string"},{name:"NOM_CENTRE_P1",label:"Nom 1ª opció",type:"string"},{name:"DISTRICTE_1A",label:"Districte",type:"string"},{name:"ZONA_1A",label:"Zona",type:"string"},{name:"CODI_CENTRE_P2",label:"2ª opció",type:"string"},{name:"NOM_CENTRE_P2",label:"Nom 2ª opció",type:"string"},{name:"CODI_CENTRE_P3",label:"3ª opció",type:"string"},{name:"NOM_CENTRE_P3",label:"Nom 3ª opció",type:"string"},{name:"CODI_CENTRE_P4",label:"4ª opció",type:"string"},{name:"NOM_CENTRE_P4",label:"Nom 4ª opció",type:"string"},{name:"CODI_CENTRE_P5",label:"5ª opció",type:"string"},{name:"NOM_CENTRE_P5",label:"Nom 5ª opció",type:"string"},{name:"CODI_CENTRE_P6",label:"6ª opció",type:"string"},{name:"NOM_CENTRE_P6",label:"Nom 6ª opció",type:"string"},{name:"CODI_CENTRE_P7",label:"7ª opció",type:"string"},{name:"NOM_CENTRE_P7",label:"Nom 7ª opció",type:"string"},{name:"CODI_CENTRE_P8",label:"8ª opció",type:"string"},{name:"NOM_CENTRE_P8",label:"Nom 8ª opció",type:"string"},{name:"CODI_CENTRE_P9",label:"9ª opció",type:"string"},{name:"NOM_CENTRE_P9",label:"Nom 9ª opció",type:"string"},{name:"CODI_CENTRE_P10",label:"10ª opció",type:"string"},{name:"NOM_CENTRE_P10",label:"Nom 10ª opció",type:"string"},{name:"CODI_CENTRE_P11",label:"11ª opció",type:"string"},{name:"NOM_CENTRE_P11",label:"Nom 11ª opció",type:"string"},{name:"CODI_CENTRE_P12",label:"12ª opció",type:"string"},{name:"NOM_CENTRE_P12",label:"Nom 12ª opció",type:"string"},{name:"CODI_CENTRE_P13",label:"13ª opció",type:"string"},{name:"NOM_CENTRE_P13",label:"Nom 13ª opció",type:"string"},{name:"CODI_CENTRE_P14",label:"14ª opció",type:"string"},{name:"NOM_CENTRE_P14",label:"Nom 14ª opció",type:"string"},{name:"CODI_CENTRE_P15",label:"15ª opció",type:"string"},{name:"NOM_CENTRE_P15",label:"Nom 15ª opció",type:"string"},{name:"ORDRE",label:"Ordre d'entrada",type:"number"},{name:"OPCIO",label:"Opció assignada",type:"number"},{name:"FORA_TERMINI",label:"Fora termini",type:"number"},{name:"PENALITZA_DUPLICADA",label:"Penalitza duplicada",type:"number"},{name:"SIMULTANEITAT",label:"Simultaneïtat",type:"number"},{name:"ADSCRIPCIO",label:"Adscripció",type:"number"},{name:"OPCIOCENTRE",label:"Preferència",type:"number"},{name:"PUNTS_GENERALS",label:"Punts generals",type:"number"},{name:"PUNTS_COMPLEMENTARIS",label:"Punts complementaris",type:"number"},{name:"NUMERO_DESEMPAT",label:"Ordre desempat",type:"number"},{name:"NUMERO_DESEMPAT_ORIGINAL",label:"Núm. desempat",type:"number"},{name:"ES_FORA_TERMINI",label:"És forma termini",type:"number"},{name:"ES_PENALITZA_DUPLICADA",label:"És duplicada",type:"number"},{name:"ORDRE_LLISTAT",label:"Ordre llistat",type:"string"},{name:"ORDRE_ASSIGNACIO",label:"Ordre d'assignació",type:"number"},{name:"SITUACIO",label:"Situació",type:"number"}],JSON.parse(n))}(a.query.id);break;case 6:!async function(e,t){const a=T(),n=await fetch(`${m}/Stored/pr_AANEE_SIMULACIO_LLISTAESPERA`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:a.jwt},body:JSON.stringify({ID_SIMULACIO:e.ID,ID_CENTRE:t.id_centre})}),l=await n.json();or("LlistaEspera_"+e.NOM_SIMULACIO+".csv",[{name:"SITUACIO",label:"Situació",type:"string"},{name:"ORDRE",label:"Ordre d'entrada",type:"number"},{name:"OPCIO",label:"Opció assignada",type:"number"},{name:"CODI",label:"Centre assignat",type:"string"},{name:"ORDRE_ASSIGNACIO",label:"Ordre Assig.",type:"string"},{name:"TIPUS_ALUMNE",label:"Tipus alumne",type:"string"},{name:"NUM_SOLICITUD",label:"N. Sol·licitud",type:"string"},{name:"IDALU",label:"Idalu",type:"string"},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string"},{name:"CODI_CENTRE_P1",label:"1ª opció",type:"string"},{name:"CODI_CENTRE_P2",label:"2ª opció",type:"string"},{name:"CODI_CENTRE_P3",label:"3ª opció",type:"string"},{name:"CODI_CENTRE_P4",label:"4ª opció",type:"string"},{name:"CODI_CENTRE_P5",label:"5ª opció",type:"string"},{name:"CODI_CENTRE_P6",label:"6ª opció",type:"string"},{name:"CODI_CENTRE_P7",label:"7ª opció",type:"string"},{name:"CODI_CENTRE_P8",label:"8ª opció",type:"string"},{name:"CODI_CENTRE_P9",label:"9ª opció",type:"string"},{name:"CODI_CENTRE_P10",label:"10ª opció",type:"string"},{name:"CODI_CENTRE_P11",label:"11ª opció",type:"string"},{name:"CODI_CENTRE_P12",label:"12ª opció",type:"string"},{name:"CODI_CENTRE_P13",label:"13ª opció",type:"string"},{name:"CODI_CENTRE_P14",label:"14ª opció",type:"string"},{name:"CODI_CENTRE_P15",label:"15ª opció",type:"string"},{name:"CODI_CENTRE_PROCEDENCIA",label:"Centre procedència",type:"string"},{name:"NOM_CENTRE_PROCEDENCIA",label:"Nom centre procedència",type:"string"},{name:"ORDRE_NEE",label:"Ordre NEE",type:"number"},{name:"ORDRE_MANUAL",label:"Ordre manual",type:"number"},{name:"FORA_TERMINI",label:"Fora termini",type:"boolean"},{name:"PENALITZA_DUPLICADA",label:"Penalitza duplicada",type:"boolean"},{name:"SIMULTANEITAT",label:"Simultaneïtat",type:"boolean"},{name:"ADSCRIPCIO",label:"Adscripció",type:"boolean"},{name:"ADSCRIPCIO_OPCIOCENTRE",label:"Adscripció preferència",type:"boolean"},{name:"OPCIOCENTRE",label:"Preferència",type:"number"},{name:"PUNTS_GENERALS",label:"Punts generals",type:"number"},{name:"PUNTS_COMPLEMENTARIS",label:"Punts complementaris",type:"number"},{name:"NUMERO_DESEMPAT",label:"Ordre desempat",type:"number"},{name:"NUMERO_DESEMPAT_ORIGINAL",label:"Núm. desempatt",type:"number"},{name:"ES_FORA_TERMINI",label:"És fora termini",type:"boolean"},{name:"ES_PENALITZA_DUPLICADA",label:"És penalitza duplicada",type:"boolean"},{name:"OFERTA_ORDINARIA",label:"Of. ordinària",type:"number"},{name:"OFERTA_NEEA",label:"Of. NEE-A",type:"number"},{name:"OFERTA_NEEB",label:"Of. NEE-B",type:"number"},{name:"OFERTA_NEE",label:"Of. NEE",type:"number"}],JSON.parse(l))}(t,l);break;case 7:!async function(e,t){const a=T(),n=await fetch(`${m}/Stored/pr_AANEE_SIMULACIO_PETICIONS_PREFERENTS`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:a.jwt},body:JSON.stringify({ID_SIMULACIO:e.ID,NUM_SOLICITUD:t.numSolicitud})}),l=await n.json();or("PreferentsAlumne_"+e.NOM_SIMULACIO+".csv",[{name:"OPCIOCENTRE",label:"Opció Alumne escollit",type:"string"},{name:"OPCIO",label:"Opció preferent",type:"number"},{name:"CODI_CENTRE_ASSIGNAT",label:"C. assignat",type:"string"},{name:"NOM_CENTRE_ASSIGNAT",label:"Nom centre assignat",type:"string"},{name:"OFERTA_ORDINARIA",label:"Of. ordinària",type:"number"},{name:"OFERTA_NEEA",label:"Of. NEE-A",type:"number"},{name:"OFERTA_NEEB",label:"Of. NEE-B",type:"number"},{name:"ORDRE_ASSIGNACIO",label:"Ordre d'assignació",type:"number"},{name:"NUM_SOLICITUD",label:"Num.Sol·licitud",type:"string"},{name:"IDALU",label:"IDALU",type:"string"},{name:"COGNOMSINOM",label:"Cognoms i nom",type:"string"},{name:"TIPUS_ALUMNE",label:"Tipus alumne",type:"string"},{name:"CODI_CENTRE_PROCEDENCIA",label:"C. procedencia",type:"string"},{name:"NOM_CENTRE_PROCEDENCIA",label:"Nom centre procedència",type:"string"},{name:"CODI_CENTRE_P1",label:"1ª opció",type:"string"},{name:"CODI_CENTRE_P2",label:"2ª opció",type:"string"},{name:"CODI_CENTRE_P3",label:"3ª opció",type:"string"},{name:"CODI_CENTRE_P4",label:"4ª opció",type:"string"},{name:"CODI_CENTRE_P5",label:"5ª opció",type:"string"},{name:"CODI_CENTRE_P6",label:"6ª opció",type:"string"},{name:"CODI_CENTRE_P7",label:"7ª opció",type:"string"},{name:"CODI_CENTRE_P8",label:"8ª opció",type:"string"},{name:"CODI_CENTRE_P9",label:"9ª opció",type:"string"},{name:"CODI_CENTRE_P10",label:"10ª opció",type:"string"},{name:"ORDRE_NEE",label:"Ordre NEE",type:"number"},{name:"ORDRE_MANUAL",label:"Ordre manual",type:"number"},{name:"FORA_TERMINI",label:"Fora termini",type:"number"},{name:"PENALITZA_DUPLICADA",label:"Penalitza duplicada",type:"number"},{name:"SIMULTANEITAT",label:"Simultaneïtat",type:"number"},{name:"ADSCRIPCIO",label:"Adscripció",type:"number"},{name:"OPCIOCENTRE",label:"Preferència",type:"number"},{name:"PUNTS_GENERALS",label:"Punts generals",type:"number"},{name:"PUNTS_COMPLEMENTARIS",label:"Punts complementaris",type:"number"},{name:"NUMERO_DESEMPAT",label:"Ordre desempat",type:"number"},{name:"NUMERO_DESEMPAT_ORIGINAL",label:"Núm. desempat",type:"number"},{name:"ES_FORA_TERMINI",label:"És forma termini",type:"number"},{name:"ES_PENALITZA_DUPLICADA",label:"És duplicada",type:"number"}],JSON.parse(l||"[]"))}(t,l)}}function u(e){e?(l.incloureTotalsTit=null,l.centresFiltered=l.centres.filter((t=>t.titularitat===e))):l.centresFiltered=l.centres}return(0,n.onMounted)((async()=>{l.id_nivell=a.query.id_nivell;const e=await xe("GEN_CENTRE",{$select:["ID","NOMICODI_CENTRE","TITULARITAT"],$filter:`GEN_CENTRE_ZONA/any(GEN_CENTRE_ZONA:GEN_CENTRE_ZONA/ID_ETAPA eq ${l.id_nivell<11?2:3})`,$orderby:"NOMICODI_CENTRE"});l.centres=e.value.map((e=>({value:e.ID,text:e.NOMICODI_CENTRE,titularitat:e.TITULARITAT}))),l.centresFiltered=l.centres})),(e,t)=>{const a=(0,n.resolveComponent)("fura-combo-box"),r=(0,n.resolveComponent)("llesca-field-text"),c=(0,n.resolveComponent)("fura-checkbox"),m=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ga),{subtitle:"Informes Simulacions"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Or,[(0,n.createVNode)(a,{style:{"grid-area":"REPORT"},name:"REPORT",label:"Fer aquest informe",options:l.reportList,required:"",modelValue:l.reportId,"onUpdate:modelValue":t[0]||(t[0]=e=>l.reportId=e)},null,8,["options","modelValue"]),(0,n.createVNode)(a,{style:{"grid-area":"TIT"},name:"TITULARITAT",label:"Titularitat",options:[{value:"Públic",text:"Públic"},{value:"Privat concertat",text:"Privat concertat"}],disabled:[4,5,7].includes(l.reportId),"onUpdate:modelValue":[u,t[1]||(t[1]=e=>l.titularitat=e)],modelValue:l.titularitat},null,8,["disabled","modelValue"]),(0,n.createVNode)(a,{label:"Centre",style:{"grid-area":"CENTRE"},required:6===l.reportId,disabled:6!==l.reportId,options:l.centresFiltered,"allow-freeform":"","auto-complete":"","immediate-scroll":"","clear-value-on-disabled":"",modelValue:l.id_centre,"onUpdate:modelValue":t[2]||(t[2]=e=>l.id_centre=e)},null,8,["required","disabled","options","modelValue"]),(0,n.createVNode)(r,{style:{"grid-area":"NUM_SOLICITUD"},label:"Num. Sol·licitud",maxlength:16,required:7===l.reportId,disabled:7!==l.reportId,"clear-value-on-disabled":"",modelValue:l.numSolicitud,"onUpdate:modelValue":t[3]||(t[3]=e=>l.numSolicitud=e)},null,8,["required","disabled","modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"INDEX","margin-top":"12px"},label:"Incloure índex",disabled:l.reportId>=4,modelValue:l.incloureIndex,"onUpdate:modelValue":t[4]||(t[4]=e=>l.incloureIndex=e)},null,8,["disabled","modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"DESCRIPCIO","margin-top":"12px"},label:"Incloure descripció de la simulació",disabled:l.reportId>=5,modelValue:l.incloureDescripcio,"onUpdate:modelValue":t[5]||(t[5]=e=>l.incloureDescripcio=e)},null,8,["disabled","modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"TITULARITAT","margin-top":"12px"},label:"Incloure resum per titularitat",disabled:!!l.titularitat||l.reportId>=4,modelValue:l.incloureTotalsTit,"onUpdate:modelValue":t[6]||(t[6]=e=>l.incloureTotalsTit=e)},null,8,["disabled","modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"PEROPCIO","margin-top":"12px"},label:"Incloure resum per opció assignada",disabled:l.reportId>=4,modelValue:l.incloureTotalsOpcio,"onUpdate:modelValue":t[7]||(t[7]=e=>l.incloureTotalsOpcio=e)},null,8,["disabled","modelValue"]),(0,n.createVNode)(c,{style:{"grid-area":"MODIFICACIONS","margin-top":"12px"},label:"Incloure modificacions oferta",disabled:l.reportId>=4,modelValue:l.inclureModificacions,"onUpdate:modelValue":t[8]||(t[8]=e=>l.inclureModificacions=e)},null,8,["disabled","modelValue"]),(0,n.createElementVNode)("div",Sr,[(0,n.createVNode)(m,{class:"boto",disabled:(0,n.unref)(i),text:"PDF",icon:"PDF",onClick:t[9]||(t[9]=e=>d("PDF"))},null,8,["disabled"]),(0,n.createVNode)(m,{class:"boto",disabled:(0,n.unref)(o),text:"CSV",icon:"ExcelLogo",onClick:t[10]||(t[10]=e=>d("CSV"))},null,8,["disabled"]),(0,n.createVNode)(m,{class:"boto",text:"Tornar",icon:"ChromeClose",onClick:s})]),br])])),_:1})}}},vr=[];for(const e of En()){const t=ti[e.type];t&&t.getRoutes&&vr.push(...t.getRoutes(e))}const Rr=(0,r.createRouter)({history:(0,r.createWebHistory)(s),routes:vr.concat([{path:"/",component:Ei,meta:{anonymousAccess:!0}},{path:"/password-reset-request",component:bi,meta:{anonymousAccess:!0}},{path:"/password-reset",component:Bi,meta:{anonymousAccess:!0}},{path:"/password-change",component:Ji},{path:"/calcul-assignacio",component:Nr},{path:"/findidalus",component:Fo},{path:"/findduplicats",component:Bo},{path:"/lligamAanee",component:qo},{path:"/lligamGedac",component:zo},{path:"/lligamRav",component:Wo},{path:"/home",component:Qi},{path:"/load-csv",component:mo},{path:"/configuration",component:Co},{path:"/validation",component:ho},{path:"/execute-csv",component:Mo},{path:"/lligam-csv",component:Jo},{path:"/modificacions",component:tr},{path:"/print-simulacions",component:Dr},{path:"/config",component:za},{path:"/:catchAll(.*)",component:ao}])});Rr.beforeEach((e=>{const t=T();if(!e.meta.anonymousAccess&&!t.jwt)return{path:"/",query:{redirect:e.fullPath}}}));const hr=Rr,Lr={__name:"dialog-loading",setup(e){const t=he();return(e,a)=>{const l=(0,n.resolveComponent)("fura-spinner"),i=(0,n.resolveComponent)("fura-dialog"),o=(0,n.resolveComponent)("fura-overlay"),r=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(r,{open:(0,n.unref)(t).loading.size>0},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{class:"dialogLoading-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"dialogLoading-loading"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{label:"Carregant..."})])),_:1})])),_:1})])),_:1},8,["open"])}}},xr=(0,R.Z)(Lr,[["__scopeId","data-v-69be9a34"]]),Ur={class:"dialogAlert-close"},Mr={__name:"dialog-alert",setup(e){const t=he(),a=(0,n.computed)((()=>t.alertList.length>0)),l=(0,n.computed)((()=>t.alertList[0]));return(e,i)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),s=(0,n.resolveComponent)("fura-overlay"),d=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(d,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(s,{key:0,class:"dialogAlert-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogAlert-dialog",type:"close",header:(0,n.unref)(l).title,text:(0,n.unref)(l).message,onClick:i[1]||(i[1]=e=>(0,n.unref)(t).alertClose())},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Ur,[(0,n.createVNode)(o,{text:"Tancar",onClick:i[0]||(i[0]=e=>(0,n.unref)(t).alertClose())})])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},Pr=(0,R.Z)(Mr,[["__scopeId","data-v-69b9f90a"]]),Vr={class:"dialogConfirm-close"},Fr={__name:"dialog-confirm",setup(e){const t=he(),a=(0,n.computed)((()=>t.confirmList.length>0)),l=(0,n.computed)((()=>t.confirmList[0]));return(e,i)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),s=(0,n.resolveComponent)("fura-overlay"),d=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(d,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(s,{key:0,class:"dialogConfirm-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogConfirm-dialog",header:(0,n.unref)(l).title,text:(0,n.unref)(l).message},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Vr,[(0,n.createVNode)(o,{primary:"",text:(0,n.unref)(l).confirmButton||"Si",onClick:i[0]||(i[0]=e=>(0,n.unref)(t).confirmAccept())},null,8,["text"]),(0,n.createVNode)(o,{text:(0,n.unref)(l).cancelButton||"No",onClick:i[1]||(i[1]=e=>(0,n.unref)(t).confirmCancel())},null,8,["text"])])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},wr=(0,R.Z)(Fr,[["__scopeId","data-v-0cb2bae0"]]),Gr={__name:"app",setup:e=>((0,n.onMounted)((async function(){const e=La(),t=await xe("AANEE_SETTINGS(1)");e.saveConfig(t)})),(e,t)=>{const a=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(a),(0,n.createVNode)((0,n.unref)(xr)),(0,n.createVNode)((0,n.unref)(Pr)),(0,n.createVNode)((0,n.unref)(wr))],64)})},Br=(0,n.createApp)(Gr);Br.use((0,l.createPinia)()),Br.use(i),Br.use(o),Br.use(hr),Br.mount("#app");const kr=Br})(),u.default})()));